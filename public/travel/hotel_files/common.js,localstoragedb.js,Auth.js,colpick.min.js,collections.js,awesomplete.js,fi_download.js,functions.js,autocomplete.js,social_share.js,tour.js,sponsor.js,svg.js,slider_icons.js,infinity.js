$(function(){var methods=["assert","cd","clear","count","countReset","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","select","table","time","timeEnd","timeStamp","timeline","timelineEnd","trace","warn"];var length=methods.length;var console=(window.console=window.console||{});var method;var noop=function(){};while(length--){method=methods[length];if(!console[method]){try{console[method]=noop;}catch(e){}}}
if(typeof gr.sponsor!="undefined"&&typeof gr.sponsor.coupon!="undefined"){gr.sponsor.coupon.launch();}});function $_(s){var s=document.querySelectorAll(s);return(s.length>1)?s:(s[0])?s[0]:null;};document.get=function(s){return document.querySelector(s);};document.find=function(s){return document.querySelectorAll(s);};Element.prototype.get=function(s){return this.querySelector(s);};Element.prototype.find=function(s){return this.querySelectorAll(s);};Element.prototype.parents=function(s){var l=[],e=this;if(s){var t=s.charAt(0);}
for(var q=0;e&&e!==document&&!q;e=e.parentNode){if(s){if(t==='.'&&e.classList.contains(s.substr(1)))q=1;if(t==='#'&&e.id===s.substr(1))q=1;if(t==='['&&e.hasAttribute(s.substr(1,s.length-1)))q=1;if(e.tagName.toLowerCase()===s)q=1;}
l.push(e);}
return(!l.length||(l.reverse()[0].tagName=='HTML'&&s))?null:l;};Element.prototype.parent=function(s){var list=this.parents(s);if(typeof s=="undefined")list.reverse();return(list&&list.length)?list[0]:null;};function Notifier(){this.warning=function(title,body,sticky){_notify(title,body,sticky,'warning');};this.danger=function(title,body,sticky){_notify(title,body,sticky,'danger');};this.success=function(title,body,sticky){_notify(title,body,sticky,'success');};var timeout=8000;function _notify(title,body,sticky,type){_displayCustomNotification(title,body,sticky,type);}
function _displayCustomNotification(title,body,sticky,type){var time=Date.now();if(title instanceof(Object)){body=title.body;title=title.title;}
document.body.insertAdjacentHTML('beforeend',Handlebars.tag('notification')({title:title,body:body,sticky:sticky,type:type,time:time}));if(!sticky){setTimeout(function(){var notification=document.getElementById('notify-'+time);notification.parentElement.removeChild(notification);},timeout);}}}
Notifier.close=function(element){var notification=document.getElementById('notify-'+element.dataset.time);notification.parentElement.removeChild(notification);};var UserAlerts=new Notifier();function slug(str){str=str.replace(/^\s+|\s+$/g,'').toLowerCase();var from="ãàáäâẽèéëêìíïîõòóöôùúüûñç·/_,:;";var to="aaaaaeeeeeiiiiooooouuuunc------";for(var i=0,l=from.length;i<l;i++){str=str.replace(new RegExp(from.charAt(i),'g'),to.charAt(i));}
return str.replace(/[^a-z0-9 -]/g,'').replace(/\s+/g,'-').replace(/-+/g,'-');}
function sanitize_filename(str){var d=new Date();var n=d.getTime();str=str.split('.').join(n);var new_str=slug(str);new_str=new_str.split(n).join('.');return new_str;}
function detectBrowser(){if(navigator.userAgent.indexOf("Chrome")!=-1){return'Chrome';}else if(navigator.userAgent.indexOf("Opera")!=-1){return'Opera';}else if(navigator.userAgent.indexOf("Firefox")!=-1){return'Firefox';}else if((navigator.userAgent.indexOf("MSIE")!=-1)||(!!document.documentMode==true))
{return'IE';}else if(navigator.userAgent.indexOf("Safari")!=-1){return'Safari';}else{return navigator.userAgent;}}
function detectIE10(){if(navigator.appName.indexOf("Internet Explorer")!=-1){return(navigator.appVersion.indexOf("MSIE 1")==-1);}}
Handlebars.tag=function(tag){return Handlebars.compile(document.getElementById("tpl-"+tag).innerHTML);};var Cookie={get:function(cookie_name){var name=cookie_name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1);if(c.indexOf(name)==0)return c.substring(name.length,c.length);}
return"";},set:function(name,value,days){if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));var expires="; expires="+date.toGMTString();}else var expires="";document.cookie=name+"="+value+expires+"; path=/";},del:function(name){document.cookie=name+'=; expires=Thu, 01 Jan 1970 00:00:01 GMT;';}};function check_url(url,method,fn_ok,fn_error){var m=(method=='get'||method=='post')?method:'get';if(typeof url!='undefined'){$.ajax({type:'HEAD',method:m,url:url,success:function(){fn_ok();},error:function(){register_log('error','Checking url: '+url);fn_error();}});}}
function closeModal(elem){elem.parent(".modal").get('.modal-state').checked=false;}
function register_log(type,text){var url=URL_LOG;$.ajax({url:url,type:'POST',data:{type:type,text:text}});}
function errorHandler(f){if(arguments.length>1){f.forEach(function(error,item){console.error("%s for item %i",error,item);});}
if(typeof f!=="undefined")console.error(failures);}
function isValidColor(color){return(/(^[0-9A-F]{6}$)/i.test(color));}
function getTimestamp(date){if(typeof date=='undefined'){return convertToUTC(new Date());}
if(date instanceof Date){return convertToUTC(date);}else{var now=new Date(date);if(now instanceof Date){return convertToUTC(now);}else{return convertToUTC(new Date());}}
function convertToUTC(date){var now_utc=new Date(date.getUTCFullYear(),date.getUTCMonth(),date.getUTCDate(),date.getUTCHours(),date.getUTCMinutes(),date.getUTCSeconds());return parseInt(Date.parse(now_utc).toString().slice(0,10),10);}}
var Spinner={show:function(){document.getElementById('loader').style.display='block'},hide:function(){document.getElementById('loader').style.display='none'},};function capitalize(string){return string.charAt(0).toUpperCase()+string.slice(1);}
function detectPagination(url){var pag=0;var init=url.lastIndexOf('/');var end=url.length;if(url.lastIndexOf('?')!=-1){end=url.lastIndexOf('?');}
if(init!=-1){pag=url.substring(init+1,end);}
return(isNaN(pag)?0:pag);}
function urlWithoutPag(url){var pag=detectPagination(url);var out='';if(pag!=0){out=url.substring(0,url.lastIndexOf('/'));}else{var qs=window.location.search;if(qs!=''){out=url.substring(0,url.lastIndexOf('?'));}else{out=url;}}
return out;}
function getUrlNavigation(url,pag,query){var nStrip=0;while(url.length>nStrip&&url[url.length-(nStrip+1)]=='/'){nStrip+=1;}
if(nStrip>0){url=url.slice(0,-nStrip);}
if(pag!=''&&typeof pag!=='undefined'&&pag>1){url=url+'/'+pag;}
if(query!=''&&typeof query!=='undefined'){query=cleanQueryString(query);url=url.replace("/\/\/$/","/");url=(query.lastIndexOf('?')==-1)?url+'?'+query:url+query}
return url;}
function cleanQueryString(query){if(query!=''&&typeof query!=='undefined'){query=query.replace("\&\&","\&").replace(/[^=&]+=(&|$)/g,"").replace(/^&|&$/,"");}
return query;}
function setUrlNavigator(url,pag,query){url=getUrlNavigation(url,pag,query);if('history'in window){if(typeof window.history.pushState=='function'){window.history.pushState('','',url);}}}
if(typeof parseQueryString!=='function'){function parseQueryString(a){a=a.substr(1).split('&');if(a=="")return{};var b={};for(var i=0;i<a.length;++i){var p=a[i].split('=',2);if(p.length==1)
b[p[0]]="";else
b[p[0]]=decodeURIComponent(p[1].replace(/\+/g," "));}
return b;}}
function createFunctionWithTimeout(callback,opt_timeout){var called=false;var cb=function(){if(!called){called=true;callback();}};setTimeout(cb,opt_timeout||1000);return cb;};!(function(_global,undefined){function localStorageDB(db_name,engine){if(!db_name)db_name="0";var db_prefix='fi_',db_id=db_prefix+db_name,db_new=false,db=null;try{var storage=(engine==sessionStorage?sessionStorage:localStorage);}catch(e){var storage=engine;}
db=storage[db_id];if(!(db&&(db=JSON.parse(db))&&db.tables&&db.data)){if(!validateName(db_name)){error("The name '"+db_name+"' contains invalid characters");}else{db={tables:{},data:{}};commit();db_new=true;}}
function drop(){if(storage.hasOwnProperty(db_id)){delete storage[db_id];}
db=null;}
function tableCount(){var count=0;for(var table in db.tables){if(db.tables.hasOwnProperty(table)){count++;}}
return count;}
function showTables(){var list=[];for(var table in db.tables){if(db.tables.hasOwnProperty(table)){list.push(table);}}
return list;}
function tableFields(table_name){return db.tables[table_name].fields;}
function tableExists(table_name){return db.tables[table_name]?true:false;}
function tableExistsWarn(table_name){if(!tableExists(table_name)){error("The table '"+table_name+"' does not exist");}}
function columnExists(table_name,field_name){var exists=false;var table_fields=db.tables[table_name].fields;for(var field in table_fields){if(table_fields[field]==field_name)
{exists=true;break;}}
return exists;}
function createTable(table_name,fields){db.tables[table_name]={fields:fields,auto_increment:1};db.data[table_name]={};}
function dropTable(table_name){delete db.tables[table_name];delete db.data[table_name];}
function truncate(table_name){db.tables[table_name].auto_increment=1;db.data[table_name]={};}
function alterTable(table_name,new_fields,default_values){db.tables[table_name].fields=db.tables[table_name].fields.concat(new_fields);if(typeof default_values!="undefined"){for(var ID in db.data[table_name]){if(!db.data[table_name].hasOwnProperty(ID)){continue;}
for(var field in new_fields){if(typeof default_values=="object"){db.data[table_name][ID][new_fields[field]]=default_values[new_fields[field]];}else{db.data[table_name][ID][new_fields[field]]=default_values;}}}}}
function rowCount(table_name){var count=0;for(var ID in db.data[table_name]){if(db.data[table_name].hasOwnProperty(ID)){count++;}}
return count;}
function insert(table_name,data){var keys=Object.keys(db.data[table_name]);for(var i=1;i<keys.length+1;i++){if(keys[i-1]!=i){data.ID=i;break;}}
if(!data.ID){data.ID=db.tables[table_name].auto_increment;db.tables[table_name].auto_increment++;}
db.data[table_name][data.ID]=data;return data.ID;}
function select(table_name,ids,start,limit,sort,distinct){var ID=null,results=[],row=null;for(var i=0;i<ids.length;i++){ID=ids[i];row=db.data[table_name][ID];results.push(clone(row));}
if(sort&&sort instanceof Array){for(var i=0;i<sort.length;i++){results.sort(sort_results(sort[i][0],sort[i].length>1?sort[i][1]:null));}}
if(distinct&&distinct instanceof Array){for(var j=0;j<distinct.length;j++){var seen={},d=distinct[j];for(var i=0;i<results.length;i++){if(results[i]===undefined){continue;}
if(results[i].hasOwnProperty(d)&&seen.hasOwnProperty(results[i][d])){delete(results[i]);}else{seen[results[i][d]]=1;}}}
var new_results=[];for(var i=0;i<results.length;i++){if(results[i]!==undefined){new_results.push(results[i]);}}
results=new_results;}
start=start&&typeof start==="number"?start:null;limit=limit&&typeof limit==="number"?limit:null;if(start&&limit){results=results.slice(start,start+limit);}else if(start){results=results.slice(start);}else if(limit){results=results.slice(start,limit);}
return results;}
function sort_results(field,order){return function(x,y){var v1=typeof(x[field])==="string"?x[field].toLowerCase():x[field],v2=typeof(y[field])==="string"?y[field].toLowerCase():y[field];if(order==="DESC"){return v1==v2?0:(v1<v2?1:-1);}else{return v1==v2?0:(v1>v2?1:-1);}};}
function queryByValues(table_name,data){var result_ids=[],exists=false,row=null;for(var ID in db.data[table_name]){if(!db.data[table_name].hasOwnProperty(ID)){continue;}
row=db.data[table_name][ID];exists=true;for(var field in data){if(!data.hasOwnProperty(field)){continue;}
if(typeof data[field]=='string'){if(row[field]===null||row[field].toString().toLowerCase()!=data[field].toString().toLowerCase()){exists=false;break;}}else{if(row[field]!=data[field]){exists=false;break;}}}
if(exists){result_ids.push(ID);}}
return result_ids;}
function queryByFunction(table_name,query_function){var result_ids=[],exists=false,row=null;for(var ID in db.data[table_name]){if(!db.data[table_name].hasOwnProperty(ID)){continue;}
row=db.data[table_name][ID];if(query_function(clone(row))==true){result_ids.push(ID);}}
return result_ids;}
function getDB(){return db;}
function getIDs(table_name){var result_ids=[];for(var ID in db.data[table_name]){if(db.data[table_name].hasOwnProperty(ID)){result_ids.push(ID);}}
return result_ids;}
function deleteRows(table_name,ids){for(var i=0;i<ids.length;i++){if(db.data[table_name].hasOwnProperty(ids[i])){delete db.data[table_name][ids[i]];}}
return ids.length;}
function update(table_name,ids,update_function){var ID='',num=0;for(var i=0;i<ids.length;i++){ID=ids[i];var updated_data=update_function(clone(db.data[table_name][ID]));if(updated_data){delete updated_data['ID'];var new_data=db.data[table_name][ID];for(var field in updated_data){if(updated_data.hasOwnProperty(field)){new_data[field]=updated_data[field];}}
db.data[table_name][ID]=validFields(table_name,new_data);num++;}}
return num;}
function commit(){try{storage.setItem(db_id,JSON.stringify(db));return true;}catch(e){return false;}}
function serialize(){return JSON.stringify(db);}
function error(msg){throw new Error(msg);}
function clone(obj){var new_obj={};for(var key in obj){if(obj.hasOwnProperty(key)){new_obj[key]=obj[key];}}
return new_obj;}
function validateName(name){return name.toString().match(/[^a-z_0-9]/ig)?false:true;}
function validFields(table_name,data){var field='',new_data={};for(var i=0;i<db.tables[table_name].fields.length;i++){field=db.tables[table_name].fields[i];if(data[field]!==undefined){new_data[field]=data[field];}}
return new_data;}
function validateData(table_name,data){var field='',new_data={};for(var i=0;i<db.tables[table_name].fields.length;i++){field=db.tables[table_name].fields[i];new_data[field]=(data[field]===null||data[field]===undefined)?null:data[field];}
return new_data;}
function renameTable(old_table,new_table){if(old_table==new_table){throw"Same table name choosen";}
if(!db.data.hasOwnProperty(old_table)&&!db.tables.hasOwnProperty(old_table)){throw"The table doesn't exists on database";}
if(db.data.hasOwnProperty(new_table)||db.tables.hasOwnProperty(new_table)){throw"New table name already exists on database";}
db.data[new_table]=db.data[old_table];db.tables[new_table]=db.tables[old_table];delete db.data[old_table];delete db.tables[old_table];storage.setItem(db_id,JSON.stringify(db));return true;}
return{commit:function(){return commit();},isNew:function(){return db_new;},drop:function(){drop();},renameTable:function(old_table,new_table){return renameTable(old_table,new_table);},getDB:function(){return getDB();},serialize:function(){return serialize();},tableExists:function(table_name){return tableExists(table_name);},tableFields:function(table_name){return tableFields(table_name);},tableCount:function(){return tableCount();},showTables:function(){return showTables();},columnExists:function(table_name,field_name){return columnExists(table_name,field_name);},createTable:function(table_name,fields){if(!table_name)table_name=0;var result=false;if(!validateName(table_name)){error("The database name '"+table_name+"' contains invalid characters.");}else if(this.tableExists(table_name)){error("The table name '"+table_name+"' already exists.");}else{var is_valid=true;for(var i=0;i<fields.length;i++){if(!validateName(fields[i])){is_valid=false;break;}}
if(is_valid){var fields_literal={};for(var i=0;i<fields.length;i++){fields_literal[fields[i]]=true;}
delete fields_literal['ID'];fields=['ID'];for(var field in fields_literal){if(fields_literal.hasOwnProperty(field)){fields.push(field);}}
createTable(table_name,fields);result=true;}else{error("One or more field names in the table definition contains invalid characters");}}
return result;},createTableWithData:function(table_name,data){if(typeof data!=='object'||!data.length||data.length<1){error("Data supplied isn't in object form. Example: [{k:v,k:v},{k:v,k:v} ..]");}
var fields=Object.keys(data[0]);if(this.createTable(table_name,fields)){this.commit();for(var i=0;i<data.length;i++){if(!insert(table_name,data[i])){error("Failed to insert record: ["+JSON.stringify(data[i])+"]");}}
this.commit();}
return true;},dropTable:function(table_name){tableExistsWarn(table_name);dropTable(table_name);},truncate:function(table_name){tableExistsWarn(table_name);truncate(table_name);},alterTable:function(table_name,new_fields,default_values){var result=false;if(!validateName(table_name)){error("The database name '"+table_name+"' contains invalid characters");}else{if(typeof new_fields=="object"){var is_valid=true;for(var i=0;i<new_fields.length;i++){if(!validateName(new_fields[i])){is_valid=false;break;}}
if(is_valid){var fields_literal={};for(var i=0;i<new_fields.length;i++){fields_literal[new_fields[i]]=true;}
delete fields_literal['ID'];new_fields=[];for(var field in fields_literal){if(fields_literal.hasOwnProperty(field)){new_fields.push(field);}}
alterTable(table_name,new_fields,default_values);result=true;}else{error("One or more field names in the table definition contains invalid characters");}}else if(typeof new_fields=="string"){if(validateName(new_fields)){var new_fields_array=[];new_fields_array.push(new_fields);alterTable(table_name,new_fields_array,default_values);result=true;}else{error("One or more field names in the table definition contains invalid characters");}}}
return result;},rowCount:function(table_name){tableExistsWarn(table_name);return rowCount(table_name);},insert:function(table_name,data){tableExistsWarn(table_name);return insert(table_name,validateData(table_name,data));},insertOrUpdate:function(table_name,query,data){tableExistsWarn(table_name);var result_ids=[];if(!query){result_ids=getIDs(table_name);}else if(typeof query=='object'){result_ids=queryByValues(table_name,validFields(table_name,query));}else if(typeof query=='function'){result_ids=queryByFunction(table_name,query);}
if(result_ids.length==0){return insert(table_name,validateData(table_name,data));}else{var ids=[];for(var n=0;n<result_ids.length;n++){update(table_name,result_ids,function(o){ids.push(o.ID);return data;});}
return ids;}},update:function(table_name,query,update_function){tableExistsWarn(table_name);var result_ids=[];if(!query){result_ids=getIDs(table_name);}else if(typeof query=='object'){result_ids=queryByValues(table_name,validFields(table_name,query));}else if(typeof query=='function'){result_ids=queryByFunction(table_name,query);}
return update(table_name,result_ids,update_function);},query:function(table_name,query,limit,start,sort,distinct){tableExistsWarn(table_name);var result_ids=[];if(!query){result_ids=getIDs(table_name,limit,start);}else if(typeof query=='object'){result_ids=queryByValues(table_name,validFields(table_name,query),limit,start);}else if(typeof query=='function'){result_ids=queryByFunction(table_name,query,limit,start);}
return select(table_name,result_ids,start,limit,sort,distinct);},queryAll:function(table_name,params){if(!params){return this.query(table_name)}else{return this.query(table_name,params.hasOwnProperty('query')?params.query:null,params.hasOwnProperty('limit')?params.limit:null,params.hasOwnProperty('start')?params.start:null,params.hasOwnProperty('sort')?params.sort:null,params.hasOwnProperty('distinct')?params.distinct:null);}},deleteRows:function(table_name,query){tableExistsWarn(table_name);var result_ids=[];if(!query){result_ids=getIDs(table_name);}else if(typeof query=='object'){result_ids=queryByValues(table_name,validFields(table_name,query));}else if(typeof query=='function'){result_ids=queryByFunction(table_name,query);}
return deleteRows(table_name,result_ids);}}}
if(typeof define==='function'&&define.amd){define(function(){return localStorageDB;});}else{_global['localStorageDB']=localStorageDB;}}(window));;$(function(){document.getElementById("logout_link").href='javascript:Auth.logout()';});function logged_in_callback(data){if(typeof Collection=='function')Collection.init();ga_logged_in_callback(data);if(data.status){localStorage.fi_user=JSON.stringify(data);}
clearTimeout(window.gr.auth.timeout);if(gr.auth.me.premium)
{$('.dropdown-upgrade').hide();}}
var Auth={error:function(data){localStorage.removeItem('fi_user');UserAlerts.warning(data.title,data.body);setTimeout(gr.auth.logout,3000);},logout:function(){localStorage.removeItem('fi_user');gr.auth.logout();}}
gr.auth.timeout=setTimeout(function(){UserAlerts.danger('Oopps!',messages.errors.connectivity);if(typeof Collection=='function')Collection.init();},5000);
;!function(t){var e=function(){var e='<div class="colpick"><div class="colpick_color"><div class="colpick_color_overlay1"><div class="colpick_color_overlay2"><div class="colpick_selector_outer"><div class="colpick_selector_inner"></div></div></div></div></div><div class="colpick_hue"><div class="colpick_hue_arrs"><div class="colpick_hue_larr"></div><div class="colpick_hue_rarr"></div></div></div><div class="colpick_new_color"></div><div class="colpick_current_color"></div><div class="colpick_hex_field"><div class="colpick_field_letter">#</div><input type="text" maxlength="6" size="6" /></div><div class="colpick_rgb_r colpick_field"><div class="colpick_field_letter">R</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_g colpick_field"><div class="colpick_field_letter">G</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_h colpick_field"><div class="colpick_field_letter">H</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_s colpick_field"><div class="colpick_field_letter">S</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_submit"></div></div>',a={showEvent:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},colorScheme:"light",color:"3289c7",livePreview:!0,flat:!1,layout:"full",submit:1,submitText:"OK",height:156},l=function(e,a){var i=c(e);t(a).data("colpick").fields.eq(1).val(i.r).end().eq(2).val(i.g).end().eq(3).val(i.b).end()},r=function(e,a){t(a).data("colpick").fields.eq(4).val(Math.round(e.h)).end().eq(5).val(Math.round(e.s)).end().eq(6).val(Math.round(e.b)).end()},n=function(e,a){t(a).data("colpick").fields.eq(0).val(d(e).toUpperCase())},s=function(e,a){t(a).data("colpick").selector.css("backgroundColor","#"+d({h:e.h,s:100,b:100})),t(a).data("colpick").selectorIndic.css({left:parseInt(t(a).data("colpick").height*e.s/100,10),top:parseInt(t(a).data("colpick").height*(100-e.b)/100,10)})},p=function(e,a){t(a).data("colpick").hue.css("top",parseInt(t(a).data("colpick").height-t(a).data("colpick").height*e.h/360,10))},h=function(e,a){t(a).data("colpick").currentColor.css("backgroundColor","#"+d(e))},u=function(e,a){t(a).data("colpick").newColor.css("backgroundColor","#"+d(e))},f=function(e){var a,h=t(this).parent().parent();this.parentNode.className.indexOf("_hex")>0?(h.data("colpick").color=a=i(L(this.value)),l(a,h.get(0)),r(a,h.get(0))):this.parentNode.className.indexOf("_hsb")>0?(h.data("colpick").color=a=X({h:parseInt(h.data("colpick").fields.eq(4).val(),10),s:parseInt(h.data("colpick").fields.eq(5).val(),10),b:parseInt(h.data("colpick").fields.eq(6).val(),10)}),l(a,h.get(0)),n(a,h.get(0))):(h.data("colpick").color=a=o(E({r:parseInt(h.data("colpick").fields.eq(1).val(),10),g:parseInt(h.data("colpick").fields.eq(2).val(),10),b:parseInt(h.data("colpick").fields.eq(3).val(),10)})),n(a,h.get(0)),r(a,h.get(0))),s(a,h.get(0)),p(a,h.get(0)),u(a,h.get(0)),h.data("colpick").onChange.apply(h.parent(),[a,d(a),c(a),h.data("colpick").el,0])},v=function(e){t(this).parent().removeClass("colpick_focus")},g=function(){t(this).parent().parent().data("colpick").fields.parent().removeClass("colpick_focus"),t(this).parent().addClass("colpick_focus")},k=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var a=t(this).parent().find("input").focus(),i={el:t(this).parent().addClass("colpick_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:e.pageY,field:a,val:parseInt(a.val(),10),preview:t(this).parent().parent().data("colpick").livePreview};t(document).mouseup(i,m),t(document).mousemove(i,_)},_=function(t){return t.data.field.val(Math.max(0,Math.min(t.data.max,parseInt(t.data.val-t.pageY+t.data.y,10)))),t.data.preview&&f.apply(t.data.field.get(0),[!0]),!1},m=function(e){return f.apply(e.data.field.get(0),[!0]),e.data.el.removeClass("colpick_slider").find("input").focus(),t(document).off("mouseup",m),t(document).off("mousemove",_),!1},b=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var a={cal:t(this).parent(),y:t(this).offset().top};t(document).on("mouseup touchend",a,y),t(document).on("mousemove touchmove",a,x);var i="touchstart"==e.type?e.originalEvent.changedTouches[0].pageY:e.pageY;return f.apply(a.cal.data("colpick").fields.eq(4).val(parseInt(360*(a.cal.data("colpick").height-(i-a.y))/a.cal.data("colpick").height,10)).get(0),[a.cal.data("colpick").livePreview]),!1},x=function(t){var e="touchmove"==t.type?t.originalEvent.changedTouches[0].pageY:t.pageY;return f.apply(t.data.cal.data("colpick").fields.eq(4).val(parseInt(360*(t.data.cal.data("colpick").height-Math.max(0,Math.min(t.data.cal.data("colpick").height,e-t.data.y)))/t.data.cal.data("colpick").height,10)).get(0),[t.data.preview]),!1},y=function(e){return l(e.data.cal.data("colpick").color,e.data.cal.get(0)),n(e.data.cal.data("colpick").color,e.data.cal.get(0)),t(document).off("mouseup touchend",y),t(document).off("mousemove touchmove",x),!1},w=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var a={cal:t(this).parent(),pos:t(this).offset()};a.preview=a.cal.data("colpick").livePreview,t(document).on("mouseup touchend",a,M),t(document).on("mousemove touchmove",a,C);var i;return"touchstart"==e.type?(pageX=e.originalEvent.changedTouches[0].pageX,i=e.originalEvent.changedTouches[0].pageY):(pageX=e.pageX,i=e.pageY),f.apply(a.cal.data("colpick").fields.eq(6).val(parseInt(100*(a.cal.data("colpick").height-(i-a.pos.top))/a.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*(pageX-a.pos.left)/a.cal.data("colpick").height,10)).get(0),[a.preview]),!1},C=function(t){var e;return"touchmove"==t.type?(pageX=t.originalEvent.changedTouches[0].pageX,e=t.originalEvent.changedTouches[0].pageY):(pageX=t.pageX,e=t.pageY),f.apply(t.data.cal.data("colpick").fields.eq(6).val(parseInt(100*(t.data.cal.data("colpick").height-Math.max(0,Math.min(t.data.cal.data("colpick").height,e-t.data.pos.top)))/t.data.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(t.data.cal.data("colpick").height,pageX-t.data.pos.left))/t.data.cal.data("colpick").height,10)).get(0),[t.data.preview]),!1},M=function(e){return l(e.data.cal.data("colpick").color,e.data.cal.get(0)),n(e.data.cal.data("colpick").color,e.data.cal.get(0)),t(document).off("mouseup touchend",M),t(document).off("mousemove touchmove",C),!1},I=function(e){var a=t(this).parent(),i=a.data("colpick").color;a.data("colpick").origColor=i,h(i,a.get(0)),a.data("colpick").onSubmit(i,d(i),c(i),a.data("colpick").el)},T=function(e){e.stopPropagation();var a=t("#"+t(this).data("colpickId"));a.data("colpick").onBeforeShow.apply(this,[a.get(0)]);var i=t(this).offset(),o=i.top+this.offsetHeight,c=i.left,l=S(),d=a.width();c+d>l.l+l.w&&(c-=d),a.css({left:c+"px",top:o+"px"}),0!=a.data("colpick").onShow.apply(this,[a.get(0)])&&a.show(),t("html").mousedown({cal:a},q),a.mousedown(function(t){t.stopPropagation()})},q=function(e){0!=e.data.cal.data("colpick").onHide.apply(this,[e.data.cal.get(0)])&&e.data.cal.hide(),t("html").off("mousedown",q)},S=function(){var t="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(t?document.documentElement.scrollLeft:document.body.scrollLeft),w:window.innerWidth||(t?document.documentElement.clientWidth:document.body.clientWidth)}},X=function(t){return{h:Math.min(360,Math.max(0,t.h)),s:Math.min(100,Math.max(0,t.s)),b:Math.min(100,Math.max(0,t.b))}},E=function(t){return{r:Math.min(255,Math.max(0,t.r)),g:Math.min(255,Math.max(0,t.g)),b:Math.min(255,Math.max(0,t.b))}},L=function(t){var e=6-t.length;if(e>0){for(var a=[],i=0;e>i;i++)a.push("0");a.push(t),t=a.join("")}return t.toUpperCase()},P=function(){var e=t(this).parent(),a=e.data("colpick").origColor;e.data("colpick").color=a,l(a,e.get(0)),n(a,e.get(0)),r(a,e.get(0)),s(a,e.get(0)),p(a,e.get(0)),u(a,e.get(0))};return{init:function(c){if(c=t.extend({},a,c||{}),"string"==typeof c.color)c.color=i(c.color);else if(void 0!=c.color.r&&void 0!=c.color.g&&void 0!=c.color.b)c.color=o(c.color);else{if(void 0==c.color.h||void 0==c.color.s||void 0==c.color.b)return this;c.color=X(c.color)}return this.each(function(){if(!t(this).data("colpickId")){var a=t.extend({},c);a.origColor=c.color;var i="collorpicker_"+parseInt(1e3*Math.random());t(this).data("colpickId",i);var o=t(e).attr("id",i);o.addClass("colpick_"+a.layout+(a.submit?"":" colpick_"+a.layout+"_ns")),"light"!=a.colorScheme&&o.addClass("colpick_"+a.colorScheme),o.find("div.colpick_submit").html(a.submitText).click(I),a.fields=o.find("input").change(f).blur(v).focus(g),o.find("div.colpick_field_arrs").mousedown(k).end().find("div.colpick_current_color").click(P),a.selector=o.find("div.colpick_color").on("mousedown touchstart",w),a.selectorIndic=a.selector.find("div.colpick_selector_outer"),a.el=this,a.hue=o.find("div.colpick_hue_arrs"),huebar=a.hue.parent();var d=navigator.userAgent.toLowerCase(),_="Microsoft Internet Explorer"===navigator.appName,m=_?parseFloat(d.match(/msie ([0-9]{1,}[\.0-9]{0,})/)[1]):0,x=_&&10>m,y=["#ff0000","#ff0080","#ff00ff","#8000ff","#0000ff","#0080ff","#00ffff","#00ff80","#00ff00","#80ff00","#ffff00","#ff8000","#ff0000"];if(x){var C,M;for(C=0;11>=C;C++)M=t("<div></div>").attr("style","height:8.333333%; filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr="+y[C]+", endColorstr="+y[C+1]+'); -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='+y[C]+", endColorstr="+y[C+1]+')";'),huebar.append(M)}else stopList=y.join(","),huebar.attr("style","background:-webkit-linear-gradient(top,"+stopList+"); background: -o-linear-gradient(top,"+stopList+"); background: -ms-linear-gradient(top,"+stopList+"); background:-moz-linear-gradient(top,"+stopList+"); -webkit-linear-gradient(top,"+stopList+"); background:linear-gradient(to bottom,"+stopList+"); ");o.find("div.colpick_hue").on("mousedown touchstart",b),a.newColor=o.find("div.colpick_new_color"),a.currentColor=o.find("div.colpick_current_color"),o.data("colpick",a),l(a.color,o.get(0)),r(a.color,o.get(0)),n(a.color,o.get(0)),p(a.color,o.get(0)),s(a.color,o.get(0)),h(a.color,o.get(0)),u(a.color,o.get(0)),a.flat?(o.appendTo(this).show(),o.css({position:"relative",display:"block"})):(o.appendTo(document.body),t(this).on(a.showEvent,T),o.css({position:"absolute"}))}})},showPicker:function(){return this.each(function(){t(this).data("colpickId")&&T.apply(this)})},hidePicker:function(){return this.each(function(){t(this).data("colpickId")&&t("#"+t(this).data("colpickId")).hide()})},setColor:function(e,a){if(a="undefined"==typeof a?1:a,"string"==typeof e)e=i(e);else if(void 0!=e.r&&void 0!=e.g&&void 0!=e.b)e=o(e);else{if(void 0==e.h||void 0==e.s||void 0==e.b)return this;e=X(e)}return this.each(function(){if(t(this).data("colpickId")){var i=t("#"+t(this).data("colpickId"));i.data("colpick").color=e,i.data("colpick").origColor=e,l(e,i.get(0)),r(e,i.get(0)),n(e,i.get(0)),p(e,i.get(0)),s(e,i.get(0)),u(e,i.get(0)),i.data("colpick").onChange.apply(i.parent(),[e,d(e),c(e),i.data("colpick").el,1]),a&&h(e,i.get(0))}})}}}(),a=function(t){var t=parseInt(t.indexOf("#")>-1?t.substring(1):t,16);return{r:t>>16,g:(65280&t)>>8,b:255&t}},i=function(t){return o(a(t))},o=function(t){var e={h:0,s:0,b:0},a=Math.min(t.r,t.g,t.b),i=Math.max(t.r,t.g,t.b),o=i-a;return e.b=i,e.s=0!=i?255*o/i:0,0!=e.s?t.r==i?e.h=(t.g-t.b)/o:t.g==i?e.h=2+(t.b-t.r)/o:e.h=4+(t.r-t.g)/o:e.h=-1,e.h*=60,e.h<0&&(e.h+=360),e.s*=100/255,e.b*=100/255,e},c=function(t){var e={},a=t.h,i=255*t.s/100,o=255*t.b/100;if(0==i)e.r=e.g=e.b=o;else{var c=o,l=(255-i)*o/255,d=(c-l)*(a%60)/60;360==a&&(a=0),60>a?(e.r=c,e.b=l,e.g=l+d):120>a?(e.g=c,e.b=l,e.r=c-d):180>a?(e.g=c,e.r=l,e.b=l+d):240>a?(e.b=c,e.r=l,e.g=c-d):300>a?(e.b=c,e.g=l,e.r=l+d):360>a?(e.r=c,e.g=l,e.b=c-d):(e.r=0,e.g=0,e.b=0)}return{r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)}},l=function(e){var a=[e.r.toString(16),e.g.toString(16),e.b.toString(16)];return t.each(a,function(t,e){1==e.length&&(a[t]="0"+e)}),a.join("")},d=function(t){return l(c(t))};t.fn.extend({colpick:e.init,colpickHide:e.hidePicker,colpickShow:e.showPicker,colpickSetColor:e.setColor}),t.extend({colpick:{rgbToHex:l,rgbToHsb:o,hsbToHex:d,hsbToRgb:c,hexToHsb:i,hexToRgb:a}})}(jQuery);
;var db;$(function(){setInterval(function(){[].forEach.call(document.getElementsByClassName("collectionIconImage"),function(i){Widget.renderSVG(i);});if(!$_(".collections"))Widget.update();},5000);$(".modal-collection #download-collection-free").on("click",function(e){e.stopPropagation();$("#download-collection-form").submit();$_("#modal-collection").checked=false;});$("#max-collections-content").on("click",'.box',function(e){e.stopPropagation();Collection.del(this.dataset.bookmark);var counter=(Collection.limit.collections)?db.rowCount("list")-Collection.limit.collections:0;$_(".max-collections-container .deleteCounter").innerHTML=counter;if(!counter)$_("#max-collections").classList.remove('visible');});$(document).on("click",".icon .overlay button",function(e){e.stopPropagation();var elem=this.parent(".icon");Widget[(elem.classList.contains('selected'))?'delIcon':'addIcon'](elem.dataset.id,elem.dataset.name,elem.dataset.team);});$(document).on("click",".collection-header",function(e){e.stopPropagation();window.launching=true;var parent=this.parent('.collection');if(!parent.classList.contains('expanded')){window.firstColorChange=true;Collection.setActive(parent.dataset.id);}else{var edit=parent.get('.edit-name');edit.classList.add("active");edit.get('input').select();}
$_("#list_collections_btn").disabled=false;});$(document).on("click",".collectionIcon .edit .popover-button",function(){Widget.createIconsCPicker(this);});$(document).on("click",".collection .edit-name",function(e){e.stopPropagation()
Collection.rename(this);});$(document).on('click','.download-holder button',function(e){e.stopPropagation();this.parent('.collection').get('.collection-download').classList.add('active');});$(document).on("click",'ul.download li a',function(e){e.stopPropagation();e.preventDefault();this.parent('.download-files').get('.customize').classList.add("active");});$(document).on("click",'.collection-download.active .download-button',function(e){e.stopPropagation();var collection=this.parent('.collection');collection.get('.collection-download .customize').classList.remove("active");collection.get('.collection-download').classList.remove("active");Collection.download(collection.dataset.bookmark,this.dataset.format,this.dataset.size);});$(document).on("click",'.collection-download.active .header-download button',function(e){e.stopPropagation();var collection=this.parent('.collection');collection.get('.collection-download .customize').classList.remove("active");collection.get('.collection-download').classList.remove("active");});$(window).resize(function(){clearTimeout(window.resizeWindowInterval);window.resizeWindowInterval=setTimeout(function(){var collection_content=$_(".collection.expanded .collection-content");delete window.resizeWindowInterval;},500);});$(document).on("scroll",'#collections',function(e){ev.stopPropagation();ev.preventDefault();ev.returnValue=false;return false;});var scrollable='#collections, #collections-holder.scrollable, #collections .icons, .collection-download';$(document).on('DOMMouseScroll mousewheel',scrollable,function(ev){ev.stopPropagation();var up=(ev.type=='DOMMouseScroll'?ev.originalEvent.detail*-40:ev.originalEvent.wheelDelta)>0,c=this.scrollTop/(this.scrollHeight-this.clientHeight),prevent=function(){ev.preventDefault();ev.returnValue=false;return false;}
var list=document.get('.collection.expanded .icons');var download=document.get('.collection.expanded .collection-download.active');var holder=document.get('#collections-holder.scrollable');var scroll=(holder)?holder:((download)?download:list);var scrollBar=(scroll&&scroll.scrollHeight>scroll.clientHeight)||false;if((!up&&c===1)||(up&&c===0)||!scrollBar)return prevent();});$(document).on("keyup",".collection-name-input",function(e){e.preventDefault();if(e.which==13)Collection.rename(this);if(e.which==27){this.value=this.dataset.original;this.parentElement.classList.remove('active');this.blur();}});$(document).on("click touchstart",'.collection-icon-rename',function(e){e.stopPropagation();this.select();});$(document).on("keyup",'.collection-icon-rename',function(e){e.preventDefault();if(e.which==13)Icon.rename(this);if(e.which==27)this.value=this.dataset.original;});$(document).on("blur",'.collection-icon-rename',Icon.rename);$(document).on("click touchstart",'.collection-icon-delete',function(e){e.stopPropagation();e.preventDefault();Widget.delIcon(parseInt(this.parent('.icon').dataset.id,10));});$(document).on('click','#collections-toggle',function(e){e.stopPropagation();Widget.toggle();});$(document).on("click",'.collection-header button.flaticon-pencil',function(e){e.stopPropagation();var edit=this.parentElement.get('.edit-name');[].forEach.call(document.find(".collection .collection-header .edit-name"),function(e){e.classList.remove('active');});edit.classList.add("active");edit.get('input').select();});$(document).on("click",'.collection-options button.flaticon-pencil',Collection.openEditMode);$(document).on("click",".collection .collection-content .header-edit .btn-back",Collection.closeEditMode);$(document).on("click",'.collection-options button.flaticon-bin',function(e){e.stopPropagation();$_("#modal-delete-collection").checked=true;});$(document).on("click touchstart",'.collection .color-selector li button',function(e){$(this.parent('.color-selector').nextElementSibling).colpickSetColor(this.dataset.color);});$(document).on("click touchstart",".collection_color_button",Widget.createCollectionCPicker);});function Collection(data,loading){var properties=['bookmark_id','name','color','created','updated','active','order','source'];var ts=getTimestamp();this.bookmark_id=data.bookmark_id||(Math.random().toString(36)+'00000000000000000').slice(2,16+2);this.name=data.name||"My icons collection";this.color=data.color||'000000';this.created=data.created;this.updated=data.updated;this.active=parseInt(data.active,10)||1;this.order=parseInt(data.order,10)||0;this.source=data.source||'local';this.icons=data.icons||[];db.update('list',function(){return true},function(collection){collection.active=0;collection.order++;return collection;});db.commit();data={};var self=this;properties.forEach(function(k){data[k]=self[k];});db.insert("list",data);if(db.tableExists(this.bookmark_id)){db.dropTable(this.bookmark_id);}
if(this.icons.length){db.createTableWithData(this.bookmark_id,this.icons);}else{db.createTable(this.bookmark_id,Icon.properties);}
db.commit();if(!loading&&data.bookmark_id!='tour_demo_collection'){Collection.emit('create',data);}
Widget.update();}
function Icon(id,name,author,color,bookmark_id,created,updated){var ts=getTimestamp();if(typeof id!='number')throw"Invalid icon id";if(!bookmark_id)throw"Invalid bookmark_id";if(typeof author!='number')throw"Invalid author";this.id=parseInt(id,10);this.name=(name.toString().length)?slug(name.toString()):'icon-'+this.id;this.author=parseInt(author,10);this.bookmark_id=bookmark_id;this.color=isValidColor(color)?color:"000000";this.created=ts;this.updated=ts;if(!db.queryAll(this.bookmark_id,{query:{id:this.id}}).length){var data={};var self=this;Icon.properties.forEach(function(i){data[i]=self[i];});db.insertOrUpdate(this.bookmark_id,{id:data.id},data);db.commit();Widget.updateToggle();}}
Icon.properties=["id","name","author","color","created","updated"];Icon.set=function(id,values,bookmark_id,loading){if(!id)throw"Invalid icon id (Icon.set)";if(!bookmark_id)throw"Invalid bookmark_id (Icon.set)";var updatable=['color','name'];for(var k in values){if(updatable.indexOf(k)==-1){delete values[k];}}
if(!db.tableExists(bookmark_id))throw"Table "+bookmark_id+" doesn't exists (Icon.set)";if(!Object.keys(values).length)throw"Nothing to update (Icon.set)";var date=getTimestamp();db.update('list',{bookmark_id:bookmark_id},function(collection){collection.updated=date;return collection;});db.update(bookmark_id,{id:id},function(icon){for(var i in values){icon[i]=values[i];}
values={};Icon.properties.forEach(function(field){values[field]=icon[field];});values.bookmark_id=bookmark_id;values.updated=date;if(!loading){Collection.emit('put_icon',values);}
return icon;});db.commit();}
Icon.toggle=function(id){if(typeof toggleDetailButton=='function')toggleDetailButton();var ico=$_(".icons .icon[data-id='"+id+"']:not(.collectionIcon)");if(!ico)return;ico.classList.toggle('selected');var btn=ico.get(".overlay button");var actions=['add','remove'];if(ico.classList.contains('selected'))actions.reverse();btn.classList[actions[0]]('flaticon-collections_add');btn.classList[actions[1]]('flaticon-collections_remove');}
Icon.rename=function(elem){elem=(elem instanceof(Element))?elem:elem.currentTarget;var name=(elem.value.length)?slug(elem.value):elem.dataset.original;if(name==elem.dataset.original)return;var id=parseInt(elem.parent('.icon').dataset.id,10);var bookmark_id=$_(".collection[data-order='0']").dataset.bookmark;Icon.set(id,{name:name},bookmark_id);elem.dataset.original=name;elem.value=name;ga('send','event','Collection','Rename Icon');}
Collection.init=function(){if(db)return;Collection.limit={};var properties={icons:{value:50},collections:{value:1}};if(gr.auth.logged){var dropdown=$_(".dropdown-upgrade.register");properties={icons:{value:256},collections:{value:3}}}else{var dropdown=$_(".dropdown-upgrade.upgrade");}
if(dropdown){dropdown.parentElement.removeChild(dropdown);}
if(gr.auth.me.premium){properties.collections.value=0;}
Object.defineProperties(Collection.limit,properties);Object.freeze(Collection);var db_name=gr.auth.me.id||0;db=new localStorageDB(db_name);if(!db.tableExists('list')){db.createTable("list",["name","bookmark_id","created","updated","active","source","order","color"]);}
if(db.tableExists('tour_demo_collection')){db.dropTable('tour_demo_collection');db.deleteRows('list',{bookmark_id:'tour_demo_collection'});}
db.commit();if(localStorage.getItem('fi')){Collection.upgradeCollections();}
var set_id=localStorage.getItem('widget_state_user');if(set_id!==gr.auth.me.id){$_("#collections-holder").innerHTML='';}
if(gr.auth.logged){Collection.push();}else{Widget.update();}}
Collection.pull=function(){Collection.emit('pull');}
Collection.upgradeCollections=function(){var old_library=JSON.parse(localStorage.fi);localStorage.removeItem('fi');var library=[];for(var i in old_library){var collection=old_library[i];var updated=getTimestamp();var created=getTimestamp(collection.created);if(isNaN(created))
created=updated;library.push({bookmark_id:collection.id,name:collection.nombre,color:'000000',icons:Object.keys(collection.iconos).map(function(id){return{id:collection.iconos[id].id,name:collection.iconos[id].keyword,created:updated,updated:updated,color:'000000',author:null};}),created:created,updated:updated,});}
Collection.emit('upgrade',{data:library});}
Collection.upgradeLibrary=function(collections){collections.forEach(function(collection){new Collection(collection,true);});localStorage.removeItem('fi');}
Collection.openEditMode=function(){Collection._toggleEditMode('add');}
Collection.closeEditMode=function(){Collection._toggleEditMode('remove');}
Collection._toggleEditMode=function(method){var collection=$_('.collection[data-order="0"]');collection.get('.collection-content').classList[method]('edit-mode');collection.get('.header-edit').classList[method]('visible');}
Collection.merge=function(){var _db=new localStorageDB(0);var library=_db.queryAll("list");library.forEach(function(collection){collection.icons=_db.queryAll(collection.bookmark_id);if(collection.icons.length){var ts=getTimestamp();if(!collection.created)collection.created=ts;if(!collection.updated)collection.updated=ts;new Collection(collection,false);}});_db.drop();}
Collection.set_id=function(params){db.renameTable(params.old_id,params.bookmark_id);db.update("list",{bookmark_id:params.old_id},function(collection){collection.bookmark_id=params.bookmark_id;collection.source='remote';return collection;});db.commit();Collection.setLimits();$_(".collection[data-bookmark='"+params.old_id+"']").dataset.bookmark=params.bookmark_id;}
function callback_handler(data){if(data.namespace){var q=data.namespace.split(".");if(typeof window[q[0]][q[1]]==="function"){delete data.namespace;window[q[0]][q[1]](data);}}}
Collection.emit=function(event,data){if(event!='push'){Widget.saveState();}
if(gr.auth.me.id){data=(data instanceof(Object))?data:{};if(data.bookmark_id=='tour_demo_collection')return;gr.request.post(ACCOUNTS_BASE_URL+'collections2/'+event,data);}}
Collection.limitReached=function(){if(db.rowCount("list")<=Collection.limit.collections){return;}
var collectionLimitBox=$_(".max-collections-content"),tpl=Handlebars.tag("collection-limit-box"),library=db.queryAll("list"),counter=(Collection.limit.collections)?library.length-Collection.limit.collections:0;if(counter<1)return;$_(".max-collections-container .deleteCounter").innerHTML=counter;$_("#max-collections").classList.add('visible');collectionLimitBox.innerHTML='';library.forEach(function(collection){collection.icons=db.queryAll(collection.bookmark_id,{limit:10,sort:[["created","DESC"]]});collection.count=db.rowCount(collection.bookmark_id);collectionLimitBox.insertAdjacentHTML('beforeend',tpl(collection));});}
Collection.set=function(bookmark_id,new_values){var collectionElem=$_(".collection[data-bookmark='"+bookmark_id+"']");var force=new_values.force;var old_color=new_values.old_color;for(var i in new_values){if(["name","bookmark_id","source","color"].indexOf(i)==-1)delete new_values[i];}
var keys=Object.keys(new_values);if(!keys.length)return;new_values.updated=getTimestamp();db.update("list",{bookmark_id:bookmark_id},function(collection){if('name'in new_values)
collectionElem.get(".collection-name").innerHTML=new_values.name;if('bookmark_id'in new_values)
collectionElem.dataset.bookmark=new_values.bookmark_id;var data={bookmark_id:bookmark_id,force:force,old_color:old_color};for(var i in new_values){collection[i]=new_values[i];data[i]=new_values[i];}
Collection.emit('set',data);return collection;});db.commit();}
Collection.editName=function(){var inputTxt=$_(".collections [data-order='0'] .collection-header .edit-name");inputTxt.classList.add("active");inputTxt.get("input").select();}
Collection.list=function(){var collectionHolder=$_('#collections-holder');[].forEach.call(document.find('#collections .collection'),function(item){if(item.getAttribute('data-order')==0&&item.classList.contains('expanded')){item.classList.remove('expanded');ga('send','event','Collection','List','Hide');}else{if(item.getAttribute('data-order')==0)item.classList.add('expanded');ga('send','event','Collection','List','Show');}});collectionHolder.classList.toggle('overflow');collectionHolder.classList.toggle('scrollable');}
Collection.setActive=function(id){id=parseInt(id,10);var list=db.queryAll("list",{sort:[["order","ASC"]]});var order=[id];var holder=$_("#collections-holder");holder.scrollTop=0;holder.classList.add('overflow');holder.classList.remove('scrollable');var collectionHeight=list.length>1?(list.length>2?'collection-height-2':'collection-height-1'):'collection-height';list.forEach(function(collection){if(collection.ID!=id)order.push(collection.ID);var elem=$_('.collection[data-bookmark="'+collection.bookmark_id+'"]');collection.order=order.indexOf(collection.ID);elem.dataset.order=collection.order;if(collection.ID==id){collection.active=1;elem.classList.remove('collection-height-1','collection-height-2');elem.classList.add('expanded');if(collectionHeight.length){elem.classList.add(collectionHeight);}}else{collection.active=0;elem.classList.remove('collection-height-1','collection-height-2','expanded');}
db.update("list",{ID:collection.ID},function(row){row.order=collection.order;row.active=collection.active;return row;});db.commit();});Widget.update();}
Collection.getActive=function(){if(!db)return;if(!db.rowCount("list"))throw"No collections stored";var collection=db.queryAll("list",{query:{active:1}});if(collection.length)collection=collection[0];else collection=db.queryAll("list")[0];return collection;}
Collection.clear=function(bookmark_id){db.truncate(bookmark_id);Widget.clear();Collection.emit('clear',{bookmark_id:bookmark_id});ga('send','event','Collection','Clear');}
Collection.del=function(id,prevent){if(id instanceof Object){prevent=true,id=id.id;}
if(!id){id=$_(".collection[data-order='0']").dataset.bookmark;}
var collection=db.queryAll("list",{query:{bookmark_id:id}});if(!collection.length){db.dropTable(id);db.commit();return false;}
collection=collection[0];db.deleteRows("list",{bookmark_id:collection.bookmark_id});if(db.tableExists(collection.bookmark_id)){db.dropTable(collection.bookmark_id);}
db.update("list",function(col){return(col.ID>collection.ID)?true:false;},function(col){col.order=parseInt(col.order,10)-1;});db.commit();var col_elem=$_(".collection[data-bookmark='"+collection.bookmark_id+"']");if(!col_elem){return false;}
col_elem.parentElement.removeChild(col_elem);$_("#new_collection_btn").disabled=(Collection.limit.collections&&db.rowCount('list')>=Collection.limit.collections);if(collection.bookmark_id!="tour_demo_collection"&&db.rowCount("list")==1){Collection.clear(collection.bookmark_id);return;};if(!db.rowCount("list")){Collection.new();}
if(!prevent){Collection.emit('del',{bookmark_id:collection.bookmark_id});ga('send','event','Collection','Delete');}
Widget.update();}
Collection.new=function(options){if(Collection.limit.collections&&db.rowCount('list')>=Collection.limit.collections){return;}
if(typeof options=="undefined"||!options instanceof(Object))options={};ga('send','event','Collection','Create');options.name=(typeof options.name=="undefined"||!options.name.length)?'My icons collection':options.name;new Collection(options);}
Collection.push=function(id){var query=(id&&typeof id=='number')?{query:{bookmark_id:id}}:{};var collections=db.queryAll("list",query);collections.forEach(function(collection){['ID','order','active'].forEach(function(index){delete collection[index];});collection.icons=db.queryAll(collection.bookmark_id,{sort:[["created","ASC"]]});});Collection.emit('push',{data:collections});}
Collection.enqueue=function(queue){if(Object.keys(queue).length){for(var ev in queue){if(typeof window[queue[ev].namespace][queue[ev].callback]=='function'){window[queue[ev].namespace][queue[ev].callback](queue[ev].data);}}}
if(localStorage.getItem('fi_0')){Collection.merge();}
Widget.update();localStorage.widget_state=$_("#collections-holder").innerHTML;localStorage.widget_state_user=gr.auth.me.id;}
Collection.load=function(collections){if(!Array.isArray(collections)&&typeof collections=="object"){var collections=Object.keys(collections).map(function(k){return collections[k];});}
collections.forEach(function(collection){try{var bookmark_id=collection.bookmark_id;var elem=$_(".collection[data-bookmark='"+bookmark_id+"']");if(elem){elem.parentElement.removeChild(elem);}
db.deleteRows("list",{bookmark_id:bookmark_id});if(db.tableExists(bookmark_id)){db.dropTable(bookmark_id);}}catch(e){}
collection.source='remote';new Collection(collection,true);});window.firstColorChange=true;}
Collection.rename=function(elem){if(!elem)elem=$_(".collection[data-order='0'] .collection-header .edit-name input");var parent=elem.parent('.collection'),inputTxt=parent.get(".collection-header .edit-name"),name=inputTxt.get("input").value,name=(name.length)?name:'My icons collection';inputTxt.classList.remove('active');if(elem.dataset.original==name)return;parent.get('.collection-name').innerHTML=name;elem.dataset.original=name;Collection.set(parent.dataset.bookmark,{name:name});ga('send','event','Collection','Rename');}
Collection.download=function(bookmark_id,format,size){var collection=db.queryAll("list",{query:{bookmark_id:bookmark_id}});if(!collection.length){return;}
collection=collection[0];collection.icons=db.queryAll(bookmark_id).map(function(i){return{id:i.id,team:i.author,name:i.name,color:"#"+i.color}});if(!collection.icons.length){return;}
size=size||512;$('#download-collection-form').attr('action','/download-collection');document.getElementById('downC_format').value=format||'font';document.getElementById('downC_size').value=size||512;document.getElementById('downC_user_id').value=gr.auth.me.id||0;document.getElementById('downC_bookmark_id').value=collection.bookmark_id;document.getElementById('downC_bookmark_name').value=collection.name;document.getElementById('downC_icons').value=JSON.stringify(collection.icons);$_(".modal-collection .collection_name").innerHTML=collection.name;if(new Date()<new Date(parseInt(localStorage.break_while,10))||gr.auth.me.premium){$("#download-collection-form").submit();}else{$_("#modal-collection").checked=true;}
ga('send','event','Collection','Download',document.getElementById('downC_format').value.toUpperCase(),collection.icons.length,{'metric2':collection.icons.length});};function Widget(){}
Widget.saveState=function(){return;localStorage.widget_state=$_("#collections-holder").innerHTML;localStorage.widget_state_user=gr.auth.me.id;}
Widget.changeIconColor=function(color,elem,preventSetting,preventEmiting,isLight,fromCollectionSet){var ico=$(elem).parents('.icon')[0];var collection=$(elem).parents('.collection')[0];if(ico){[].forEach.call(ico.querySelectorAll("path, circle, ellipse, polygon, line, rect, polyline"),function(p){p.style.fill="#"+color;});if(isLight){ico.classList.add('whitebg');}else{ico.classList.remove('whitebg');}
Widget.markSelectedColor(color,ico);if(ico.dataset.color!=color){ico.dataset.color=color;if(!preventSetting){var key=['icoChangeColor',ico.dataset.id,collection.dataset.bookmark].join("_");if(collection.dataset.bookmark=='tour_demo_collection')return;clearTimeout(window[key]);window[key]=setTimeout(function(){Icon.set(ico.dataset.id,{color:color},collection.dataset.bookmark,preventEmiting);ga('send','event','Collection','Change Icon Color',color,{'dimension11':color});delete window[key];},500);}}}}
Widget.isLight=function(color){var r=parseInt(color.substr(0,2),16);var g=parseInt(color.substr(2,2),16);var b=parseInt(color.substr(4,2),16);return((r*299)+(g*587)+(b*114))>=225000;}
Widget.changeCollectionColor=function(color,elem){var collection=$_(".collection[data-order='0']"),update=collection.dataset.color!=color,current_color=collection.dataset.color,icons;if(!update)return;collection.dataset.color=color;Widget.markSelectedColor(color,collection);icons=(collection.get('#color-lock').checked)?collection.querySelectorAll('svg'):collection.querySelectorAll('.icon[data-color="'+current_color+'"] svg');if(icons){var isLight=Widget.isLight(color);[].forEach.call(icons,function(svg){Widget.changeIconColor(color,svg,false,true,isLight,true);});}
if(collection.dataset.bookmark=='tour_demo_collection')return;clearTimeout(window.changeCollectionColorInterval);window.changeCollectionColorInterval=setTimeout(function(){if(!window.firstColorChange){Collection.set(collection.dataset.bookmark,{color:color,force:collection.get('#color-lock').checked,old_color:current_color});ga('send','event','Collection','Change Color',color,{'dimension11':color});}
if(window.firstColorChange){delete window.firstColorChange;}},500);}
Widget.updateButtons=function(){var count=db.rowCount("list");if(!db.tableExists('tour_demo_collection')&&count>Collection.limit.collections){Collection.limitReached();}
$_("#list_collections_btn").disabled=false;$_("#new_collection_btn").disabled=(Collection.limit.collections&&count>=Collection.limit.collections);}
Widget.updateToggle=function(){var toggle=$_('#collections-toggle');var collection=Collection.getActive();if(!collection)return;var count=db.rowCount(collection.bookmark_id);if(count>=Collection.limit.icons){var elem=$_(".collection[data-bookmark='"+collection.bookmark_id+"']");if(gr.auth.me.id){elem.get('.max-icons-collection').style.display='block';UserAlerts.danger('Ooop!',messages.limit.registered);}else{elem.get('.icons-collection-noregister').style.display='block';UserAlerts.danger('Ooop!',messages.limit.guest);}
toggle.classList.add('limit-reached');}else
toggle.classList.remove('limit-reached');var elem=$_(".collection[data-bookmark='"+collection.bookmark_id+"']");elem.get('.badge.badge-gray').innerHTML=count;elem.get('.collection-content .download-holder button').disabled=!Boolean(count);elem.get(".collection-options button.collection_color_button").disabled=!Boolean(count);elem.get(".collection-options button.flaticon-pencil").disabled=!Boolean(count);var badge=toggle.get('.badge');badge.innerHTML=count;badge.classList.add('animate');var badgeTimeout=setTimeout(function(){clearTimeout(badgeTimeout);badge.classList.remove('animate');},500);toggle.classList.remove('loading');$_("#collections").classList.remove('loading');}
Widget.renderIcons=function(icons,collection){$_("#collections-toggle").classList.add('loading');var list=collection.get('.icons');if(list.childElementCount)return;var tpl=false;icons.sort(function(a,b){return(a.updated>b.updated)?-1:1;});var load=false;icons.forEach(function(icon){var ico=collection.get('.icons .collectionIcon[data-id="'+icon.id+'"]');if(!ico){if(!tpl){tpl=Handlebars.tag('collection-icon');}
load=true;list.insertAdjacentHTML('beforeend',tpl(icon));};});if(load){[].forEach.call($_(".collectionIconImage"),function(i){Widget.renderSVG(i);});}
collection.get(".collection-options button.collection_color_button").disabled=!icons.length;collection.get(".collection-options button.flaticon-pencil").disabled=!icons.length;collection.get('.badge.badge-gray').innerHTML=icons.length;if(icons.length>=Collection.limit.icons)
collection.classList.add('limit-reached');else
collection.classList.remove('limit-reached');Widget.markSelectedColor(collection.color,collection);}
Widget.renderCollection=function(data){var count=db.rowCount("list"),collection=$_(".collection[data-bookmark='"+data.bookmark_id+"']");if(!collection){var tpl=Handlebars.tag('collection'),elem=document.getElementById("collections-holder");elem.insertAdjacentHTML('beforeend',tpl(data));collection=$_(".collection[data-bookmark='"+data.bookmark_id+"']");}
if(!data.order){var collectionHeight=count>1?(count.length>2?'collection-height-2':'collection-height-1'):'';if(collectionHeight.length){collection.classList.add(collectionHeight);}
collection.classList.add('expanded');if(data.icons.length){Widget.renderIcons(data.icons,collection);}}else{collection.classList.remove('expanded','collection-height-2','collection-height-1');}
collection.get('.badge.badge-gray').innerHTML=data.icons.length;}
Widget.update=function(){var count=db.rowCount("list");if(!count){Collection.new();}
Widget.updateButtons(count);$_(".collection-section-header .collections-number").innerHTML=count;var cssProps=['-webkit-box-ordinal-group','-moz-box-ordinal-group','box-ordinal-group','-webkit-order','-moz-order','order','-ms-flex-order',''];db.queryAll('list',{sort:[["order","ASC"]]}).forEach(function(collection,order,list){if(collection.order!=order||(order&&collection.active)){db.update("list",{bookmark_id:collection.bookmark_id},function(row){row.order=order;row.active=(!order)?1:0;return row;});db.commit();collection.order=order;collection.active=(!order)?1:0;}
var elem=$_(".collection[data-bookmark='"+collection.bookmark_id+"']");collection.icons=db.queryAll(collection.bookmark_id);if(!elem){window.firstColorChange=true;Widget.renderCollection(collection);elem=$_(".collection[data-bookmark='"+collection.bookmark_id+"']");}
elem=$_(".collection[data-bookmark='"+collection.bookmark_id+"']");elem.style.cssText=cssProps.join(":"+order+";");elem.dataset.order=order;if(order){elem.classList.remove("expanded");}else{var collectionHeight=list.length>1?(list.length>2?'collection-height-2':'collection-height-1'):'collection-height';elem.classList.add("expanded");if(collectionHeight.length){elem.classList.add(collectionHeight);}
if(collection.icons){Widget.renderIcons(collection.icons,elem);}}
Widget.markSelectedIcons();Widget.setLimits(collection);});window.launching=null;Widget.updateToggle();Widget.saveState();}
Widget.setLimits=function(collection){var elem=$_(".collection[data-bookmark='"+collection.bookmark_id+"']");elem.get('.max-icons-collection').style.display='none';elem.get('.icons-collection-noregister').style.display='none';if(collection.icons.length>=Collection.limit.icons){if(gr.auth.me.id){elem.get('.max-icons-collection').style.display='block';UserAlerts.danger('Ooop!',messages.limit.registered);}else{elem.get('.icons-collection-noregister').style.display='block';UserAlerts.danger('Ooop!',messages.limit.guest);}}
if(collection.icons.length>=Collection.limit.icons){elem.classList.add('limit-reached');}else{elem.classList.remove('limit-reached');}}
Widget.markSelectedColor=function(color,elem){var selector=(elem.classList.contains('icon'))?".color-selector button":".collection-options .color-selector button";var elems=elem.find(selector);if(elems){[].forEach.call(elems,function(btn){if(btn.dataset.color==color){btn.classList.add('selected');}else{btn.classList.remove('selected');}});}}
Widget.show=function(){$_("#collections").classList.add("visible");$_("#viewport").classList.add('collections-visible');localStorage.widget_active=1;}
Widget.toggle=function(){var widget=$_("#collections"),active=Number(widget.classList.toggle("visible")),method=(active)?'add':'remove';$_("#viewport").classList[method]('collections-visible');widget.classList[method]('visible');localStorage.widget_active=active;ga('send','event','Collection','Toggle',(active)?'Show':'Hide');}
Widget.createIconsCPicker=function(id,bookmark){if(id instanceof(Element)){var cpicker=id.parent(".collectionIcon").get(".icon-cpicker");var items=$(cpicker);}else{var selector=(typeof id!='undefined')?".collection[data-bookmark='"+bookmark+"'] .icon[data-id='"+id+"'] .icon-cpicker":".collection .icon .icon-cpicker";var items=$(selector);}
items.each(function(){var icon=this.parent(".icon"),color=icon.dataset.color.toUpperCase();var picker=$(this);if(!picker.data().hasOwnProperty("colpickId")){this.innerHTML='';picker.colpick({flat:true,layout:'hex',submit:0,color:color,onChange:function(a,hex,b,elem){Widget.changeIconColor(hex.toUpperCase(),elem,false,false,Widget.isLight(hex));}});}
Widget.changeIconColor(color,this,true,true,Widget.isLight(color));});}
Widget.createCollectionCPicker=function(){var color;$(".collection[data-order='0'] .col-cpicker").each(function(){color=this.parent(".collection").dataset.color.toUpperCase();var picker=$(this);if(!picker.data().hasOwnProperty("colpickId")){console.log('ELIMINANDO CPICKER');this.innerHTML='';window.firstColorChange=true;var timeout=undefined;picker.colpick({flat:true,layout:'hex',submit:0,color:color,onChange:function(a,hex,c,elem){Widget.changeCollectionColor(hex.toUpperCase(),elem);}});picker.colpickSetColor(color);delete window.firstColorChange;}});}
Widget.markSelectedIcons=function(bookmark_id){if(!bookmark_id){var active=Collection.getActive();if(!active)return;bookmark_id=active.bookmark_id;}
var icons=$_(".icon:not(.collectionIcon)");if(icons){[].slice.call(icons).forEach(function(ico){ico.classList.remove('selected');var btn=ico.get(".overlay button");btn.classList.add('flaticon-collections_add');btn.classList.remove('flaticon-collections_remove');});}
db.queryAll(bookmark_id).forEach(function(icon){Icon.toggle(icon.id);});}
Widget.addIcon=function(icon,name,author,getColor){var collection=Collection.getActive();var elem=$_(".collection[data-bookmark='"+collection.bookmark_id+"']");var premium_advise=elem.get('.collection-content .premium-advise');if(premium_advise)premium_advise.style.display='none';if(!window.launching&&db.rowCount(collection.bookmark_id)>=Collection.limit.icons){if(gr.auth.me.id){elem.get('.max-icons-collection').style.display='block';UserAlerts.danger('Ooop!',messages.limit.registered);}else{elem.get('.icons-collection-noregister').style.display='block';UserAlerts.danger('Ooop!',messages.limit.guest);}
var badge=$_('#collections-toggle .badge');badge.classList.add('animate');var badgeTimeout=setTimeout(function(){clearTimeout(badgeTimeout);badge.classList.remove('animate');},300);return;}
if(arguments.length>1){icon={id:parseInt(icon,10),name:slug(name),author:parseInt(author,10)}
if($_("section #detail .customize.active")){if(typeof localStorage.color!='undefined'){icon.color=localStorage.color.replace('#','');}else{var input=$_("section #detail #detail_picker .colpick_hex_field input");icon.color=(input)?input.value:collection.color;}}}
if($_("#detail")){saveColor(localStorage.color);}
icon.color=(icon.color)?icon.color:collection.color;if(!elem.classList.contains('expanded')&&!window.launching){elem.classList.add('expanded');}
if(!elem.get(".icon.collectionIcon[data-id='"+icon.id+"']")){$_(".collection[data-order='0'] .icons").insertAdjacentHTML('afterbegin',Handlebars.tag('collection-icon')(icon));Widget.renderSVG($_(".collection[data-order='0'] .icons .collectionIcon[data-id='"+icon.id+"'] .collectionIconImage"));}
if(gr.auth.me.premium){var warning_tit=messages.external_icon.title;var warning_txt=messages.external_icon.message;if($_('ul.icons .icon[data-id="'+icon.id+'"]')){if($('ul.icons .icon[data-id="'+icon.id+'"] .flaticon-selection').length==0){UserAlerts.warning(warning_tit,warning_txt,0);}}else{if(typeof document.getElementById('detail')!='undefined'&&document.getElementById('detail')!=null){if($_('#download-form #selection').value==0){UserAlerts.warning(warning_tit,warning_txt,0);}}}}
if(!db.queryAll(collection.bookmark_id,{query:{id:icon.id}}).length){var date=getTimestamp();new Icon(icon.id,slug(icon.name),icon.author,icon.color,collection.bookmark_id,date,date);Widget.updateToggle();Icon.toggle(icon.id);var icon_data={};Icon.properties.forEach(function(field){icon_data[field]=icon[field];});icon_data.bookmark_id=collection.bookmark_id;db.update("list",{bookmark_id:collection.bookmark_id},function(collection){collection.updated=date;return collection;});db.commit();icon_data.updated=date;icon_data.created=date;Collection.emit('put_icon',icon_data);ga('send','event','Collection','Add Icon',icon.id);}}
Widget.delIcon=function(id){var date=getTimestamp();var widgetIcon=$_(".collection[data-order='0'] .collectionIcon.selected[data-id='"+id+"']");if(widgetIcon){var col_elem=widgetIcon.parent(".collection"),bookmark_id=col_elem.dataset.bookmark,icoList=widgetIcon.parentElement;icoList.removeChild(widgetIcon);if(!icoList.children.length){icoList.innerHTML='';}
Collection.emit('del_icon',{bookmark_id:bookmark_id,id:id,updated:date});}
db.deleteRows(bookmark_id,{id:id});db.update("list",{bookmark_id:bookmark_id},function(collection){collection.updated=date;return collection;});db.commit();Icon.toggle(id);Widget.updateToggle();ga('send','event','Collection','Remove Icon',id);}
Widget.replaceSvg=function(data){var index=window.requestedSVG.indexOf(data.id);if(index>-1){window.requestedSVG.splice(index,1);}
var img;var icon=$_(".collection[data-bookmark='"+data.bookmark+"'] .icon[data-id='"+data.id+"']");if(!icon){img=$_(".collection .icon[data-id='"+data.id+"'] img");if(img){icon=$_(".collection .icon[data-id='"+data.id+"']");}else{return;}}
if(!img){img=icon.get('img');}
if(!img){return;}
if(!data.svg){icon.parentElement.removeChild(icon);var date=getTimestamp();Collection.emit('del_icon',{bookmark_id:data.bookmark,icon:data.id,updated:date});db.deleteRows(data.bookmark,{id:data.id});db.update("list",{bookmark_id:data.bookmark},function(collection){collection.updated=date;return collection;});db.commit();return;}
var svg=data.svg.getElementsByTagName('svg')[0];svg.setAttribute("width",48);svg.setAttribute("height",48);svg=typeof ie!=="undefined"?cloneToDoc(svg):svg;if(!svg||!img){return;}
img.parentElement.replaceChild(svg,img);Widget.saveState();Widget.createIconsCPicker(data.id,data.bookmark);function cloneToDoc(node,doc){if(!doc)doc=document;var clone=doc.createElementNS(node.namespaceURI,node.nodeName);for(var i=0,len=node.attributes.length;i<len;++i){var a=node.attributes[i];if(/^xmlns\b/.test(a.nodeName))continue;clone.setAttributeNS(a.namespaceURI,a.nodeName,a.nodeValue);}
for(var i=0,len=node.childNodes.length;i<len;++i){var c=node.childNodes[i];clone.insertBefore(c.nodeType==1?cloneToDoc(c,doc):doc.createTextNode(c.nodeValue),null)}
return clone;}}
Widget.renderSVG=function(elem){var icon=elem.parent(".icon"),collection=elem.parent(".collection");if(collection!==null&&icon!==null){if(collection.get('.collectionIcon[data-id="'+icon.dataset.id+'"] svg')){return;}
Widget.getSVGCode({id:icon.dataset.id,bookmark:collection.dataset.bookmark,src:elem.dataset.src});}}
Widget.getSVGCode=function(data){if(!window.requestedSVG){window.requestedSVG=[];}
if(window.requestedSVG.indexOf(data.id)===-1){window.requestedSVG.push(data.id);}else{return;}
var req=new XMLHttpRequest();if(!data.bookmark||!data.id||!data.src)return;req.onreadystatechange=function(){if(req.readyState==4&&req.status==200){Widget.replaceSvg({svg:req.responseXML,id:data.id,bookmark:data.bookmark});}}
req.open("GET",data.src,true);req.send();}
Widget.clear=function(){$_(".collection[data-order='0'] ul.icons").innerHTML='';}
Handlebars.registerHelper('maxCollectionIcons',function(){return Collection.limit.icons;});Handlebars.registerHelper('icoImg',function(){return STATIC_URL+[this.author,'svg',Math.floor(this.id/1000),this.id].join("/")+'.svg';});Handlebars.registerHelper('collectionLimitIcons',function(){var html='';this.icons.forEach(function(ico){html+='<img src="'+STATIC_URL+[ico.author,'png/32',Math.floor(ico.id/1000),ico.id].join("/")+'.png'+'" name="'+ico.name+'">';});return html;});Handlebars.registerHelper('loadImg',function(a,b){if('src'in this)return this.src;return STATIC_URL+[this.team_id,'png/128',Math.floor(this.id/1000),this.id].join("/")+'.png';});Handlebars.registerHelper('dataSearch',function(){var word=$_("#words");if(!word)return;word=word.value;return["#term=",word,"&page=",page,"&position=",this.position].join('');});Handlebars.registerHelper('shareUrl',function(){return Math.random().toString(36).slice(2);});Handlebars.registerHelper('setHeight',function(){return db.rowCount("list")>1?(db.rowCount("list")>2?'collection-height-2':'collection-height-1'):''});;(function(){var _=function(input,o){var me=this;this.input=$(input);this.input.setAttribute("autocomplete","off");this.input.setAttribute("aria-autocomplete","list");o=o||{};configure(this,{minChars:2,maxItems:10,autoFirst:false,filter:_.FILTER_CONTAINS,sort:_.SORT_BYLENGTH,item:_.ITEM,replace:_.REPLACE},o);this.index=-1;this.container=$.create("div",{className:"awesomplete",around:input});this.ul=$.create("ul",{hidden:"hidden",inside:this.container});this.status=$.create("span",{className:"visually-hidden",role:"status","aria-live":"assertive","aria-relevant":"additions",inside:this.container});$.bind(this.input,{"input":this.evaluate.bind(this),"blur":this.close.bind(this),"keydown":function(evt){var c=evt.keyCode;if(me.opened){if(c===13&&me.selected){evt.preventDefault();me.select();}
else if(c===27){me.close();}
else if(c===38||c===40){evt.preventDefault();me[c===38?"previous":"next"]();}}}});$.bind(this.input.form,{"submit":this.close.bind(this)});$.bind(this.ul,{"mousedown":function(evt){var li=evt.target;if(li!==this){while(li&&!/li/i.test(li.nodeName)){li=li.parentNode;}
if(li&&evt.button===0){me.select(li,evt.target);}}}});if(this.input.hasAttribute("list")){this.list="#"+this.input.getAttribute("list");this.input.removeAttribute("list");}
else{this.list=this.input.getAttribute("data-list")||o.list||[];}
_.all.push(this);};_.prototype={set list(list){if(Array.isArray(list)){this._list=list;}
else if(typeof list==="string"&&list.indexOf(",")>-1){this._list=list.split(/\s*,\s*/);}
else{list=$(list);if(list&&list.children){this._list=slice.apply(list.children).map(function(el){return el.textContent.trim();});}}
if(document.activeElement===this.input){this.evaluate();}},get selected(){return this.index>-1;},get opened(){return!this.ul.hasAttribute("hidden");},close:function(){this.ul.setAttribute("hidden","");this.index=-1;$.fire(this.input,"awesomplete-close");},open:function(){this.ul.removeAttribute("hidden");if(this.autoFirst&&this.index===-1){this.goto(0);}
$.fire(this.input,"awesomplete-open");},next:function(){var count=this.ul.children.length;this.goto(this.index<count-1?this.index+1:-1);},previous:function(){var count=this.ul.children.length;this.goto(this.selected?this.index-1:count-1);},goto:function(i){var lis=this.ul.children;if(this.selected){lis[this.index].setAttribute("aria-selected","false");}
this.index=i;if(i>-1&&lis.length>0){lis[i].setAttribute("aria-selected","true");this.status.textContent=lis[i].textContent;}
$.fire(this.input,"awesomplete-highlight");},select:function(selected,originalTarget){selected=selected||this.ul.children[this.index];if(selected.parentElement.classList.contains('autocomplete-icons'))
{selected=selected.parentElement.parent('li');originalTarget=selected;}
if(selected){var allowed=$.fire(this.input,"awesomplete-select",{text:selected.textContent,data:this.suggestions[$.siblingIndex(selected)],originalTarget:originalTarget||selected});if(allowed){this.replace(selected.textContent);this.close();$.fire(this.input,"awesomplete-selectcomplete");}}},evaluate:function(){var me=this;var value=this.input.value;if(value.length>=this.minChars&&this._list.length>0){this.index=-1;this.ul.innerHTML="";this.suggestions=this._list.filter(function(item){return me.filter(item,value);}).sort(this.sort).slice(0,this.maxItems);this.suggestions.forEach(function(text){me.ul.appendChild(me.item(text,value));});if(this.ul.children.length===0){this.close();}else{this.open();}}
else{this.close();}}};_.all=[];_.FILTER_CONTAINS=function(text,input){return RegExp($.regExpEscape(input.trim()),"i").test(text);};_.FILTER_STARTSWITH=function(text,input){return RegExp("^"+$.regExpEscape(input.trim()),"i").test(text);};_.SORT_BYLENGTH=function(a,b){if(a.length!==b.length){return a.length-b.length;}
return a<b?-1:1;};_.ITEM=function(text,input){var html=input===''?text:text.replace(RegExp($.regExpEscape(input.toLowerCase().trim()),"gi"),"<mark>$&</mark>");return $.create("li",{innerHTML:html,"aria-selected":"false"});};_.REPLACE=function(text){this.input.value=text.toLowerCase();};function configure(instance,properties,o){for(var i in properties){var initial=properties[i],attrValue=instance.input.getAttribute("data-"+i.toLowerCase());if(typeof initial==="number"){instance[i]=parseInt(attrValue);}
else if(initial===false){instance[i]=attrValue!==null;}
else if(initial instanceof Function){instance[i]=null;}
else{instance[i]=attrValue;}
if(!instance[i]&&instance[i]!==0){instance[i]=(i in o)?o[i]:initial;}}}
var slice=Array.prototype.slice;function $(expr,con){return typeof expr==="string"?(con||document).querySelector(expr):expr||null;}
function $$(expr,con){return slice.call((con||document).querySelectorAll(expr));}
$.create=function(tag,o){var element=document.createElement(tag);for(var i in o){var val=o[i];if(i==="inside"){$(val).appendChild(element);}
else if(i==="around"){var ref=$(val);ref.parentNode.insertBefore(element,ref);element.appendChild(ref);}
else if(i in element){element[i]=val;}
else{element.setAttribute(i,val);}}
return element;};$.bind=function(element,o){if(element){for(var event in o){var callback=o[event];event.split(/\s+/).forEach(function(event){element.addEventListener(event,callback);});}}};$.fire=function(target,type,properties){var evt=document.createEvent("HTMLEvents");evt.initEvent(type,true,true);for(var j in properties){evt[j]=properties[j];}
return target.dispatchEvent(evt);};$.regExpEscape=function(s){return s.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&");};$.siblingIndex=function(el){for(var i=0;el=el.previousElementSibling;i++);return i;};function init(){$$("input.awesomplete").forEach(function(input){new _(input);});}
if(typeof Document!=="undefined"){if(document.readyState!=="loading"){init();}
else{document.addEventListener("DOMContentLoaded",init);}}
_.$=$;_.$$=$$;if(typeof self!=="undefined"){self.Awesomplete=_;}
if(typeof module==="object"&&module.exports){module.exports=_;}
return _;}());;$(function(){$("#download-free").on("click",download_final);$('#download-premium').on('click',function(){document.getElementById('modal-download').checked=false;});$('#detail .download li a').on('click',function(){document.getElementById('modal-base64').checked=false;var format=$(this).attr('data-format');$('#format').val(format);if(format=='psd'||format=='eps'){if(new Date()<new Date(parseInt(localStorage.break_while,10))||gr.auth.me.premium){download_final();}else{document.getElementById('modal-download').checked=true;}}});$('#detail ul.size button').on('click',function(){var format=$('#format').val();var size=$(this).attr('data-size');$('#size').val(size);if(format=='png'|| format=='svg'|| format=="base64"){if(new Date()<new Date(parseInt(localStorage.break_while,10))||gr.auth.me.premium){download_final();}else{document.getElementById('modal-download').checked=true;}}});});function download_final()
{saveColor(localStorage.color);if($("#download-form #format").val()!="base64"){download_icon_post();}else{download_b64_post();}
document.getElementById('modal-download').checked=false;}
function normalizeFields(){document.getElementById('author').value=document.getElementById('author').value||'0';document.getElementById('team').value=document.getElementById('team').value||'0';document.getElementById('pack').value=document.getElementById('pack').value||'0';document.getElementById('icon_id').value=document.getElementById('icon_id').value||'0';document.getElementById('format').value=document.getElementById('format').value||'png';document.getElementById('color').value=document.getElementById('color').value||'#000000';document.getElementById('size').value=document.getElementById('size').value||'512';document.getElementById('style').value=document.getElementById('style').value||'Unknown';document.getElementById('keyword').value=document.getElementById('keyword').value||'icon';}
function trackDownload(){track_download();normalizeFields();ga('send','event','Download','Icon',document.getElementById('format').value.toUpperCase(),1,{'dimension8':document.getElementById('author').value,'dimension2':document.getElementById('team').value,'dimension10':document.getElementById('pack').value,'dimension3':document.getElementById('icon_id').value,'dimension4':document.getElementById('format').value,'dimension5':document.getElementById('color').value,'dimension6':document.getElementById('size').value,'dimension12':document.getElementById('style').value,'dimension7':document.getElementById('keyword').value,});}
function track_download(){if(LANGUAGE=="english"){var tr_search='';var item_id=document.getElementById('icon_id').value;var user_id=0;var exclusive_file=document.getElementById('selection').value;if(document.location.href.indexOf('#')!='-1'){var hash=document.location.href.split('#');if(typeof(hash[1])!=="undefined")tr_search=hash[1]+"&";}
if((typeof gr!=='undefined')&&gr.auth.logged)user_id=gr.auth.me.id;console.log('trackea la descarga');if(typeof item_id!='undefined')
{var new_image=new Image();new_image.src="https://trk.flaticon.com/download.gif?"+tr_search+"pg=detalle-english&id="+item_id+"&userid="+gr.auth.me.id+"&exclusive="+exclusive_file+"&r="+Math.random();}}}
function download_b64_post(){var serializeArray=$(this).serializeArray();var data={};$("#download-form").serializeArray().forEach(function(field){data[field.name]=field.value;});$.post('/download-icon',data,fillBase64Form);trackDownload();}
function fillBase64Form(response){var img='<img src="'+response.data+'" />';$('#b64Image').val(img);var css='<style type="text/css">';css+='div.image {';css+='max-width: 256px;';css+='max-height: 256px;';css+='background-image: url('+response.data+')';css+='}';css+='</style>';$('#b64css').val(css);document.getElementById('modal-base64').checked=true;}
function download_icon_post(){var url='/download-icon';normalizeFields();var form=document.getElementById('download-form');form.action=url;document.getElementById('modal-base64').checked=false;document.getElementById('modal-download').checked=false;form.submit();trackDownload();};var touch;$(function(){$(".give_break").change(function(){if(this.checked){var date=new Date();localStorage['break_while']=date.setDate(date.getDate()+1);}else localStorage.removeItem('break_while');});if(/Android [4-6]\.[0-9]/.test(navigator.appVersion)){window.addEventListener("resize",function(){if(document.activeElement.tagName=="INPUT"){window.setTimeout(function(){document.activeElement.scrollIntoViewIfNeeded();},0);}})}
$(document).on("click",".icon .overlay a",function(e){if(typeof(gr.sponsor.popup)!="undefined"&&!gr.auth.me.premium)gr.sponsor.popup.launch();window.location.href=this.href;});$(document).on('click','.modal-trigger',function(e){document.getElementById(this.dataset.modal).checked=true;e.preventDefault();});$(document).on('click','.modal-close',function(e){$(this).parents('div.modal')[0].get('.modal-state').checked=false;e.preventDefault();});$(document).on('click','.alert .close-alert',function(e){$(this).parent().removeClass('zoomIn').addClass('zoomOut').slideUp(300);e.preventDefault();});$('.track_download_pack').on('click',function(){if(typeof gr.auth.logged!='undefined'){$.post("/download/track-download-pack",{id_user:gr.auth.me.id,id_pack:$(this).attr('data-pack')});}});var video=$('#video');var videoBtn=$('#fullscreenvid');if(video.length){videoBtn.on('click',function(){var vid=video[0];if(vid.requestFullscreen)
vid.requestFullscreen();else if(vid.mozRequestFullScreen)
vid.mozRequestFullScreen();else if(vid.webkitRequestFullscreen)
vid.webkitRequestFullscreen();else if(vid.msRequestFullscreen)
vid.msRequestFullscreen();});}
$(window).scroll(function(){var scrollBtn=document.getElementById('toTop');if(window.scrollY>=50)scrollBtn.classList.add('show');else scrollBtn.classList.remove('show');});$("#toTop").on('click',function(e){$('html, body').animate({scrollTop:0},250);e.preventDefault();})
touch=(('ontouchstart'in window)||(navigator.MaxTouchPoints>0)||(navigator.msMaxTouchPoints>0));if(touch){$(window).on('touchstart mousemove',onMouseMove);}else{document.body.classList.add('notouch');}
var fullscreen=function(){var element=$('.fullscreen'),windowW=window.innerWidth,windowH=window.innerHeight;if(element.length===0)return;if(windowW<=768)return;function onResize(e){var condition=e.type==='resize'?windowW!==window.innerWidth&&windowH!==window.innerHeight:true,minWidth=element.data('fullscreen'),minWidth=minWidth?minWidth:8640,minHeight=element.find('> *').outerHeight(true);if(window.innerWidth<=minWidth&&window.innerHeight>minHeight){if(condition||!_touch)element.css('height',window.innerHeight-56);}else{element.removeAttr('style');}
windowW=window.innerWidth,windowH=window.innerHeight;};$(document).on('ready load',onResize);$(window).on('resize',onResize);};fullscreen();$("#msform").submit(function(e){e.preventDefault();if(!validate_join_the_team("1")||!validate_join_the_team("2"))return;var data={};$(this).serializeArray().forEach(function(field){data[field.name]=field.value;});$.post('/ajax/join-the-team',data,function(){$_("#msform fieldset")[2].style.display='none';$_("#msform .resul").style.display='block';setTimeout(function(){$_("#modal-form").checked=false;$_("#msform fieldset")[0].style.display='block';$_("#msform .resul").style.display='none';},3000);});});var time_valuation=parseInt(localStorage.time_valuation);if(!time_valuation||isNaN(time_valuation))time_valuation=0;var form_valuation=$_("#form_valuation");if(form_valuation){if(parseInt(localStorage.time_valuation,10)%70==0){form_valuation.style.left="";$_("#form_valuation #button_panel").innerHTML="-";}else{form_valuation.style.left="-200px";$_("#form_valuation #button_panel").innerHTML="+";}}
localStorage.time_valuation=++time_valuation;$("#open_panel").click(function(){var parent=this.parent('#form_valuation');var left=parseInt(parent.style.left);if(isNaN(left)){parent.style.left="-200px";this.get('#button_panel').innerHTML="+";}else{parent.style.left="";this.get('#button_panel').innerHTML="-";}});$("#form_valuation").submit(function(e){e.preventDefault();var id=$_("#id_last_valuation");var comment=$_("#valuation_text");if(comment.value.trim().length){gr.request.post('valuations/send_user_comment',{id:id.value,comment:comment.value});}
$_("#valuation_comment_panel").style.display="none";$_("#valuation_congrat").style.display="block";setTimeout(function(){close_valuation();},3000);});$("#no_thanks").click(close_valuation);function close_valuation(){$_("#valuation_text").value='';$_("#id_last_valuation").value='';$_("#valuation_comment_panel").style.display="none";$_("#form_valuation").style.left="-200px";$_('#form_valuation #button_panel').innerHTML="+";$_("#valuation_congrat").style.display="none";$_("#valuation_panel").style.display="block";}
$(".valuation_response").click(function(e){var N=navigator.appName,UA=navigator.userAgent,temp,browser=[],browserVersion=UA.match(/(opera|chrome|safari|firefox|msie|maxthon|lunascape)\/?\s*(\.?\d+(\.\d+)*)/i);if(browserVersion&&(temp=UA.match(/version\/([\.\d]+)/i))!==null)browserVersion[2]=temp[1];browser["name"]=browserVersion[1];browser["version"]=browserVersion[2];gr.request.post('valuations/send_valuation',{value:this.dataset.value,question:$_("#valuation_question_id").value,browser:browser['name'],browser_version:browser['version'],language:LANGUAGE_SHORT,});});$("button").click(function(){this.blur();});$(document).on("keyup focus","#msform #dribbble",function(){var value=this.value.trim();if(value.indexOf('https://dribbble.com/')!=0){this.value='https://dribbble.com/';}});$(document).on("keyup focus","#msform #behance",function(){var value=this.value.trim();if(value.indexOf('https://behance.net/')!=0){this.value='https://behance.net/';}});$(document).on("keyup focus","#msform #other-portfolio, #msform #personal-portfolio",function(){var value=this.value.trim();if(value.indexOf('https')!=0&&value.indexOf('http')!=0){this.value='http://';}});var current_fs,next_fs,previous_fs;var left,opacity,scale;var animating;$(".modal-form .next").click(function(){if(!validate_join_the_team(this.dataset.fieldset))return;if(animating)return false;animating=true;current_fs=$(this).parent();next_fs=$(this).parent().next();$(".modal-form #progressbar li").eq($("fieldset").index(next_fs)).addClass("active");next_fs.show();next_fs_height=$(this).parent().next().height();$('.modal-form #msform').animate({'height':next_fs_height+80});current_fs.animate({opacity:0},{step:function(now,mx){scale=1-(1-now)*0.2;left=(now*50)+"%";opacity=1-now;current_fs.css({'transform':'scale('+scale+')'});next_fs.css({'left':left,'opacity':opacity});},duration:400,complete:function(){current_fs.hide();animating=false;}});});$(".modal-form .previous").click(function(){if(!validate_join_the_team(this.dataset.fieldset))return;if(animating)return false;animating=true;current_fs=$(this).parent();previous_fs=$(this).parent().prev();$(".modal-form #progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");previous_fs.show();previous_fs_height=$(this).parent().prev().height();$('.modal-form #msform').animate({'height':previous_fs_height+80});current_fs.animate({opacity:0},{step:function(now,mx){scale=0.8+(1-now)*0.2;left=((1-now)*50)+"%";opacity=1-now;current_fs.css({'left':left});previous_fs.css({'transform':'scale('+scale+')','opacity':opacity});},duration:400,complete:function(){current_fs.hide();animating=false;}});});if($("#designs-number").length){var designTotal=1402155;var designTotalDate=148720600;var designG2293rowthPek=700;var usrWeeerTotal=422972;var userTotalDate=1426033809133;var userGrowthPerWeek=4850;var downloadsTotal=617705841;var downloadsTotalDate=1446017641500;var downloadsGrowthPerWeek=3000000;var designGrowthPerWeek=1000;var userTotal=422972;(function drawDesignCount(){var newDesignTotal=designTotal;var designGrowthPerMilli=designGrowthPerWeek/7/24/60/60/1000;newDesignTotal+=Math.floor((Date.now()-designTotalDate)*designGrowthPerMilli);var newDesignTotalString=newDesignTotal.toString().replace(/\B(?=(\d{3})+(?!\d))/g,',');$_('#designsCreated .number').innerText=newDesignTotalString;setTimeout(drawDesignCount,Math.random()*12500);})();(function drawUserCount(){var newUserTotal=userTotal;var userGrowthPerMilli=userGrowthPerWeek/7/24/60/60/1000;newUserTotal+=Math.floor((Date.now()-userTotalDate)*userGrowthPerMilli);var newUserTotalString=newUserTotal.toString().replace(/\B(?=(\d{3})+(?!\d))/g,',');$_('#usersCreated .number').innerText=newUserTotalString;setTimeout(drawUserCount,Math.random()*6500);})();(function drawDownloadsCount(){var newDownloadsTotal=downloadsTotal;var downloadsGrowthPerMilli=downloadsGrowthPerWeek/7/24/60/60/1000;newDownloadsTotal+=Math.floor((Date.now()-downloadsTotalDate)*downloadsGrowthPerMilli);var newDownloadsTotalString=newDownloadsTotal.toString().replace(/\B(?=(\d{3})+(?!\d))/g,',');$_('#downloadsCreated .number').innerText=newDownloadsTotalString;setTimeout(drawDownloadsCount,Math.random()*1500);})();}
$("#designs-number").on("keyup change",function(){var minEarnings=(this.value*1).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");var maxEarnings=(this.value*7).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");document.getElementById('earnings').innerHTML='$'+minEarnings+' ~ $'+maxEarnings;});if(!Cookie.get('cookie_policy')){$_("#cookies-alert").style.display='block';setTimeout(function(){insertCookiePolicy();},5000);}
$('#cookies-alert .close-cookies').on('click',function(){insertCookiePolicy();});var macApp=$('#mac-app'),macAppInterval=false;if(macApp.length){macApp.waypoints({view:50,viewOut:true,oneTime:false,inView:function(){if(!macAppInterval)macApp[0].classList.add('animate');if(!macAppInterval)macAppInterval=setInterval(function(){macApp[0].classList.remove('animate');setTimeout(function(){macApp[0].classList.add('animate');},300);},22700);},outView:function(){macApp[0].classList.remove('animate');clearInterval(macAppInterval);macAppInterval=false;}});}
setTimeout(function(){var login_link=document.getElementById("gr_not-connected");if(login_link){login_link.classList.remove('dropdown-active');}},5000);$(document).on("change","#modal-1",function(){document.body.classList[this.checked?'add':'remove']('modal-open');});$(".modal-fade-screen").on("click",function(){[].forEach.call(document.find('.modal-state'),function(checkbox){closeModal(checkbox);});});$(".modal-inner").on("click",function(e){e.stopPropagation();});$(document).on("click",'.selectInput',function(){this.select();});$(document).on("keyup",function(e){e.preventDefault();if(e.which==27){[].forEach.call(document.find(".popover-content"),function(e){e.classList.remove('show-menu')});}});$(document).on("click touchstart",".popover-button",function(e){var menu=this.parentElement.get(".popover-content");function removeAll(){[].forEach.call($_(".popover-content"),function(popover){if(popover==menu)return true;popover.classList.remove('show-menu');});[].forEach.call($_(".popover-button"),function(btn){btn.classList.remove('active');});}
if(!this.classList.contains("active")){removeAll();menu.classList.add("show-menu");this.classList.add('active');}else{menu.classList.remove("show-menu");this.classList.remove('active');}
e.stopPropagation();e.preventDefault();});$(document).mouseup(function(e){var c=e.target;if(c.classList.length===0||c.classList.contains('active')||c.parentNode.classList.contains('active'))return;if(c.classList.contains('popover-container')||[].some.call(c.parents(),function(p){return p.classList.contains('popover-container')}))return;[].forEach.call(document.find(".popover-content"),function(e){e.classList.remove('show-menu');});[].forEach.call($_(".popover-button"),function(btn){btn.classList.remove('active');});});$(document).on("mouseout",'.btn',function(){this.blur();});$('.reset-input').unbind();$(document).on("click",'.reset-input',function(){if($(this).siblings('input').val()!=='')
$(this).siblings('input').val('').focus();else if(($(this).siblings('input').attr('id')!='username')&&($(this).siblings('input').attr('id')!='email'))
$(this).siblings('input').attr('placeholder','');$(this).siblings('input').removeClass('error').parent().next('span.error').remove();return false;});$(document).on("click",'.reset-textarea',function(){if($(this).siblings('textarea').val()!=='')
$(this).siblings('textarea').val('').focus();$(this).siblings('textarea').removeClass('error').parent().next('span.error').remove();return false;});$('.input-group input, .textarea-group textarea').unbind();$('.input-group input, .textarea-group textarea').on('blur',function(){if(!$(this).val()){$(this).removeClass('hascontent');if($(this).attr('placeholder'))this.addClass('hascontent');}else
$(this).addClass('hascontent');});$('.input-group input, .textarea-group textarea').on('keyup',function(){$(this).removeClass('error').parent().next('span.error').remove();if(($(this).attr('id')=='password')||($(this).attr('id')=='repeat_password')){$('#password').removeClass('error').parent().next('span.error').remove();$('#repeat_password').removeClass('error').parent().next('span.error').remove();}});$('.input-group input, .textarea-group textarea').each(function(){if(!$(this).val()){$(this).removeClass('hascontent');if($(this).attr('placeholder'))this.addClass('hascontent');}else
$(this).addClass('hascontent');});if($_(".tabs")){tabs();}
$('.flaticon-magnifier').on('click',function(e){if(typeof gr.sponsor.popup.launch=="function"){gr.sponsor.popup.launch();}});$('.search-holder form').on('submit',function(e){e.preventDefault();var value=$(this).find('input').val().trim();$(this).find('input').val(value);if(value.length<2){UserAlerts.warning(messages.search.search,messages.search.minimal_characters,0);return false;}
track_search(value);});$('.reset-textarea').on('click',function(){if($(this).siblings('textarea').val()!=='')
$(this).siblings('textarea').val('').focus();$(this).siblings('textarea').removeClass('error').parent().next('span.error').remove();return false;});$(window).on("scroll",function(){var filter=$('.list-options');if(filter.length===0)return;var scrollTop=$(window).scrollTop(),header=$('#header').outerHeight(true);if(scrollTop<filter.outerHeight(true)+header&&filter.hasClass("fixed")){filter.removeClass('fixed');}else if(scrollTop>=filter.offset().top-header){filter.addClass('fixed');}});});function track_search(value){if(!value.length)return;var trk_image=new Image();trk_image.src="https://trk.flaticon.com/search.gif?search-"+language+"&term="+value+"&k="+Date.now();trk_image.onload=function(){exec_search(value);};trk_image.onerror=function(){exec_search(value);};}
function exec_search(value){if(!value.length)return;if(typeof gr.sponsor.popup.launch=="function"){gr.sponsor.popup.launch();}
$.post('/stats/search/'+value);window.location.href=document.querySelector('.search-holder form').action+"?word="+value;}
function valuation_request_comment(data){$_("#id_last_valuation").value=data.id;$_("#valuation_panel").style.display='none';$_("#valuation_comment_panel").style.display='block';}
var tabs=function(){var $tab=$('.tabs');function onClick(e){$this=$($(this).attr('href'));$this.parents('.tabs').find('.tabs-panel').removeClass('active');$this.addClass('active');e.preventDefault();};function onEvent(){for(i=0;i<$tab.length;i++){if($tab.eq(i).find('.tabs-nav').length===0)return;var btnH=$tab.eq(i).find('a:first').outerHeight(true);var tabH=$tab.eq(i).find('.tabs-nav').height();if(tabH>btnH){$tab.eq(i).addClass('tabs-accordion').find('.tabs-nav')
if($('.tabs-nav-wrapper').length===0)$tab.eq(i).find('.tabs-nav').wrap('<div class="tabs-nav-wrapper"></div>');}else $tab.eq(i).removeClass('tabs-accordion');}};$tab.find('.tabs-nav a, .tabs-panel a.tab-heading').click(onClick);$(window).bind('ready load resize',onEvent);};function insertCookiePolicy(){var date=new Date();date.setFullYear(date.getFullYear()+1);document.cookie="cookie_policy=true; expires="+date+"; path=/";$("#cookies-alert").slideUp();}
function validate_join_the_team(step){var errors=0;if(step=="1"){var name_input=$_("#msform #fullname");if(!name_input.value.trim().length){name_input.classList.add("error");errors++;}else{name_input.classList.remove("error");}
var email_input=$_("#msform #email");if(!validateEmail(email_input.value)){email_input.classList.add("error");errors++;}else{email_input.classList.remove("error");}
var contact_method_input=$_("#msform #contact-method");var selected=contact_method_input[contact_method_input.selectedIndex].value;if(!selected.length){contact_method_input.classList.add("error");errors++;}else{contact_method_input.classList.remove("error");}
var contact_user_input=$_("#msform #contact-user");if(!contact_user_input.value.trim().length&&selected!='email'){contact_user_input.classList.add("error");errors++;}else{contact_user_input.classList.remove("error");}}else{var domains={'dribbble':'https://dribbble.com/','behance':'https://behance.net/','personal-portfolio':[],'other-portfolio':[]};var filled=4;for(var i in domains){var domain_input=$_("#msform #"+i);var value=domain_input.value.trim();if(!domain_input.classList.contains('hascontent')){domain_input.classList.remove('error');filled--;continue;}
if(Array.isArray(domains[i])){if(value.indexOf('http://')!=0&&value.indexOf('https://')!=0||(!validateUrl(value)&&value!='http://')){errors++;domain_input.classList.add("error");}else{domain_input.classList.remove("error");if(value=='http://'||value=='https://')filled--;}}else{if(value.indexOf(domains[i])!=0||!validateUrl(value)){domain_input.classList.add("error");errors++;}else{domain_input.classList.remove("error");if(!value.split(domains[i])[1].length)filled--;}}}
if(!filled){for(var i in domains){$_("#msform #"+i).classList.add("error");}
errors++;}}
return(!errors)?true:false;}
function validateUrl(url){var myRegExp=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/i;return myRegExp.test(url);}
function validateEmail(email){var re=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(email);}
function onMouseMove(e){if(e.type=='touchstart'&&this.touchstart&&!document.body.classList.contains('notouch'))return;if(e.type=='touchstart')this.touchstart=true;if(e.type=='mousemove'&&!this.touchstart&&document.body.classList.contains('notouch'))return;if(this.touchstart){document.body.classList.remove('notouch');}else{document.body.classList.add('notouch');}
var method=this.touchstart?'on':'off';$(document.body)[method]('click','.icon',iconHover);if(e.type=='mousemove')this.touchstart=false;}
function iconHover(e){[].forEach.call(document.querySelectorAll('ul.icons li.icon'),function(icon){icon.classList.remove('hover');});this.classList.add('hover');e.preventDefault();};if(!Element.prototype.hasOwnProperty("parent")){Element.prototype.parent=function(s){var list=this.parents(s);if(typeof s=="undefined")list.reverse();return(list&&list.length)?list[0]:null;};}
$(function(){window.awesompletes=[];[].forEach.call(document.querySelectorAll(".autocomplete"),function(e){var awesomplete=new Awesomplete(e,{minChars:1,item:function(text,input){var tag={icons:0,items:[],tag_id:0,tag:''};for(var i in window.autocompleteTags){if(window.autocompleteTags[i].tag==text){tag=window.autocompleteTags[i];break;}}
var html='<div class="text-container">\
    <div class="text">$$<span class="total-items"> ('+tag.icons+')</span></div></div>\
    <ul class="autocomplete-icons">';tag.items.forEach(function(icon){html+='<li><img src="'+STATIC_URL+[icon.team_id,'png/24',Math.floor(icon.id/1000),icon.id].join("/")+'.png"></li>';});html+="</ul>";html=html.replace("$$",text.toLowerCase().replace(new RegExp((input.toLowerCase()),"g"),"<mark>"+input+"</mark>"));return Awesomplete.$.create("li",{innerHTML:html,"aria-selected":"false"});},sort:function(){}});window.awesompletes.push(awesomplete);$(e).on("awesomplete-selectcomplete",function(ev){e.value=e.value.trim().split("(")[0].trim();if(typeof track_search!='undefined')track_search(e.value);e.parent("form").submit();}).on('blur',function(e){e.value='';});});$('.autocomplete').keyup(function(e){if([27,13,37,38,39,40].indexOf(e.keyCode)==-1){var text=this.value.trim();if(text){$.ajax({url:APP_URL+'ajax/autocomplete/'+text,type:'GET',success:function(response){var json=JSON.parse(response);parser_autocomplete(json);}});}}});function parser_autocomplete(data){window.autocomplete=[];window.autocompleteTags=data;for(var tag in data){window.autocomplete.push(data[tag].tag);}
window.awesompletes.forEach(function(element){element.list=window.autocomplete;});}});;function load_data_share()
{var elem_share_url=document.querySelector("meta[property='og:url']");var elem_share_img=document.querySelector("meta[property='og:image']");var elem_share_tit=document.querySelector("meta[name='twitter:title']");var elem_share_des=document.querySelector("meta[property='og:description']");var url=(elem_share_url)?elem_share_url.content:document.location.href;var image=(elem_share_img)?elem_share_img.content:'';var title=(elem_share_tit)?elem_share_tit.content:document.title;var desc=(elem_share_des)?elem_share_des.content:document.title;return{url:url,image:image,title:title,desc:desc};}
function fbpopup(popwhat){var data=load_data_share();var openUrl='http://www.facebook.com/sharer.php?u='+data.url;window.open(openUrl,"fbshare","height=380,width=660,resizable=0,toolbar=0,menubar=0,status=0,location=0,scrollbars=0");ga('send','event','Social','Facebook','Share');}
function pinpopup(popwhat){var data=load_data_share();var openUrl='http://pinterest.com/pin/create/button/?url='+data.url+'&amp;media='+data.image;window.open(openUrl,"pinshare","height=270,width=630,resizable=0,toolbar=0,menubar=0,status=0,location=0,scrollbars=0");ga('send','event','Social','Pinterest','Share');}
function glpopup(popwhat){var data=load_data_share();var openUrl='https://plus.google.com/share?url='+data.url;window.open(openUrl,"glshare","height=270,width=630,resizable=0,toolbar=0,menubar=0,status=0,location=0,scrollbars=0");ga('send','event','Social','Google+','Share');}
function tweet(e){e.preventDefault();var data=load_data_share();var openUrl='http://twitter.com/share?url='+data.url+'&text='+data.title+'&';window.open(openUrl,'Flaticon Twitter Share','height=450,width=550,top='+($(window).height()/2-225)+',left='+$(window).width()/2+',toolbar=0,location=0,menubar=0,directories=0,scrollbars=0');ga('send','event','Social','Twitter','Share');};function Tour(){var speed=250;var toggle=$('#collections-toggle');var modal=$('#tour');var close=modal.find('.close-tour');var marker=modal.find('.tour-marker');var overlay=$('.tour-overlay');var steps=$('.steps');steps.lgt=steps.find('.step').length;var position=steps.find('.active').index()+1;var demo=$('.collections .collection:first');var nav=$('#tour .tour-nav');nav.button=nav.find('.prev, .next');var tour_box=$('#tour .tour-box');tour_box.on('click',function(e){e.stopPropagation()});var opened=false;var open=false;var stepsFunctions={3:Collection.rename,4:function(){Collection.rename();Collection.editName();},5:Collection.rename,6:function(){Collection.closeEditMode();var collection=$_('.collection[data-bookmark="tour_demo_collection"]');if(!collection)return;collection.get('.collection_color_button').click();nav.button.attr('disabled',true);stepsFunctions.extras.ColorPaletteDemo();},7:Collection.openEditMode,8:function(){nav.button.attr('disabled',true);if(db.tableExists('tour_demo_collection')){setTimeout(function(){Collection.del('tour_demo_collection');nav.button.attr('disabled',false);},2000);}},extras:{ColorPaletteDemo:function(){$_(".collection[data-bookmark=tour_demo_collection] #color-lock").checked=true;var colors=$_(".collection[data-bookmark=tour_demo_collection] .collection-options .color-selector li button");var index=[];while(index.length<3){index.push(Math.floor(Math.random()*7));index=index.filter(function(elem,pos){return index.indexOf(elem)==pos;});}
index.forEach(function(i,idx){setTimeout(function(){colors[i].click();},1000*(idx+1));});setTimeout(function(){nav.button.attr('disabled',false);},4000);}}};var demo_collection_data={bookmark_id:'tour_demo_collection',id:0,active:1,order:0,name:'Demo Collection',icons:[{"id":60473,"name":"configuration","author":1,"color":"FF3366","created":1449053963,"updated":1449054126},{"id":51587,"name":"closed","author":1,"color":"000000","created":1449053964,"updated":1449053964},{"id":49116,"name":"search","author":1,"color":"FFFFFF","created":1449053966,"updated":1449054117},{"id":64005,"name":"bookmark","author":1,"color":"E74C3C","created":1449053969,"updated":1449054113},{"id":66585,"name":"organization","author":1,"color":"F1C40F","created":1449053972,"updated":1449054111},{"id":62055,"name":"download","author":1,"color":"9B59B6","created":1449053973,"updated":1449054108},{"id":45865,"name":"book","author":1,"color":"3498DB","created":1449053976,"updated":1449054106},{"id":64410,"name":"check","author":1,"color":"2ECC71","created":1449053978,"updated":1449054103}]};var self=this;this.show=function(e,force){if(!force&&(opened||localStorage.tour_viewed))return;localStorage.tour_viewed=true;if(force){_forward();}
$(document).keyup(function(e){if(e.keyCode==27&&open)self.close(e);});opened=true;open=true;new Collection(demo_collection_data);if(!toggle.hasClass('active')){setTimeout(function(){Widget.show();overlay.addClass('show');modal.fadeIn(speed);setHeight();},speed);};if(e)e.preventDefault();}
this.close=function(e){if(db.tableExists("tour_demo_collection")){Collection.del('tour_demo_collection');}
overlay.removeClass('show');modal.fadeOut(speed);open=false;e.preventDefault();}
this.nav=function(e){if(!this.disabled){removePos();position+=(this.classList.contains('next')?1:-1);step();};e.preventDefault();};function _forward(){position=1;[].forEach.call(steps[0].children,function(li,index){li.classList[(!index)?'add':'remove']('active');});nav.find('.prev').attr('disabled',true);nav.find('.next').attr('disabled',false);}
function step(){var disablePrev=position===1,disableNext=position>=steps.lgt,positionIndex=position-1;nav.find('.prev').attr('disabled',disablePrev);nav.find('.next').attr('disabled',disableNext);marker.addClass('pos'+position);steps.find('.step').removeClass('active').eq(positionIndex).addClass('active');setHeight();if(window.innerWidth>=768&&typeof stepsFunctions[position]==='function')stepsFunctions[position]();};function removePos(){marker.removeClass(function(index,css){return(css.match(/(^|\s)pos\S+/g)||[]).join(' ');});};function setHeight(){steps.height(steps.find('.active').outerHeight(true));};};$(function(){tour=new Tour();$('#collections-toggle').on('click',tour.show);$('#tour, #tour .close-tour').on('click',tour.close);;$('#tour .tour-box .tour-nav .prev, #tour .tour-box .tour-nav .next').on('click',tour.nav);});;var adsPosition=function(){var wrapper=$('.search-result ul.icons');var element=wrapper.find('li.ads');var icons=wrapper.find('li.icon');var elementH=element.outerHeight(true);var resizeTimer;var onChange=function(){clearTimeout(resizeTimer);resizeTimer=setTimeout(function(){var elementLength=element.length;var iconsW=icons.outerWidth(true);var iconsH=icons.outerHeight(true);var iconsM=parseInt(icons.css("margin-bottom"));var iconMax=Math.floor(wrapper.outerWidth(true)/iconsW);icons.removeAttr('style');element.removeClass('show');for(i=0;i<elementLength;i++){var current=element.eq(i);var adsCount=current.prevAll('li.ads').length;var iconCount=current.prevAll('li.icon').length;var iconRows=Math.ceil(iconCount/iconMax);var iconIdeal=(iconRows*iconMax);var icon=icons.eq(iconIdeal);var adsPosition=(iconRows*iconsH)+iconsH+iconsM;adsPosition=adsCount>0?(elementH*adsCount)+adsPosition:adsPosition;icon.css({marginBottom:elementH+iconsM});current.css({top:adsPosition}).addClass('show');};},100);};$(window).on('ready resize',onChange);};;var ls=localStorage;var favColors=['#91DC5A','#006DF0','#933EC5','#FFDA44','#D80027','#FFFFFF','#000000'];var maxCustomColor=5;$(document).ready(function(){initCustomColors();$('#detail_picker').colpick({layout:'hex',submit:0,flat:true,onChange:function(hsb,hex,rgb,el,bySetColor){$(el).css('border-color','#'+hex);if(!bySetColor)$(el).val(hex);ls.color='#'+hex;changeSVGcolor();}});$(document).on("click",'#detail .color-selector li button',function(){var color=$(this).data('color');$(this).parents('ul').find('li button').removeClass('selected');$(this).addClass('selected');$('#detail_picker').colpickSetColor(color);ls.color=color;changeSVGcolor();});$('#detail ul.size button').on('click',function(){var size=$(this).attr('data-size');$('#download-form #size').val(size);if($('#colored').length>0&&$('#colored').is(':checked'))
{$('#download-form #svg_content').val($('svg#img-main-icon').html());}});$('.detail-footer .download li a').on('click',function(e){var all=$('.detail-footer .download li a'),curr=$(this),currAct=curr.hasClass('active'),format=curr.data('format'),formats=['png','svg','base64'],editable=$.inArray(format,formats)>=0,svgVersion=$('#detail .svg-version'),customize=$('#detail .customize'),customizeAct=customize.hasClass('active'),customizeTimer=customizeAct?300:0;all.removeClass('active');svgVersion.removeClass('active');customize.removeClass('active');if(editable){if(!currAct){curr.addClass('active');svgVersion.addClass('active');setTimeout(function(){customize.addClass('active');},customizeTimer);}
if(!customizeAct)svgInline();}
$('#id').val(icon_id);$('#format').val(format);return false;});$('body').on('click','.detail-content svg path, .detail-content svg rect, .detail-content svg polygon, .detail-content svg line, .detail-content svg circle, .detail-content svg polyline',function(){if(typeof ls.color!=='undefined')
{$(this).attr('fill',ls.color);}})});function generateSvgInline()
{svgInline();changeSVGcolor();}
function svgInline()
{var svgVersion=$('#detail .svg-version div'),imgVersion=$('#detail .img-version img'),svgArray=[];for(var i=0;i<imgVersion.length;i++){svgArray.push($.get(imgVersion[i].getAttribute('src')));}
$.when(svgArray).done(function(){svgArray.forEach(function(response,index){response.success(function(data){var svg=$(data).find('svg'),svg=svg.removeAttr('xmlns:a');svgVersion.eq(index).html(svg);changeSVGcolor();});});});};function getSVG(item,url){$.get(url,function(data){var svg=$(data).find('svg'),svg=svg.removeAttr('xmlns:a');item.html(svg[0]);changeSVGcolor();});}
function changeSVGcolor()
{var color=ls.color;if(!color)return;$('#download-form #color').val(color);$('#detail .svg-version svg, #detail .svg-version svg *').css('fill',color);var section=$('#detail .svg-version');var colorNum=color.substring(1);if(isLightColor(colorNum))
section.addClass('light-icons');else
section.removeClass('light-icons');};function addFavColors()
{var gridCustomFav=$("ul.color-selector");var colors=new Array();var n=0;if(typeof ls.favColors!=='undefined'&&ls.favColors!='')
{colors=JSON.parse(ls.favColors);n=colors.length;if(n>0)
{var keys=Object.keys(colors);for(id in keys)
{var colorCustomFavDiv=document.createElement("div");colorCustomFavDiv.className="colorBox";colorCustomFavDiv.style.backgroundColor=colors[id];colorCustomFavDiv.id=colors[id].substr(1,colors[id].length);gridCustomFav.append(colorCustomFavDiv);}}}}
function saveColor(color)
{if(typeof color=='undefined'){return;}
var colors=new Array();var n=0;if(color.charAt(0)!="#")color="#"+color;if($('#detail .color-selector button[data-color="'+color+'"]').length)return;if(typeof ls.customColors!=='undefined'&&ls.customColors!='')
{colors=JSON.parse(ls.customColors);n=colors.length;}
if(colors.indexOf(color)==-1){if(n>=maxCustomColor)
{var key=Object.keys(colors);var index=key[0];var c=colors[index];colors.splice(index,1);$('#detail ul.color-selector .custom-color[data-color="'+c+'"]').parent().remove();}
colors.push(color);paintCustomColor(color);ls.customColors=JSON.stringify(colors);}}
function initCustomColors()
{if(typeof ls.customColors!=='undefined'&&ls.customColors!='')
{colors=JSON.parse(ls.customColors);n=colors.length;for(i=0;i<n;i++)
{paintCustomColor(colors[i]);}}}
function paintCustomColor(color)
{var gridCustomFav=$("#detail ul.color-selector");var colorFavLi=document.createElement("li");var btn=document.createElement('button');btn.dataset.color=color;btn.className="custom-color";btn.style.backgroundColor=color;btn.addEventListener('click',changeSVGcolor);colorFavLi.appendChild(btn);gridCustomFav.append(colorFavLi);}
function isLightColor(color)
{var r=parseInt(color.substr(0,2),16);var g=parseInt(color.substr(2,2),16);var b=parseInt(color.substr(4,2),16);return((r*299)+(g*587)+(b*114))>=225000;};var pack_items;$(document).ready(function(){$('#report-form').submit(function(e){e.preventDefault();var data={};data.item=(pack_items&&current)?parseInt(pack_items[current].id,10):icon_id;$_("#report-form .radio-holder").classList.remove('error');var serializeArray=$(this).serializeArray();if(serializeArray.length==1){$_("#report-form .radio-holder").classList.add('error');UserAlerts.warning('Oops!',messages.report.message);return;}
$(this).serializeArray().forEach(function(field){data[field.name]=field.value;});data.navigator="User-agent: "+navigator.userAgent+"\n";data.navigator+="Platform: "+navigator.platform+"\n";data.navigator+="Browser Language: "+navigator.language+"\n";data.navigator+="Cookies Enabled: "+navigator.cookieEnabled+"\n";data.navigator+="Browser Online: "+navigator.onLine+"\n";data.url=window.location.href;data.language=LANGUAGE_SHORT;data.content=$_("#download-form #icon_id").value;data.format=$_("#download-form #format").value;plugins=[];if(typeof navigator.plugins!="undefined"){[].forEach.call(navigator.plugins,function(e){plugins.push(e.name)});}
plugins=JSON.stringify(plugins);if(typeof document.querySelector=='function'){var script=document.querySelector("script[src*='?key=']").src.split("key=")[1];}
data.script=script;data.plugins=plugins;gr.request.post('valuations/user_report',data);ga('send','event','Detail View','Report this icon',$('#report-form :input:checked')[0].value);});if(total_pack>0){next=(current<total_pack)?current+1:0;prev=(current>0)?current-1:total_pack-1;var loadPack=true;if(detectBrowser()=='IE'){if(!detectIE10()){$('a.next').attr('href',$('.next-icon-1').attr('data-slug'));$('a.prev').attr('href',$('.prev-icon-1').attr('data-slug'));loadPack=false;}}
if(loadPack)set_list_pack(pack,icon_id);}else{$('.next').html('');$('.prev').html('');$('.prev-icon').hide();$('.next-icon').hide();}
$(document).keydown(function(e){if(pack_items&&current){icon_id=parseInt(pack_items[current].id,10);icon_name=pack_items[current].keyword;icon_team=parseInt(pack_items[current].team_id,10);}
if(!db instanceof(Object)){return;}
var collection=Collection.getActive();if(!collection)return;var stored=db.queryAll(collection.bookmark_id,{query:{id:icon_id}}).length;if((e.keyCode==107)||(e.keyCode==187)||(e.keyCode==171)){if(stored)return;Widget.addIcon(icon_id,icon_name,icon_team,true);}
if((e.keyCode==109)||(e.keyCode==189)||(e.keyCode==173)){if(!stored)return;Widget.delIcon(icon_id,icon_name,icon_team);}});toggleDetailButton();});var iconsSlider=function(speed){var slider=this,active=false,svgActive=false,prev1,prev2,next1,next2,currentArr,packTotal=pack_items.length-1,prevIcon2=$('.prev-icon-2'),prevIcon1=$('.prev-icon-1'),mainIcon=$('.main-icon'),nextIcon1=$('.next-icon-1'),nextIcon2=$('.next-icon-2'),headerTitle=$('.detail-header h1');updateItems();function updateItems(){prev1=(current-1)<0?packTotal:current-1,prev2=(prev1-1)<0?packTotal:prev1-1,next1=(current+1)>packTotal?0:current+1,next2=(next1+1)>packTotal?0:next1+1;currentArr=[pack_items[prev2].src,pack_items[prev1].src,pack_items[current].src,pack_items[next1].src,pack_items[next2].src];}
function updateSelectors(){prevIcon2=$('.prev-icon-2'),prevIcon1=$('.prev-icon-1'),mainIcon=$('.main-icon'),nextIcon1=$('.next-icon-1'),nextIcon2=$('.next-icon-2');}
this.setImages=function(direction){if(direction==='next'){prevIcon2.removeAttr('class').addClass('next-icon next-icon-2').not('[data-type="svg"]').find('img').attr('src',pack_items[next2].src);prevIcon1.removeAttr('class').addClass('prev-icon prev-icon-2');mainIcon.removeAttr('class').addClass('prev-icon prev-icon-1');nextIcon1.removeAttr('class').addClass('main-icon');nextIcon2.removeAttr('class').addClass('next-icon next-icon-1');}
if(direction==='prev'){prevIcon2.removeAttr('class').addClass('prev-icon prev-icon-1');prevIcon1.removeAttr('class').addClass('main-icon');mainIcon.removeAttr('class').addClass('next-icon next-icon-1');nextIcon1.removeAttr('class').addClass('next-icon next-icon-2');nextIcon2.removeAttr('class').addClass('prev-icon prev-icon-2').not('[data-type="svg"]').find('img').attr('src',pack_items[prev2].src);}
updateSelectors();if(svgActive&&direction==='next')getSVG(nextIcon2.not('[data-type="img"]'),pack_items[next2].src);if(svgActive&&direction==='prev')getSVG(prevIcon2.not('[data-type="img"]'),pack_items[prev2].src);};this.navigation=function(direction){if(!active){active=true;svgActive=$('#detail .svg-version').hasClass('active');headerTitle.addClass('out');if(direction==='next'){current++;prevIcon2.addClass('nextPos');prevIcon1.addClass('prevOut');mainIcon.addClass('mainPrev');nextIcon1.addClass('nextMain');nextIcon2.addClass('nextIn');ga('send','event','Detail View','Move','Next');}
if(direction==='prev'){current--;prevIcon2.addClass('prevIn');prevIcon1.addClass('prevMain');mainIcon.addClass('mainNext');nextIcon1.addClass('nextOut');nextIcon2.addClass('prevPos');ga('send','event','Detail View','Move','Previous');}
if(current>packTotal)current=0;if(current<0)current=packTotal;updateItems();set_main();setTimeout(function(){headerTitle.removeClass('out');},300);setTimeout(function(){slider.setImages(direction);active=false;},speed);}};};function set_main(){if(pack_items[current].tags.length){var ul=document.querySelector('ul.tags');ul.innerHTML='';for(i=0;i<pack_items[current].tags.length;i++){var li=document.createElement('li');var link=document.createElement('a');link.innerHTML=pack_items[current].tags[i].tag;link.href=pack_items[current].tags[i].slug;li.appendChild(link);ul.appendChild(li);}}
$('h1 span').html(pack_items[current].description);$_('.modal-single-icon.modal-download p.filename .description').innerHTML=pack_items[current].description;$_("meta[property='og:title']").content=pack_items[current].description;$_("meta[name='twitter:title']").content=pack_items[current].description;var share_image=pack_items[current].src.replace("svg/","png/512/").replace(".svg",".png");$_('.modal-single-icon.modal-download p.filename img').src=pack_items[current].src;$_("meta[property='og:image']").content=share_image;$_("meta[name='twitter:image']").content=share_image;$_("meta[property='og:url']").content=pack_items[current].slug;$_(".modal-single-icon.modal-download .modal-body").classList.toggle("nopremium",!Boolean(pack_items[current].selection));var url=pack_items[current].slug;var category=document.querySelector('.category-icon');document.title=pack_items[current].description+" -"+document.title.split("-")[1].replace(capitalize(category.innerHTML),capitalize(pack_items[current].category));document.querySelector('.category-icon').href=pack_items[current].category_url;document.querySelector('.category-icon').innerHTML=pack_items[current].category;if('history'in window){window.history.pushState({flaticon:'icon'},pack_items[current].description,url);}
ga('send','pageview',url);$_('#stats-downloads').innerHTML=pack_items[current].downloads.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");$_('#download-form #icon_id').value=pack_items[current].id;$_('#download-form #author').value=pack_items[current].team_id;$_('#download-form #selection').value=pack_items[current].selection;$_('#download-form #keyword').value=pack_items[current].keyword;set_list_tags();toggleDetailButton();if(window.innerWidth>480)$('html,body').animate({scrollTop:0},'slow');}
function toggleDetailButton(){if(window.toggleDetailBtnInterval)clearInterval(window.toggleDetailBtnInterval);if(pack_items&&current){icon_id=parseInt(pack_items[current].id,10);icon_name=pack_items[current].keyword;icon_team=parseInt(pack_items[current].team_id,10);}
if(db instanceof Object){var method='addIcon';var collection=Collection.getActive();if(db.queryAll(collection.bookmark_id,{query:{id:icon_id}}).length){method='delIcon';}
var btn=$_("#detail-icon-button");if(method==='delIcon')btn.addClass('btn-danger');else btn.removeClass('btn-danger');btn.setAttribute('onclick',"Widget."+method+"("+icon_id+",'"+icon_name+"',"+icon_team+", true)");btn.get('i').classList.toggle('flaticon-collections_remove',method=='delIcon');}else{window.toggleDetailBtnInterval=setInterval(toggleDetailButton,1000);}}
function set_list_tags(){var tags_list=pack_items[current].tags.map(function(tag){return tag.tag_id}).join();$.ajax({url:'/ajax/search/tags',data:{tags:tags_list,pack:pack},type:'POST',async:true,dataType:'json',success:function(json){var icons=json.items;var total=json.total;var tag=json.tag;$(css_selector).html('');$('section .tags a span').html(total);if(parseInt(total)>0){var breadcrumb=$('section.related-tags .breadcrumb a:last-child');breadcrumb.attr({href:"/"+tag.slug,title:tag.name});breadcrumb.html(capitalize(tag.name));$(".related-header a.badge span").html(tag.total);tplLoadItem(icons,'down',false);}},error:function(jqXHR,textStatus,errorThrown){console.log('AX ERROR['+errorThrown+']: '+textStatus);}});}
function detailReportReceived(data){document.get('#report-form').reset();document.get("#modal-report").checked=false;var method=(data.success)?'success':'warning';UserAlerts[method](data.title,data.message);}
function set_list_pack(pack,icon){if(typeof ie!=='undefined'&&ie){$('#detail').addClass('loaded ie9');return;};if(!pack_items.length)return;$('#detail').addClass('loaded');var mySlider=new iconsSlider(500);$('#detail a.prev, #detail a.next').fadeIn(250);$('#detail a.next').on('click',function(e){mySlider.navigation('next');e.preventDefault();});$('#detail a.prev').on('click',function(e){mySlider.navigation('prev');e.preventDefault();});$(document).on('keydown',function(e){if($_("#modal-download").checked){return;}
if(e.keyCode==39)mySlider.navigation('next');if(e.keyCode==37)mySlider.navigation('prev');});};var infinityLoading=0;var activatedInfinity;var initPage;var topPage;var bottomPage;var count;var total;var axScript;var css_selector;var functionParser;$(document).ready(function(){$(".pagination ul li a").on("click",function(){if(typeof(gr.sponsor.popup)!="undefined"&&!gr.auth.me.premium)gr.sponsor.popup.launch();});$("#active_infinity").change(function(){activatedInfinity=(this.checked)?1:0;if(!activatedInfinity){var pagination=$_("section.pagination");var infinite_scroll=$_(".infinite_scroll");if(pagination){pagination.classList.remove('hidden');}
if(infinite_scroll){infinite_scroll.classList.remove("hidden");}}
infinity_init();});infinity_init();});function infinity_init(){var page_counter=$_(".page-counter");var infinite_scroll=$_(".infinite_scroll");if(!history.pushState||initPage>1){var pagination=$_("section.pagination");if(pagination){pagination.classList.remove("hidden");}
if(page_counter){page_counter.classList.add("hidden");}
if(infinite_scroll){infinite_scroll.classList.add("hidden");}
return;}
if(page_counter){page_counter.classList.remove("hidden");}
if(infinite_scroll){infinite_scroll.classList.remove("hidden");}
var total_pager=document.getElementById('pag_counter_total');if(total_pager){var total_pages=Math.ceil(total/count);total_pager.innerHTML=total_pages;}
if(total==0){$_('.empty-search').className='empty-search';$('.sponsor-iframe').hide();}
$(window).scroll(function(e){if($_("#collections").offsetWidth>=document.body.offsetWidth){return;}
if(activatedInfinity&&total>0&&infinityLoading===0){infinity(axScript);}});$(window).resize(function(){setTimeout(fixSponsorIcons,200);});$(document).on('click','#collections-toggle, .collection-section-header .hide-collections',function(){setTimeout(fixSponsorIcons,200);});}
function fixSponsorIcons(){var wrapper=$('.search-result ul.icons'),ad=wrapper.find('li.ads'),adH=ad.outerHeight(true),icon=wrapper.find('li.icon'),iconH=icon.outerHeight(true),iconW=icon.outerWidth(true),iconM=parseFloat(icon.css('margin-bottom')),iconLgt=icon.length-1,iconMaxNb=Math.floor(wrapper.outerWidth(true)/iconW),new_top,new_margin_bottom,curr;wrapper.find('li').removeAttr('style');for(var i=0;i<ad.length;i++){curr=ad.eq(i),iconNbRow=Math.ceil(curr.prevAll('li.icon').length/iconMaxNb),iconIdealNb=(iconNbRow*iconMaxNb)-1;if(iconIdealNb>iconLgt)iconIdealNb=iconLgt;if(iconNbRow>0){new_top=(iconNbRow*iconH)+(curr.prevAll('li.ads').length*adH);new_margin_bottom=adH+iconM;curr.css("top",new_top).addClass('show');icon.eq(iconIdealNb).css("marginBottom",new_margin_bottom);}}}
function infinity(script,force_page){var scrollPos=$(window).scrollTop();var docHeight=$(document.body).height();var winHeight=$(window).height();var activatedUpScroll=false;footer_height=$('#footer').height()+200;var scrollYventana=$(window).scrollTop()+$(window).height()+footer_height;if(typeof force_page!=='undefined'){axLoadItems(script,force_page,'clear');}else{if(scrollYventana>=($(document).height()-footer_height)&&(total>(bottomPage*count))){infinityLoading=1;bottomPage=bottomPage+1;axLoadItems(script,bottomPage,'down');}else if(activatedUpScroll&&scrollPos===0&&initPage>1&&topPage>1){topPage=topPage-1;axLoadItems(script,topPage,'up');}else{infinityLoading=0;}}
Widget.markSelectedIcons();}
function axLoadItems(script,page,topDown){if(total>0||topDown=='clear'){var url=script;if(topDown!='clear'){var url=url+'/'+page;var pos=document.location.href.lastIndexOf('?');if(pos!=-1){url=url+'?'+document.location.href.substring(pos+1,document.location.href.length);}}
if(typeof script!=='undefined'&&script!=''){$.ajax({url:url,type:'get',dataType:'json',success:function(json){var arrItems=json.items||[];total=parseInt(json.total,10)||0;tplLoadItem(arrItems,topDown,true,page);var empty_search_element=$_('.empty-search');if(empty_search_element){empty_search_element.classList.toggle("hidden",arrItems.length>0);}
if(topDown=='clear'){infinity_init();}},error:function(jqXHR,textStatus,errorThrown){infinityLoading=0;}});}}}
function tplLoadItem(json,top_down,setUrl,page){css_selector=(css_selector==''||typeof css_selector===undefined)?'ul.icons:not(.collection_icons_list)':css_selector;if(top_down=='clear'){document.get(css_selector).innerHTML='';top_down='down';}
var element=document.get(css_selector);if(element&&!isNaN(topPage)&&!isNaN(bottomPage)&&json.length>0){var page=(top_down=='up')?topPage:bottomPage;var tpl=Handlebars.tag(templateTag);var place=(top_down=='up')?'afterbegin':'beforeend';var anchor='<li><a name="'+page+'" title="Page '+page+'"></a></li>';if(page!=1&&typeof fi_sponsor=='object'){var sponsor=(fi_sponsor.freepik.page==fi_sponsor.partner.page)?'freepik':'partner';fi_sponsor[sponsor].page++;element.insertAdjacentHTML('beforeend',anchor+fi_sponsor[sponsor].url.replace('---PAGE---',fi_sponsor[sponsor].page));var last_ads=$_(".last-ads");if(last_ads){last_ads.parentNode.removeChild(last_ads);}}
json.forEach(function(item,index){item.selection=Boolean(Number(item.selection));element.insertAdjacentHTML(place,tpl(item));if(index==100)return false;});var urlClean=urlWithoutPag(document.location.href);window.url=urlClean;var pager=document.getElementById('pag_counter');if(pager){pager.innerHTML=page;}
if(setUrl!==false){setUrlNavigator(urlClean,page,window.location.search);ga('send','pageview',getUrlNavigation(urlClean,page),{'metric1':page,'dimension9':parseQueryString(decodeURIComponent(window.location.search))['word'],});}
setTimeout(fixSponsorIcons,200);}
infinityLoading=0;}