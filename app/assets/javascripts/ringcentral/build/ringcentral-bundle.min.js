!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SDK=t():(e.RingCentral=e.RingCentral||{},e.RingCentral.SDK=t())}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="/build/",t(0)}([function(e,t,n){n(1),e.exports=n(2)},function(e,t){(function(t){!function(t){"use strict";function n(e,t,n,r){var i=Object.create((t||o).prototype),s=new h(r||[]);return i._invoke=f(e,n,s),i}function r(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}function o(){}function i(){}function s(){}function u(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function a(e){this.arg=e}function c(e){function t(t,n){var r=e[t](n),s=r.value;return s instanceof a?Promise.resolve(s.arg).then(o,i):Promise.resolve(s).then(function(e){return r.value=e,r})}function n(e,n){function o(){return t(e,n)}return r=r?r.then(o,o):new Promise(function(e){e(o())})}"object"==typeof process&&process.domain&&(t=process.domain.bind(t));var r,o=t.bind(e,"next"),i=t.bind(e,"throw");t.bind(e,"return");this._invoke=n}function f(e,t,n){var o=w;return function(i,s){if(o===x)throw new Error("Generator is already running");if(o===S){if("throw"===i)throw s;return y()}for(;;){var u=n.delegate;if(u){if("return"===i||"throw"===i&&u.iterator[i]===_){n.delegate=null;var a=u.iterator["return"];if(a){var c=r(a,u.iterator,s);if("throw"===c.type){i="throw",s=c.arg;continue}}if("return"===i)continue}var c=r(u.iterator[i],u.iterator,s);if("throw"===c.type){n.delegate=null,i="throw",s=c.arg;continue}i="next",s=_;var f=c.arg;if(!f.done)return o=k,f;n[u.resultName]=f.value,n.next=u.nextLoc,n.delegate=null}if("next"===i)n._sent=s,o===k?n.sent=s:n.sent=_;else if("throw"===i){if(o===w)throw o=S,s;n.dispatchException(s)&&(i="next",s=_)}else"return"===i&&n.abrupt("return",s);o=x;var c=r(e,t,n);if("normal"===c.type){o=n.done?S:k;var f={value:c.arg,done:n.done};if(c.arg!==E)return f;n.delegate&&"next"===i&&(s=_)}else"throw"===c.type&&(o=S,i="throw",s=c.arg)}}}function p(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function l(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function h(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(p,this),this.reset(!0)}function d(e){if(e){var t=e[b];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function o(){for(;++n<e.length;)if(v.call(e,n))return o.value=e[n],o.done=!1,o;return o.value=_,o.done=!0,o};return r.next=r}}return{next:y}}function y(){return{value:_,done:!0}}var _,v=Object.prototype.hasOwnProperty,b="function"==typeof Symbol&&Symbol.iterator||"@@iterator",m="object"==typeof e,g=t.regeneratorRuntime;if(g)return void(m&&(e.exports=g));g=t.regeneratorRuntime=m?e.exports:{},g.wrap=n;var w="suspendedStart",k="suspendedYield",x="executing",S="completed",E={},T=s.prototype=o.prototype;i.prototype=T.constructor=s,s.constructor=i,i.displayName="GeneratorFunction",g.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return t?t===i||"GeneratorFunction"===(t.displayName||t.name):!1},g.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):e.__proto__=s,e.prototype=Object.create(T),e},g.awrap=function(e){return new a(e)},u(c.prototype),g.async=function(e,t,r,o){var i=new c(n(e,t,r,o));return g.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},u(T),T[b]=function(){return this},T.toString=function(){return"[object Generator]"},g.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},g.values=d,h.prototype={constructor:h,reset:function(e){if(this.prev=0,this.next=0,this.sent=_,this.done=!1,this.delegate=null,this.tryEntries.forEach(l),!e)for(var t in this)"t"===t.charAt(0)&&v.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=_)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,r){return i.type="throw",i.arg=e,n.next=t,!!r}if(this.done)throw e;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],i=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var s=v.call(o,"catchLoc"),u=v.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&v.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?this.next=o.finallyLoc:this.complete(i),E},complete:function(e,t){if("throw"===e.type)throw e.arg;"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=e.arg,this.next="end"):"normal"===e.type&&t&&(this.next=t)},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),l(n),E}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;l(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:d(e),resultName:t,nextLoc:n},E}}}("object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this)}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=n(3),u=o(s),a=n(12),c=r(a),f=n(4),p=o(f),l=n(13),h=r(l),d=n(14),y=r(d),_=n(15),v=r(_),b=n(17),m=r(b),g=n(16),w=o(g),k=n(18),x=r(k),S=n(20),E=r(S),T=n(19),O=r(T),R=n(21),C=r(R),M=n(22),P=r(M),j=n(23),B=r(j),A=n(25),N=r(A),L=n(26),I=r(L),D=function(){function e(t){i(this,e),t=t||{},this._cache=new c["default"](p.localStorage,t.cachePrefix),this._client=t.client||new v["default"],this._platform=new C["default"](this._client,this._cache,t.server,t.appKey,t.appSecret),this._pubnubFactory=t.pubnubFactory||p.PUBNUB}return e.prototype.platform=function(){return this._platform},e.prototype.createSubscription=function(){return new N["default"](this._pubnubFactory,this._platform)},e.prototype.createCachedSubscription=function(e){return new I["default"](this._pubnubFactory,this._platform,this._cache,e)},e.prototype.cache=function(){return this._cache},e}();D.version="2.0.4",D.server={sandbox:"https://platform.devtest.ringcentral.com",production:"https://platform.ringcentral.com"},D.core={Cache:c["default"],Observable:h["default"],Utils:u,Externals:p,Queue:y["default"]},D.http={Client:v["default"],ApiResponse:m["default"],Utils:w},D.platform={Auth:P["default"],Platform:C["default"]},D.subscription={Subscription:N["default"]},D.mocks={Client:x["default"],Registry:O["default"],Mock:E["default"]},D.pubnub={PubnubMockFactory:B["default"]},e.exports=D},function(e,t,n){"use strict";function r(e){var t=[];return e=e||{},Object.keys(e).forEach(function(n){var r=e[n];s(r)?r.forEach(function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}),t.join("&")}function o(e){var t={};return e.split("&").forEach(function(e){if(e=decodeURIComponent(e),-1==e.indexOf("="))t[e.trim()]=!0;else{var n=e.split("="),r=n[0].trim(),o=n[1].trim();r in t?(r in t&&!s(t[r])&&(t[r]=[t[r]]),t[r].push(o)):t[r]=o}}),t}function i(e){return"function"==typeof e}function s(e){return Array.isArray?Array.isArray(e):"array"==typeof e}function u(t,n,r){e.exports.stopPolling(r),n=n||1e3;var o=function i(e){return e=e||n,n=e,setTimeout(function(){t(i,e)},e)};return o()}function a(e){e&&clearTimeout(e)}function c(){return"undefined"!=typeof process}function f(){return"undefined"!=typeof window}function p(e){return new l.Promise(function(t,n){setTimeout(function(){t(null)},e)})}t.__esModule=!0,t.queryStringify=r,t.parseQueryString=o,t.isFunction=i,t.isArray=s,t.poll=u,t.stopPolling=a,t.isNodeJS=c,t.isBrowser=f,t.delay=p;var l=n(4)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0,t.localStorage=t.PUBNUB=t.Headers=t.Response=t.Request=t.fetch=t.Promise=void 0;var o=n(5),i=r(o),s=n(10),u=r(s),a=n(11),c=r(a),f=new Function("return this")(),p=(t.Promise=i["default"]&&i["default"].Promise||f.Promise,t.fetch=f.fetch||u["default"]);t.Request=f.Request||p.Request,t.Response=f.Response||p.Response,t.Headers=f.Headers||p.Headers,t.PUBNUB=f.PUBNUB||c["default"],t.localStorage="undefined"!=typeof f.localStorage?f.localStorage:{}},function(e,t,n){var r;(function(e,o,i){(function(){"use strict";function s(e){return"function"==typeof e||"object"==typeof e&&null!==e}function u(e){return"function"==typeof e}function a(e){return"object"==typeof e&&null!==e}function c(e,t){re[X]=e,re[X+1]=t,X+=2,2===X&&(V?V(_):W())}function f(e){V=e}function p(){var t=process.nextTick,n=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(n)&&"0"===n[1]&&"10"===n[2]&&(t=e),function(){t(_)}}function l(){return function(){G(_)}}function h(){var e=0,t=new ee(_),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function d(){var e=new MessageChannel;return e.port1.onmessage=_,function(){e.port2.postMessage(0)}}function y(){return function(){setTimeout(_,1)}}function _(){for(var e=0;X>e;e+=2){var t=re[e],n=re[e+1];t(n),re[e]=void 0,re[e+1]=void 0}X=0}function v(){try{var e=n(!function(){var e=new Error('Cannot find module "vertx"');throw e.code="MODULE_NOT_FOUND",e}());return G=e.runOnLoop||e.runOnContext,l()}catch(t){return y()}}function b(){}function m(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function w(e){try{return e.then}catch(t){return ue.error=t,ue}}function k(e,t,n,r){try{e.call(t,n,r)}catch(o){return o}}function x(e,t,n){Y(function(e){var r=!1,o=k(n,t,function(n){r||(r=!0,t!==n?T(e,n):R(e,n))},function(t){r||(r=!0,C(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&o&&(r=!0,C(e,o))},e)}function S(e,t){t._state===ie?R(e,t._result):t._state===se?C(e,t._result):M(t,void 0,function(t){T(e,t)},function(t){C(e,t)})}function E(e,t){if(t.constructor===e.constructor)S(e,t);else{var n=w(t);n===ue?C(e,ue.error):void 0===n?R(e,t):u(n)?x(e,t,n):R(e,t)}}function T(e,t){e===t?C(e,m()):s(t)?E(e,t):R(e,t)}function O(e){e._onerror&&e._onerror(e._result),P(e)}function R(e,t){e._state===oe&&(e._result=t,e._state=ie,0!==e._subscribers.length&&Y(P,e))}function C(e,t){e._state===oe&&(e._state=se,e._result=t,Y(O,e))}function M(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+ie]=n,o[i+se]=r,0===i&&e._state&&Y(P,e)}function P(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r,o,i=e._result,s=0;s<t.length;s+=3)r=t[s],o=t[s+n],r?A(n,r,o,i):o(i);e._subscribers.length=0}}function j(){this.error=null}function B(e,t){try{return e(t)}catch(n){return ae.error=n,ae}}function A(e,t,n,r){var o,i,s,a,c=u(n);if(c){if(o=B(n,r),o===ae?(a=!0,i=o.error,o=null):s=!0,t===o)return void C(t,g())}else o=r,s=!0;t._state!==oe||(c&&s?T(t,o):a?C(t,i):e===ie?R(t,o):e===se&&C(t,o))}function N(e,t){try{t(function(t){T(e,t)},function(t){C(e,t)})}catch(n){C(e,n)}}function L(e,t){var n=this;n._instanceConstructor=e,n.promise=new e(b),n._validateInput(t)?(n._input=t,n.length=t.length,n._remaining=t.length,n._init(),0===n.length?R(n.promise,n._result):(n.length=n.length||0,n._enumerate(),0===n._remaining&&R(n.promise,n._result))):C(n.promise,n._validationError())}function I(e){return new ce(this,e).promise}function D(e){function t(e){T(o,e)}function n(e){C(o,e)}var r=this,o=new r(b);if(!Q(e))return C(o,new TypeError("You must pass an array to race.")),o;for(var i=e.length,s=0;o._state===oe&&i>s;s++)M(r.resolve(e[s]),void 0,t,n);return o}function q(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(b);return T(n,e),n}function U(e){var t=this,n=new t(b);return C(n,e),n}function F(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function J(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function K(e){this._id=de++,this._state=void 0,this._result=void 0,this._subscribers=[],b!==e&&(u(e)||F(),this instanceof K||J(),N(this,e))}function H(){var e;if("undefined"!=typeof o)e=o;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=e.Promise;(!n||"[object Promise]"!==Object.prototype.toString.call(n.resolve())||n.cast)&&(e.Promise=ye)}var z;z=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var G,V,W,Q=z,X=0,Y=({}.toString,c),$="undefined"!=typeof window?window:void 0,Z=$||{},ee=Z.MutationObserver||Z.WebKitMutationObserver,te="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),ne="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,re=new Array(1e3);W=te?p():ee?h():ne?d():void 0===$?v():y();var oe=void 0,ie=1,se=2,ue=new j,ae=new j;L.prototype._validateInput=function(e){return Q(e)},L.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},L.prototype._init=function(){this._result=new Array(this.length)};var ce=L;L.prototype._enumerate=function(){for(var e=this,t=e.length,n=e.promise,r=e._input,o=0;n._state===oe&&t>o;o++)e._eachEntry(r[o],o)},L.prototype._eachEntry=function(e,t){var n=this,r=n._instanceConstructor;a(e)?e.constructor===r&&e._state!==oe?(e._onerror=null,n._settledAt(e._state,t,e._result)):n._willSettleAt(r.resolve(e),t):(n._remaining--,n._result[t]=e)},L.prototype._settledAt=function(e,t,n){var r=this,o=r.promise;o._state===oe&&(r._remaining--,e===se?C(o,n):r._result[t]=n),0===r._remaining&&R(o,r._result)},L.prototype._willSettleAt=function(e,t){var n=this;M(e,void 0,function(e){n._settledAt(ie,t,e)},function(e){n._settledAt(se,t,e)})};var fe=I,pe=D,le=q,he=U,de=0,ye=K;K.all=fe,K.race=pe,K.resolve=le,K.reject=he,K._setScheduler=f,K._asap=Y,K.prototype={constructor:K,then:function(e,t){var n=this,r=n._state;if(r===ie&&!e||r===se&&!t)return this;var o=new this.constructor(b),i=n._result;if(r){var s=arguments[r-1];Y(function(){A(r,o,s,i)})}else M(n,o,e,t);return o},"catch":function(e){return this.then(null,e)}};var _e=H,ve={Promise:ye,polyfill:_e};n(9).amd?(r=function(){return ve}.call(t,n,t,i),!(void 0!==r&&(i.exports=r))):"undefined"!=typeof i&&i.exports?i.exports=ve:"undefined"!=typeof this&&(this.ES6Promise=ve),_e()}).call(this)}).call(t,n(6).setImmediate,function(){return this}(),n(8)(e))},function(e,t,n){(function(e,r){function o(e,t){this._id=e,this._clearFn=t}var i=n(7).nextTick,s=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;t.setTimeout=function(){return new o(s.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new o(s.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},t.setImmediate="function"==typeof e?e:function(e){var n=c++,r=arguments.length<2?!1:u.call(arguments,1);return a[n]=!0,i(function(){a[n]&&(r?e.apply(null,r):e.call(null),t.clearImmediate(n))}),n},t.clearImmediate="function"==typeof r?r:function(e){delete a[e]}}).call(t,n(6).setImmediate,n(6).clearImmediate)},function(e,t){function n(){c=!1,s.length?a=s.concat(a):f=-1,a.length&&r()}function r(){if(!c){var e=setTimeout(n);c=!0;for(var t=a.length;t;){for(s=a,a=[];++f<t;)s&&s[f].run();f=-1,t=a.length}s=null,c=!1,clearTimeout(e)}}function o(e,t){this.fun=e,this.array=t}function i(){}var s,u=e.exports={},a=[],c=!1,f=-1;u.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.push(new o(e,t)),1!==a.length||c||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=i,u.addListener=i,u.once=i,u.off=i,u.removeListener=i,u.removeAllListeners=i,u.emit=i,u.binding=function(e){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(e){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t){!function(){"use strict";function e(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function t(e){return"string"!=typeof e&&(e=String(e)),e}function n(e){this.map={},e instanceof n?e.forEach(function(e,t){this.append(t,e)},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function r(e){return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function o(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function i(e){var t=new FileReader;return t.readAsArrayBuffer(e),o(t)}function s(e){var t=new FileReader;return t.readAsText(e),o(t)}function u(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,"string"==typeof e)this._bodyText=e;else if(h.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(h.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else{if(e)throw new Error("unsupported BodyInit type");this._bodyText=""}},h.blob?(this.blob=function(){var e=r(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(i)},this.text=function(){var e=r(this);if(e)return e;if(this._bodyBlob)return s(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var e=r(this);return e?e:Promise.resolve(this._bodyText)},h.formData&&(this.formData=function(){return this.text().then(f)}),this.json=function(){return this.text().then(JSON.parse)},this}function a(e){var t=e.toUpperCase();return d.indexOf(t)>-1?t:e}function c(e,t){t=t||{};var r=t.body;if(c.prototype.isPrototypeOf(e)){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new n(e.headers)),this.method=e.method,this.mode=e.mode,r||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=e;if(this.credentials=t.credentials||this.credentials||"omit",(t.headers||!this.headers)&&(this.headers=new n(t.headers)),this.method=a(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function f(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(o))}}),t}function p(e){var t=new n,r=e.getAllResponseHeaders().trim().split("\n");return r.forEach(function(e){var n=e.trim().split(":"),r=n.shift().trim(),o=n.join(":").trim();t.append(r,o)}),t}function l(e,t){t||(t={}),this._initBody(e),this.type="default",this.url=null,this.status=t.status,this.ok=this.status>=200&&this.status<300,this.statusText=t.statusText,this.headers=t.headers instanceof n?t.headers:new n(t.headers),this.url=t.url||""}if(!self.fetch){n.prototype.append=function(n,r){n=e(n),r=t(r);var o=this.map[n];o||(o=[],this.map[n]=o),o.push(r)},n.prototype["delete"]=function(t){delete this.map[e(t)]},n.prototype.get=function(t){var n=this.map[e(t)];return n?n[0]:null},n.prototype.getAll=function(t){return this.map[e(t)]||[]},n.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},n.prototype.set=function(n,r){this.map[e(n)]=[t(r)]},n.prototype.forEach=function(e,t){Object.getOwnPropertyNames(this.map).forEach(function(n){this.map[n].forEach(function(r){e.call(t,r,n,this)},this)},this)};var h={blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self},d=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];u.call(c.prototype),u.call(l.prototype),self.Headers=n,self.Request=c,self.Response=l,self.fetch=function(e,t){var n;return n=c.prototype.isPrototypeOf(e)&&!t?e:new c(e,t),new Promise(function(e,t){function r(){return"responseURL"in o?o.responseURL:/^X-Request-URL:/m.test(o.getAllResponseHeaders())?o.getResponseHeader("X-Request-URL"):void 0}var o=new XMLHttpRequest;o.onload=function(){var n=1223===o.status?204:o.status;if(100>n||n>599)return void t(new TypeError("Network request failed"));var i={status:n,statusText:o.statusText,headers:p(o),url:r()},s="response"in o?o.response:o.responseText;e(new l(s,i))},o.onerror=function(){t(new TypeError("Network request failed"))},o.open(n.method,n.url,!0),"include"===n.credentials&&(o.withCredentials=!0),"responseType"in o&&h.blob&&(o.responseType="blob"),n.headers.forEach(function(e,t){o.setRequestHeader(t,e)}),o.send("undefined"==typeof n._bodyInit?null:n._bodyInit)})},self.fetch.polyfill=!0}}()},function(module,exports,__webpack_require__){(function(module){window.JSON&&window.JSON.stringify||function(){function toJSON(e){try{return this.valueOf()}catch(t){return null}}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,o,i,s,u=gap,a=t[e];switch(a&&"object"==typeof a&&(a=toJSON.call(a,e)),"function"==typeof rep&&(a=rep.call(t,e,a)),typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(a)){for(i=a.length,n=0;i>n;n+=1)s[n]=str(n,a)||"null";return o=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+u+"]":"["+s.join(",")+"]",gap=u,o}if(rep&&"object"==typeof rep)for(i=rep.length,n=0;i>n;n+=1)r=rep[n],"string"==typeof r&&(o=str(r,a),o&&s.push(quote(r)+(gap?": ":":")+o));else for(r in a)Object.hasOwnProperty.call(a,r)&&(o=str(r,a),o&&s.push(quote(r)+(gap?": ":":")+o));return o=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+u+"}":"{"+s.join(",")+"}",gap=u,o}}window.JSON||(window.JSON={});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;n>r;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text){return eval("("+text+")")})}(),window.PUBNUB||function(){function e(){return"x"+ ++N+ +new Date}function t(){return+new Date}function r(e,t){var n=e.join(H),r=[];return t?(f(t,function(e,t){var n="object"==typeof t?JSON.stringify(t):t;"undefined"!=typeof t&&null!=t&&h(n).length>0&&r.push(e+"="+h(n))}),n+="?"+r.join(z)):n}function o(e,n){var r,o=0,i=function(){o+n>t()?(clearTimeout(r),r=setTimeout(i,n)):(o=t(),e())};return i}function i(e,t){var n=[];return f(e||[],function(e){t(e)&&n.push(e)}),n}function s(e,t){return e.replace(Q,function(e,n){return t[n]||e})}function u(e,t){return setTimeout(e,t)}function a(e){var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)});return e&&e(t),t}function c(e){return!!e&&"string"!=typeof e&&(Array.isArray&&Array.isArray(e)||"number"==typeof e.length)}function f(e,t){if(e&&t)if(c(e))for(var n=0,r=e.length;r>n;)t.call(e[n],e[n],n++);else for(var n in e)e.hasOwnProperty&&e.hasOwnProperty(n)&&t.call(e[n],n,e[n])}function p(e,t){var n=[];return f(e||[],function(e,r){n.push(t(e,r))}),n}function l(e){return encodeURIComponent(e).replace(/[!'()*~]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function h(e){return encodeURIComponent(e)}function d(e,t){var n=[];return f(e,function(e,r){t?e.search("-pnpres")<0&&r.subscribed&&n.push(e):r.subscribed&&n.push(e)}),n.sort()}function y(e,t){var n=[];return f(e,function(e,r){t?e.search("-pnpres")<0&&r.subscribed&&n.push(e):r.subscribed&&n.push(e)}),n.sort()}function _(){u(function(){L||(L=1,f(I,function(e){e()}))},K)}function v(v){function b(e){return e||(e={}),f(je,function(t,n){t in e||(e[t]=n)}),e}function m(e){var t=[];return f(e,function(e,n){t.push(e)}),t}function g(e){return m(e).sort()}function w(e){var t="",n=g(e);for(var r in n){var o=n[r];t+=o+"="+l(e[o]),r!=n.length-1&&(t+="&")}return t}function x(e,t,n){var r=!1;if("undefined"==typeof e)return t;if("number"==typeof e)r=e>G||0==e?!1:!0;else{if("boolean"==typeof e)return e?V:0;r=!0}return r?(n&&n("Presence Heartbeat value invalid. Valid range ( x > "+G+" or x = 0). Current Value : "+(t||G)),t||G):e}function S(e,t){return He.encrypt(e,t||Ie)||e}function E(e,t){return He.decrypt(e,t||Ie)||He.decrypt(e,Ie)||e}function T(){return clearTimeout(Ee),!Oe||Oe>=500||1>Oe||!d(ke,!0).length&&!y(xe,!0).length?void(Re=!1):(Re=!0,void ze.presence_heartbeat({callback:function(e){Ee=u(T,Oe*K)},error:function(e){Be&&Be("Presence Heartbeat unable to reach Pubnub servers."+JSON.stringify(e)),Ee=u(T,Oe*K)}}))}function O(){!Re&&T()}function R(e){if(Ce){if(!he.length)return}else{if(e&&(he.sending=0),he.sending||!he.length)return;he.sending=1}Pe(he.shift())}function C(e){var t=0;return f(y(xe),function(n){var r=xe[n];r&&(t++,(e||function(){})(r))}),t}function M(e){var t=0;return f(d(ke),function(n){var r=ke[n];r&&(t++,(e||function(){})(r))}),t}function P(e,t,n){if("object"==typeof e){if(e.error){var r={};return e.message&&(r.message=e.message),e.payload&&(r.payload=e.payload),void(n&&n(r))}if(e.payload)return void(e.next_page?t&&t(e.payload,e.next_page):t&&t(e.payload))}t&&t(e)}function j(e,t){if("object"==typeof e&&e.error){var n={};return e.message&&(n.message=e.message),e.payload&&(n.payload=e.payload),void(t&&t(n))}t&&t(e)}function B(e,t,n,r){var t=e.callback||t,o=e.error||Be,i=Ne();r=r||{},r.auth||(r.auth=e.auth_key||ie);var s=[fe,"v1","channel-registration","sub-key",oe];s.push.apply(s,n),i&&(r.callback=i),Pe({callback:i,data:b(r),success:function(e){P(e,t,o)},fail:function(e){j(e,o)},url:s})}function A(){Ae()||U(1,{error:"Offline. Please check your network settings. "}),Q&&clearTimeout(Q),Q=u(A,K)}function N(){te&&ze.time(function(e){z(function(){},e),e||U(1,{error:"Heartbeat failed to connect to Pubnub Servers.Please check your network settings."}),Y&&clearTimeout(Y),Y=u(N,ee)})}function U(e,t){be&&be(e,t),be=null,clearTimeout(Q),clearTimeout(Y)}function H(e){var n=t()-ye;return n-e/1e4}function z(e,n){function r(n){if(n){var r=n/1e4,i=(t()-o)/2;ye=t()-(r+i),e&&e(ye)}}var o=t();n&&r(n)||ze.time(r)}var Q,Y,$=+v.windowing||q,Z=(+v.timeout||F)*K,ee=(+v.keepalive||J)*K,te=v.timecheck||0,ne=v.noleave||0,re=v.publish_key,oe=v.subscribe_key,ie=v.auth_key||"",se=v.secret_key||"",ue=v.hmac_SHA256,ae=v.ssl?"s":"",ce="http"+ae+"://"+(v.origin||"pubsub.pubnub.com"),fe=X(ce),pe=X(ce),le=function(){},he=[],de=!0,ye=0,_e=0,ve=0,be=0,me=v.restore||0,ge=0,we=!1,ke={},xe={},Se={},Ee=null,Te=x(v.heartbeat||v.pnexpires||0,v.error),Oe=v.heartbeat_interval||Te/2-1,Re=!1,Ce=v.no_wait_for_pending,Me=v["compatible_3.5"]||!1,Pe=v.xdr,je=v.params||{},Be=v.error||function(){},Ae=v._is_online||function(){return 1},Ne=v.jsonp_cb||function(){return 0},Le=v.db||{get:function(){},set:function(){}},Ie=v.cipher_key,De=v.uuid||!v.unique_uuid&&Le&&Le.get(oe+"uuid")||"",qe=v.instance_id||!1,Ue="",Fe=v.shutdown,Je="undefined"!=typeof v.use_send_beacon?v.use_send_beacon:!0,Ke=Je?v.sendBeacon:null;2===Te&&(Oe=1);var He=v.crypto_obj||{encrypt:function(e,t){return e},decrypt:function(e,t){return e}},ze={LEAVE:function(e,t,n,o,i){var s,u,a={uuid:De,auth:n||ie},c=X(ce),o=o||function(){},f=i||function(){},p=Ne();if(e.indexOf(D)>0)return!0;if(Me){if(!ae)return!1;if("0"==p)return!1}return ne?!1:("0"!=p&&(a.callback=p),qe&&(a.instanceid=Ue),s=[c,"v2","presence","sub_key",oe,"channel",h(e),"leave"],u=b(a),Ke&&(url_string=r(s,u),Ke(url_string))?(o&&o({status:200,action:"leave",message:"OK",service:"Presence"}),!0):(Pe({blocking:t||ae,timeout:2e3,callback:p,data:u,success:function(e){P(e,o,f)},fail:function(e){j(e,f)},url:s}),!0))},LEAVE_GROUP:function(e,t,n,o,i){var s,u,a={uuid:De,auth:n||ie},c=X(ce),o=o||function(){},f=i||function(){},p=Ne();if(e.indexOf(D)>0)return!0;if(Me){if(!ae)return!1;if("0"==p)return!1}return ne?!1:("0"!=p&&(a.callback=p),e&&e.length>0&&(a["channel-group"]=e),qe&&(a.instanceid=Ue),s=[c,"v2","presence","sub_key",oe,"channel",h(","),"leave"],u=b(a),Ke&&(url_string=r(s,u),Ke(url_string))?(o&&o({status:200,action:"leave",message:"OK",service:"Presence"}),!0):(Pe({blocking:t||ae,timeout:5e3,callback:p,data:u,success:function(e){P(e,o,f)},fail:function(e){j(e,f)},url:s}),!0))},set_resumed:function(e){we=e},get_cipher_key:function(){return Ie},set_cipher_key:function(e){Ie=e},raw_encrypt:function(e,t){return S(e,t)},raw_decrypt:function(e,t){return E(e,t)},get_heartbeat:function(){return Te},set_heartbeat:function(e,t){Te=x(e,Te,Be),Oe=t||Te/2-1,2==Te&&(Oe=1),le(),T()},get_heartbeat_interval:function(){return Oe},set_heartbeat_interval:function(e){Oe=e,T()},get_version:function(){return W},getGcmMessageObject:function(e){return{data:e}},getApnsMessageObject:function(e){var t={aps:{badge:1,alert:""}};for(k in e)k[t]=e[k];return t},newPnMessage:function(){var e={};gcm&&(e.pn_gcm=gcm),apns&&(e.pn_apns=apns);for(k in n)e[k]=n[k];return e},_add_param:function(e,t){je[e]=t},channel_group:function(e,t){var n,r,o=e.channel_group,t=t||e.callback,i=e.channels||e.channel,s=e.cloak,u=[],a={},f=e.mode||"add";if(o){var p=o.split(":");
p.length>1?(n="*"===p[0]?null:p[0],r=p[1]):r=p[0]}n&&u.push("namespace")&&u.push(h(n)),u.push("channel-group"),r&&"*"!==r&&u.push(r),i?(c(i)&&(i=i.join(",")),a[f]=i,a.cloak=de?"true":"false"):"remove"===f&&u.push("remove"),"undefined"!=typeof s&&(a.cloak=s?"true":"false"),B(e,t,u,a)},channel_group_list_groups:function(e,t){var n;n=e.namespace||e.ns||e.channel_group||null,n&&(e.channel_group=n+":*"),ze.channel_group(e,t)},channel_group_list_channels:function(e,t){return e.channel_group?void ze.channel_group(e,t):Be("Missing Channel Group")},channel_group_remove_channel:function(e,t){return e.channel_group?e.channel||e.channels?(e.mode="remove",void ze.channel_group(e,t)):Be("Missing Channel"):Be("Missing Channel Group")},channel_group_remove_group:function(e,t){return e.channel_group?e.channel?Be("Use channel_group_remove_channel if you want to remove a channel from a group."):(e.mode="remove",void ze.channel_group(e,t)):Be("Missing Channel Group")},channel_group_add_channel:function(e,t){return e.channel_group?e.channel||e.channels?void ze.channel_group(e,t):Be("Missing Channel"):Be("Missing Channel Group")},channel_group_cloak:function(e,t){return"undefined"==typeof e.cloak?void t(de):(de=e.cloak,void ze.channel_group(e,t))},channel_group_list_namespaces:function(e,t){var n=["namespace"];B(e,t,n)},channel_group_remove_namespace:function(e,t){var n=["namespace",e.namespace,"remove"];B(e,t,n)},history:function(e,t){var t=e.callback||t,n=e.count||e.limit||100,r=e.reverse||"false",o=e.error||function(){},i=e.auth_key||ie,s=e.cipher_key,u=e.channel,a=e.channel_group,c=e.start,f=e.end,p=e.include_token,l=e.string_message_token||!1,d={},y=Ne();return u||a?t?oe?(d.stringtoken="true",d.count=n,d.reverse=r,d.auth=i,a&&(d["channel-group"]=a,u||(u=",")),y&&(d.callback=y),c&&(d.start=c),f&&(d.end=f),p&&(d.include_token="true"),l&&(d.string_message_token="true"),void Pe({callback:y,data:b(d),success:function(e){if("object"==typeof e&&e.error)return void o({message:e.message,payload:e.payload});for(var n=e[0],r=[],i=0;i<n.length;i++)if(p){var u=E(n[i].message,s),a=n[i].timetoken;try{r.push({message:JSON.parse(u),timetoken:a})}catch(c){r.push({message:u,timetoken:a})}}else{var u=E(n[i],s);try{r.push(JSON.parse(u))}catch(c){r.push(u)}}t([r,e[1],e[2]])},fail:function(e){j(e,o)},url:[fe,"v2","history","sub-key",oe,"channel",h(u)]})):Be("Missing Subscribe Key"):Be("Missing Callback"):Be("Missing Channel")},replay:function(e,t){var n,t=t||e.callback||function(){},r=e.auth_key||ie,o=e.source,i=e.destination,s=e.stop,u=e.start,a=e.end,c=e.reverse,f=e.limit,p=Ne(),l={};return o?i?re?oe?("0"!=p&&(l.callback=p),s&&(l.stop="all"),c&&(l.reverse="true"),u&&(l.start=u),a&&(l.end=a),f&&(l.count=f),l.auth=r,n=[fe,"v1","replay",re,oe,o,i],void Pe({callback:p,success:function(e){P(e,t,err)},fail:function(){t([0,"Disconnected"])},url:n,data:b(l)})):Be("Missing Subscribe Key"):Be("Missing Publish Key"):Be("Missing Destination Channel"):Be("Missing Source Channel")},auth:function(e){ie=e,le()},time:function(e){var t=Ne(),n={uuid:De,auth:ie};qe&&(n.instanceid=Ue),Pe({callback:t,data:b(n),timeout:5*K,url:[fe,"time",t],success:function(t){e(t[0])},fail:function(){e(0)}})},publish:function(e,t){var n=e.message;if(!n)return Be("Missing Message");var r,o,t=t||e.callback||n.callback||function(){},i=e.channel||n.channel,s=e.auth_key||ie,u=e.cipher_key,a=e.error||n.error||function(){},c=e.post||!1,f="store_in_history"in e?e.store_in_history:!0,p=Ne(),l="push";return e.prepend&&(l="unshift"),i?re?oe?(n.getPubnubMessage&&(n=n.getPubnubMessage()),n=JSON.stringify(S(n,u)),o=[fe,"publish",re,oe,0,h(i),p,h(n)],r={uuid:De,auth:s},f||(r.store="0"),qe&&(r.instanceid=Ue),he[l]({callback:p,timeout:5*K,url:o,data:b(r),fail:function(e){j(e,a),R(1)},success:function(e){P(e,t,a),R(1)},mode:c?"POST":"GET"}),void R()):Be("Missing Subscribe Key"):Be("Missing Publish Key"):Be("Missing Channel")},unsubscribe:function(e,t){var n=e.channel,r=e.channel_group,o=e.auth_key||ie,t=t||e.callback||function(){},i=e.error||function(){};if(ge=0,me=1,n){var s=p((n.join?n.join(","):""+n).split(","),function(e){return ke[e]?e:void 0}).join(",");n=p((n.join?n.join(","):""+n).split(","),function(e){return ke[e]?e+","+e+D:void 0}).join(","),f(n.split(","),function(e){e&&(ke[e]=0,e in Se&&delete Se[e])});var u=!0;L&&(u=ze.LEAVE(s,0,o,t,i)),u||t({action:"leave"})}if(r){var a=p((r.join?r.join(","):""+r).split(","),function(e){return xe[e]?e:void 0}).join(",");r=p((r.join?r.join(","):""+r).split(","),function(e){return xe[e]?e+","+e+D:void 0}).join(","),f(r.split(","),function(e){e&&(xe[e]=0,e in Se&&delete Se[e])});var u=!0;L&&(u=ze.LEAVE_GROUP(a,0,o,t,i)),u||t({action:"leave"})}le()},subscribe:function(e,n){function r(e){e?u(le,S):(fe=X(ce,1),pe=X(ce,1),u(function(){ze.time(r)},K)),M(function(t){return e&&t.disconnected?(t.disconnected=0,t.reconnect(t.name)):void(e||t.disconnected||(t.disconnected=1,t.disconnect(t.name)))}),C(function(t){return e&&t.disconnected?(t.disconnected=0,t.reconnect(t.name)):void(e||t.disconnected||(t.disconnected=1,t.disconnect(t.name)))})}function o(){var e=Ne(),t=d(ke).join(","),n=y(xe).join(",");if(t||n){t||(t=","),U();var i=b({uuid:De,auth:ie});n&&(i["channel-group"]=n);var s=JSON.stringify(Se);s.length>2&&(i.state=JSON.stringify(Se)),Te&&(i.heartbeat=Te),qe&&(i.instanceid=Ue),O(),be=Pe({timeout:x,callback:e,fail:function(e){e&&e.error&&e.service?(j(e,_),r(1)):ze.time(function(t){!t&&j(e,_),r(t)})},data:b(i),url:[pe,"subscribe",oe,h(t),e,ge],success:function(e){if(!e||"object"==typeof e&&"error"in e&&e.error)return _(e.error),u(le,K);if(v(e[1]),ge=!ge&&me&&Le.get(oe)||e[1],M(function(e){e.connected||(e.connected=1,e.connect(e.name))}),C(function(e){e.connected||(e.connected=1,e.connect(e.name))}),we&&!me)return ge=0,we=!1,Le.set(oe,0),void u(o,S);w&&(ge=1e4,w=0),Le.set(oe,e[1]);var t=function(){var t="",n="";e.length>3?(t=e[3],n=e[2]):t=e.length>2?e[2]:p(d(ke),function(t){return p(Array(e[0].length).join(",").split(","),function(){return t})}).join(",");var r=t.split(","),o=n?n.split(","):[];return function(){var e=r.shift()||ve,t=o.shift(),n={};t?(e&&e.indexOf("-pnpres")>=0&&t.indexOf("-pnpres")<0&&(t+="-pnpres"),n=xe[t]||ke[t]||{callback:function(){}}):n=ke[e];var i=[n.callback||_e,e.split(D)[0]];return t&&i.push(t.split(D)[0]),i}}(),n=H(+e[1]);f(e[0],function(r){var o=t(),i=E(r,ke[o[1]]?ke[o[1]].cipher_key:null);o[0]&&o[0](i,e,o[2]||o[1],n,o[1])}),u(o,S)}})}}var i=e.channel,s=e.channel_group,n=n||e.callback,n=n||e.message,a=e.connect||function(){},c=e.reconnect||function(){},l=e.disconnect||function(){},_=e.error||_||function(){},v=e.idle||function(){},m=e.presence||0,g=e.noheresync||0,w=e.backfill||0,k=e.timetoken||0,x=e.timeout||Z,S=e.windowing||$,T=e.state,R=e.heartbeat||e.pnexpires,P=e.heartbeat_interval,B=e.restore||me;return ie=e.auth_key||ie,me=B,ge=k,i||s?n?oe?((R||0===R||P||0===P)&&ze.set_heartbeat(R,P),i&&f((i.join?i.join(","):""+i).split(","),function(r){var o=ke[r]||{};ke[ve=r]={name:r,connected:o.connected,disconnected:o.disconnected,subscribed:1,callback:_e=n,cipher_key:e.cipher_key,connect:a,disconnect:l,reconnect:c},T&&(r in T?Se[r]=T[r]:Se[r]=T),m&&(ze.subscribe({channel:r+D,callback:m,restore:B}),o.subscribed||g||ze.here_now({channel:r,data:b({uuid:De,auth:ie}),callback:function(e){f("uuids"in e?e.uuids:[],function(n){m({action:"join",uuid:n,timestamp:Math.floor(t()/1e3),occupancy:e.occupancy||1},e,r)})}}))}),s&&f((s.join?s.join(","):""+s).split(","),function(r){var o=xe[r]||{};xe[r]={name:r,connected:o.connected,disconnected:o.disconnected,subscribed:1,callback:_e=n,cipher_key:e.cipher_key,connect:a,disconnect:l,reconnect:c},m&&(ze.subscribe({channel_group:r+D,callback:m,restore:B,auth_key:ie}),o.subscribed||g||ze.here_now({channel_group:r,data:b({uuid:De,auth:ie}),callback:function(e){f("uuids"in e?e.uuids:[],function(n){m({action:"join",uuid:n,timestamp:Math.floor(t()/1e3),occupancy:e.occupancy||1},e,r)})}}))}),le=function(){U(),u(o,S)},L?void le():I.push(le)):Be("Missing Subscribe Key"):Be("Missing Callback"):Be("Missing Channel")},here_now:function(e,t){var t=e.callback||t,n=e.debug,r=e.error||function(){},o=e.auth_key||ie,i=e.channel,s=e.channel_group,u=Ne(),a="uuids"in e?e.uuids:!0,c=e.state,f={uuid:De,auth:o};if(a||(f.disable_uuids=1),c&&(f.state=1),!t)return Be("Missing Callback");if(!oe)return Be("Missing Subscribe Key");var p=[fe,"v2","presence","sub_key",oe];i&&p.push("channel")&&p.push(h(i)),"0"!=u&&(f.callback=u),s&&(f["channel-group"]=s,!i&&p.push("channel")&&p.push(",")),qe&&(f.instanceid=Ue),Pe({callback:u,data:b(f),success:function(e){P(e,t,r)},fail:function(e){j(e,r)},debug:n,url:p})},where_now:function(e,t){var t=e.callback||t,n=e.error||function(){},r=e.auth_key||ie,o=Ne(),i=e.uuid||De,s={auth:r};return t?oe?("0"!=o&&(s.callback=o),qe&&(s.instanceid=Ue),void Pe({callback:o,data:b(s),success:function(e){P(e,t,n)},fail:function(e){j(e,n)},url:[fe,"v2","presence","sub_key",oe,"uuid",h(i)]})):Be("Missing Subscribe Key"):Be("Missing Callback")},state:function(e,t){var n,t=e.callback||t||function(e){},r=e.error||function(){},o=e.auth_key||ie,i=Ne(),s=e.state,u=e.uuid||De,a=e.channel,c=e.channel_group,f=b({auth:o});return oe?u?a||c?("0"!=i&&(f.callback=i),"undefined"!=typeof a&&ke[a]&&ke[a].subscribed&&s&&(Se[a]=s),"undefined"!=typeof c&&xe[c]&&xe[c].subscribed&&(s&&(Se[c]=s),f["channel-group"]=c,a||(a=",")),f.state=JSON.stringify(s),qe&&(f.instanceid=Ue),n=s?[fe,"v2","presence","sub-key",oe,"channel",a,"uuid",u,"data"]:[fe,"v2","presence","sub-key",oe,"channel",a,"uuid",h(u)],void Pe({callback:i,data:b(f),success:function(e){P(e,t,r)},fail:function(e){j(e,r)},url:n})):Be("Missing Channel"):Be("Missing UUID"):Be("Missing Subscribe Key")},grant:function(e,t){var t=e.callback||t,n=e.error||function(){},r=e.channel||e.channels,o=e.channel_group,i=Ne(),s=e.ttl,u=e.read?"1":"0",a=e.write?"1":"0",f=e.manage?"1":"0",p=e.auth_key||e.auth_keys;if(!t)return Be("Missing Callback");if(!oe)return Be("Missing Subscribe Key");if(!re)return Be("Missing Publish Key");if(!se)return Be("Missing Secret Key");var l=Math.floor((new Date).getTime()/1e3),h=oe+"\n"+re+"\ngrant\n",d={w:a,r:u,timestamp:l};e.manage&&(d.m=f),c(r)&&(r=r.join(",")),c(p)&&(p=p.join(",")),"undefined"!=typeof r&&null!=r&&r.length>0&&(d.channel=r),"undefined"!=typeof o&&null!=o&&o.length>0&&(d["channel-group"]=o),"0"!=i&&(d.callback=i),(s||0===s)&&(d.ttl=s),p&&(d.auth=p),d=b(d),p||delete d.auth,h+=w(d);var y=ue(h,se);y=y.replace(/\+/g,"-"),y=y.replace(/\//g,"_"),d.signature=y,Pe({callback:i,data:d,success:function(e){P(e,t,n)},fail:function(e){j(e,n)},url:[fe,"v1","auth","grant","sub-key",oe]})},mobile_gw_provision:function(e){var t,n,r=e.callback||function(){},o=e.auth_key||ie,i=e.error||function(){},s=Ne(),u=e.channel,a=e.op,c=e.gw_type,f=e.device_id;return f?c?a?u?re?oe?(n=[fe,"v1/push/sub-key",oe,"devices",f],t={uuid:De,auth:o,type:c},"add"==a?t.add=u:"remove"==a&&(t.remove=u),qe&&(data.instanceid=Ue),void Pe({callback:s,data:t,success:function(e){P(e,r,i)},fail:function(e){j(e,i)},url:n})):Be("Missing Subscribe Key"):Be("Missing Publish Key"):Be("Missing gw destination Channel (channel)"):Be("Missing GW Operation (op: add or remove)"):Be("Missing GW Type (gw_type: gcm or apns)"):Be("Missing Device ID (device_id)")},audit:function(e,t){var t=e.callback||t,n=e.error||function(){},r=e.channel,o=e.channel_group,i=e.auth_key,s=Ne();if(!t)return Be("Missing Callback");if(!oe)return Be("Missing Subscribe Key");if(!re)return Be("Missing Publish Key");if(!se)return Be("Missing Secret Key");var u=Math.floor((new Date).getTime()/1e3),a=oe+"\n"+re+"\naudit\n",c={timestamp:u};"0"!=s&&(c.callback=s),"undefined"!=typeof r&&null!=r&&r.length>0&&(c.channel=r),"undefined"!=typeof o&&null!=o&&o.length>0&&(c["channel-group"]=o),i&&(c.auth=i),c=b(c),i||delete c.auth,a+=w(c);var f=ue(a,se);f=f.replace(/\+/g,"-"),f=f.replace(/\//g,"_"),c.signature=f,Pe({callback:s,data:c,success:function(e){P(e,t,n)},fail:function(e){j(e,n)},url:[fe,"v1","auth","audit","sub-key",oe]})},revoke:function(e,t){e.read=!1,e.write=!1,ze.grant(e,t)},set_uuid:function(e){De=e,le()},get_uuid:function(){return De},isArray:function(e){return c(e)},get_subscibed_channels:function(){return d(ke,!0)},presence_heartbeat:function(e){var t=e.callback||function(){},n=e.error||function(){},r=Ne(),o={uuid:De,auth:ie},i=JSON.stringify(Se);i.length>2&&(o.state=JSON.stringify(Se)),Te>0&&320>Te&&(o.heartbeat=Te),"0"!=r&&(o.callback=r);var s=h(d(ke,!0).join(",")),u=y(xe,!0).join(",");s||(s=","),u&&(o["channel-group"]=u),qe&&(o.instanceid=Ue),Pe({callback:r,data:b(o),timeout:5*K,url:[fe,"v2","presence","sub-key",oe,"channel",s,"heartbeat"],success:function(e){P(e,t,n)},fail:function(e){j(e,n)}})},stop_timers:function(){clearTimeout(Q),clearTimeout(Y),clearTimeout(Ee)},shutdown:function(){ze.stop_timers(),Fe&&Fe()},xdr:Pe,ready:_,db:Le,uuid:a,map:p,each:f,"each-channel":M,grep:i,offline:function(){U(1,{message:"Offline. Please check your network settings."})},supplant:s,now:t,unique:e,updater:o};return De||(De=ze.uuid()),Ue||(Ue=ze.uuid()),Le.set(oe+"uuid",De),Q=u(A,K),Y=u(N,ee),Ee=u(O,(Oe-3)*K),z(),ze}function b(){function e(e){return CryptoJS.SHA256(e).toString(CryptoJS.enc.Hex)}function t(e){return e=e||{},e.hasOwnProperty("encryptKey")||(e.encryptKey=f.encryptKey),e.hasOwnProperty("keyEncoding")||(e.keyEncoding=f.keyEncoding),e.hasOwnProperty("keyLength")||(e.keyLength=f.keyLength),e.hasOwnProperty("mode")||(e.mode=f.mode),-1==u.indexOf(e.keyEncoding.toLowerCase())&&(e.keyEncoding=f.keyEncoding),-1==a.indexOf(parseInt(e.keyLength,10))&&(e.keyLength=f.keyLength),-1==c.indexOf(e.mode.toLowerCase())&&(e.mode=f.mode),e}function n(e,t){return"base64"==t.keyEncoding?CryptoJS.enc.Base64.parse(e):"hex"==t.keyEncoding?CryptoJS.enc.Hex.parse(e):e}function r(t,r){return t=n(t,r),r.encryptKey?CryptoJS.enc.Utf8.parse(e(t).slice(0,32)):t}function o(e){return"ecb"==e.mode?CryptoJS.mode.ECB:CryptoJS.mode.CBC}function i(e){return"cbc"==e.mode?CryptoJS.enc.Utf8.parse(s):null}var s="0123456789012345",u=["hex","utf8","base64","binary"],a=[128,256],c=["ecb","cbc"],f={encryptKey:!0,keyEncoding:"utf8",keyLength:256,mode:"cbc"};return{encrypt:function(e,n,s){if(!n)return e;s=t(s);var u=i(s),a=o(s),c=r(n,s),f=JSON.stringify(e),p=CryptoJS.AES.encrypt(f,c,{iv:u,mode:a}).ciphertext,l=p.toString(CryptoJS.enc.Base64);return l||e},decrypt:function(e,n,s){if(!n)return e;s=t(s);var u=i(s),a=o(s),c=r(n,s);try{var f=CryptoJS.enc.Base64.parse(e),p=CryptoJS.AES.decrypt({ciphertext:f},c,{iv:u,mode:a}).toString(CryptoJS.enc.Utf8),l=JSON.parse(p);return l}catch(h){return}}}}function m(e,t){var n=CryptoJS.HmacSHA256(e,t);return n.toString(CryptoJS.enc.Base64)}function g(e){return document.getElementById(e)}function w(e){console.error(e)}function x(e,t){var n=[];return f(e.split(/\s+/),function(e){f((t||document).getElementsByTagName(e),function(e){n.push(e)})}),n}function S(e,t,n){f(e.split(","),function(e){var r=function(e){e||(e=window.event),n(e)||(e.cancelBubble=!0,e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation())};t.addEventListener?t.addEventListener(e,r,!1):t.attachEvent?t.attachEvent("on"+e,r):t["on"+e]=r})}function E(){return x("head")[0]}function T(e,t,n){return n?void e.setAttribute(t,n):e&&e.getAttribute&&e.getAttribute(t)}function O(e,t){for(var n in t)if(t.hasOwnProperty(n))try{e.style[n]=t[n]+("|width|height|top|left|".indexOf(n)>0&&"number"==typeof t[n]?"px":"")}catch(r){}}function R(e){return document.createElement(e)}function C(){return te||A()?0:e()}function M(t){if(te||A())return P(t);var n=R("script"),o=t.callback,i=e(),s=0,a=t.timeout||U,c=u(function(){d(1,{message:"timeout"})},a),f=t.fail||function(){},p=t.data||{},l=t.success||function(){},h=function(){E().appendChild(n)},d=function(e,t){s||(s=1,n.onerror=null,clearTimeout(c),e||!t||l(t),u(function(){e&&f();var t=g(i),n=t&&t.parentNode;n&&n.removeChild(t)},K))};return window[o]=function(e){d(0,e)},t.blocking||(n[$]=$),n.onerror=function(){d(1)},n.src=r(t.url,p),T(n,"id",i),h(),d}function P(e){var t,n,o=function(){if(!s){s=1,clearTimeout(c);try{n=JSON.parse(t.responseText)}catch(e){return d(1)}i=1,l(n)}},i=0,s=0,a=e.timeout||U,c=u(function(){d(1,{message:"timeout"})},a),f=e.fail||function(){},p=e.data||{},l=e.success||function(){},h=!e.blocking,d=function(e,n){i||(i=1,clearTimeout(c),t&&(t.onerror=t.onload=null,t.abort&&t.abort(),t=null),e&&f(n))};try{t=A()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest,t.onerror=t.onabort=function(e){d(1,e||t&&t.responseText||{error:"Network Connection Error"})},t.onload=t.onloadend=o,t.onreadystatechange=function(){if(t&&4==t.readyState)switch(t.status){case 200:break;default:try{n=JSON.parse(t.responseText),d(1,n)}catch(e){return d(1,{status:t.status,payload:null,message:t.responseText})}return}};var y=r(e.url,p);t.open("GET",y,h),h&&(t.timeout=a),t.send()}catch(_){return d(0),te=0,M(e)}return d}function j(){if(!("onLine"in navigator))return 1;try{return navigator.onLine}catch(e){return!0}}function B(e){return"sendBeacon"in navigator?navigator.sendBeacon(e):!1}function A(){if(!ue||!ue.get)return 0;var e={id:A.id++,send:function(){},abort:function(){e.id={}},open:function(t,n){A[e.id]=e,ue.get(e.id,n)}};return e}var N=1,L=!1,I=[],D="-pnpres",q=10,U=1e4,F=310,J=60,K=1e3,H="/",z="&",G=5,V=30,W="3.7.16",Q=/{([\w\-]+)}/g,X=function(){var e=20,t=Math.floor(Math.random()*e);return function(n,r){return n.indexOf("pubsub.")>0&&n.replace("pubsub","ps"+(r?a().split("-")[0]:++t<e?t:t=1))||n}}(),Y="https://pubnub.a.ssl.fastly.net/pubnub.swf",$="async",Z=navigator.userAgent,ee="PubNub-JS-Web/3.7.16",te=-1==Z.indexOf("MSIE 6");window.console||(window.console=window.console||{}),console.log||(console.log=console.error=(window.opera||{}).postError||function(){});var ne=function(){var e={},t=!1;try{t=window.localStorage}catch(n){}var r=function(e){return-1==document.cookie.indexOf(e)?null:((document.cookie||"").match(RegExp(e+"=([^;]+)"))||[])[1]||null},o=function(e,t){document.cookie=e+"="+t+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"},i=function(){try{return o("pnctest","1"),"1"===r("pnctest")}catch(e){return!1}}();return{get:function(n){try{return t?t.getItem(n):i?r(n):e[n]}catch(o){return e[n]}},set:function(n,r){try{if(t)return t.setItem(n,r)&&0;i&&o(n,r),e[n]=r}catch(s){e[n]=r}}}}(),re={list:{},unbind:function(e){re.list[e]=[]},bind:function(e,t){(re.list[e]=re.list[e]||[]).push(t)},fire:function(e,t){f(re.list[e]||[],function(e){e(t)})}},oe=g("pubnub")||0,ie=function(e){te=e.jsonp?0:-1==Z.indexOf("MSIE 6");var t=e.subscribe_key||"",n=((+e.keepalive||J)*K,e.uuid||ne.get(t+"uuid")||"",e.leave_on_unload||0);e.xdr=M,e.db=ne,e.error=e.error||w,e._is_online=j,e.jsonp_cb=C,e.hmac_SHA256=m,e.crypto_obj=b(),e.sendBeacon=B,e.params={pnsdk:ee};var r=function(e){return ie(e)},o=v(e);for(var i in o)o.hasOwnProperty(i)&&(r[i]=o[i]);return r.css=O,r.$=g,r.create=R,r.bind=S,r.head=E,r.search=x,r.attr=T,r.events=re,r.init=r,r.secure=r,r.crypto_obj=b(),S("beforeunload",window,function(){return n&&r["each-channel"](function(e){r.LEAVE(e.name,0)}),!0}),e.notest?r:(S("offline",window,r.offline),S("offline",document,r.offline),r)};ie.init=ie,ie.secure=ie,ie.crypto_obj=b(),"complete"===document.readyState?u(_,0):S("load",window,function(){u(_,0)});var se=oe||{};PUBNUB=ie({notest:1,publish_key:T(se,"pub-key"),subscribe_key:T(se,"sub-key"),ssl:!document.location.href.indexOf("https")||"on"==T(se,"ssl"),origin:T(se,"origin"),uuid:T(se,"uuid")}),window.jQuery&&(window.jQuery.PUBNUB=ie),"undefined"!=typeof module&&(module.exports=PUBNUB)&&_();var ue=g("pubnubs")||0;oe&&(O(oe,{position:"absolute",top:-K}),("opera"in window||T(oe,"flash"))&&(oe.innerHTML="<object id=pubnubs data="+Y+"><param name=movie value="+Y+"><param name=allowscriptaccess value=always></object>"),PUBNUB.rdx=function(e,t){return t?(A[e].responseText=unescape(t),void A[e].onload()):A[e].onerror()},A.id=K)}(),function(){var e=PUBNUB.ws=function(t,n){if(!(this instanceof e))return new e(t,n);var r=this,t=r.url=t||"",o=(r.protocol=n||"Sec-WebSocket-Protocol",t.split("/")),i={ssl:"wss:"===o[0],origin:o[2],publish_key:o[3],subscribe_key:o[4],channel:o[5]};return r.CONNECTING=0,r.OPEN=1,r.CLOSING=2,r.CLOSED=3,r.CLOSE_NORMAL=1e3,r.CLOSE_GOING_AWAY=1001,r.CLOSE_PROTOCOL_ERROR=1002,r.CLOSE_UNSUPPORTED=1003,r.CLOSE_TOO_LARGE=1004,r.CLOSE_NO_STATUS=1005,r.CLOSE_ABNORMAL=1006,r.onclose=r.onerror=r.onmessage=r.onopen=r.onsend=function(){},r.binaryType="",r.extensions="",r.bufferedAmount=0,r.trasnmitting=!1,r.buffer=[],r.readyState=r.CONNECTING,t?(r.pubnub=PUBNUB.init(i),r.pubnub.setup=i,r.setup=i,void r.pubnub.subscribe({restore:!1,channel:i.channel,disconnect:r.onerror,reconnect:r.onopen,error:function(){r.onclose({code:r.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!1})},callback:function(e){r.onmessage({data:e})},connect:function(){r.readyState=r.OPEN,r.onopen()}})):(r.readyState=r.CLOSED,r.onclose({code:r.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!0}),r)};e.prototype.send=function(e){var t=this;t.pubnub.publish({channel:t.pubnub.setup.channel,message:e,callback:function(e){t.onsend({data:e})}})},e.prototype.close=function(){var e=this;e.pubnub.unsubscribe({channel:e.pubnub.setup.channel}),e.readyState=e.CLOSED,e.onclose({})}}();var CryptoJS=CryptoJS||function(e,t){var n={},r=n.lib={},o=function(){},i=r.Base={extend:function(e){o.prototype=this;var t=new o;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=i.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||a).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var o=0;e>o;o++)t[r+o>>>2]|=(n[o>>>2]>>>24-8*(o%4)&255)<<24-8*((r+o)%4);else if(65535<n.length)for(o=0;e>o;o+=4)t[r+o>>>2]=n[o>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-8*(n%4),t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;t>r;r+=4)n.push(4294967296*e.random()|0);return new s.init(n,t)}}),u=n.enc={},a=u.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;e>r;r++){var o=t[r>>>2]>>>24-8*(r%4)&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;t>r;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-4*(r%8);return new s.init(n,t/2)}},c=u.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;e>r;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-8*(r%4)&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;t>r;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-8*(r%4);return new s.init(n,t)}},f=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},p=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,u=o/(4*i),u=t?e.ceil(u):e.max((0|u)-this._minBufferSize,0);if(t=u*i,o=e.min(4*t,o),t){for(var a=0;t>a;a+=i)this._doProcessBlock(r,a);a=r.splice(0,t),n.sigBytes-=o}return new s.init(a,o)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=p.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new l.HMAC.init(e,n).finalize(t)}}});var l=n.algo={};return n}(Math);!function(e){for(var t=CryptoJS,n=t.lib,r=n.WordArray,o=n.Hasher,n=t.algo,i=[],s=[],u=function(e){return 4294967296*(e-(0|e))|0},a=2,c=0;64>c;){var f;e:{f=a;for(var p=e.sqrt(f),l=2;p>=l;l++)if(!(f%l)){f=!1;break e}f=!0}f&&(8>c&&(i[c]=u(e.pow(a,.5))),s[c]=u(e.pow(a,1/3)),c++),a++}var h=[],n=n.SHA256=o.extend({_doReset:function(){this._hash=new r.init(i.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],u=n[3],a=n[4],c=n[5],f=n[6],p=n[7],l=0;64>l;l++){if(16>l)h[l]=0|e[t+l];else{var d=h[l-15],y=h[l-2];h[l]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+h[l-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+h[l-16]}d=p+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&c^~a&f)+s[l]+h[l],y=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&o^r&i^o&i),p=f,f=c,c=a,a=u+d|0,u=i,i=o,o=r,r=d+y|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+u|0,n[4]=n[4]+a|0,n[5]=n[5]+c|0,n[6]=n[6]+f|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[(o+64>>>9<<4)+14]=e.floor(r/4294967296),n[(o+64>>>9<<4)+15]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(n),t.HmacSHA256=o._createHmacHelper(n)}(Math),function(){var e=CryptoJS,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,n){e=this._hasher=new e.init,"string"==typeof n&&(n=t.parse(n));var r=e.blockSize,o=4*r;n.sigBytes>o&&(n=e.finalize(n)),n.clamp();for(var i=this._oKey=n.clone(),s=this._iKey=n.clone(),u=i.words,a=s.words,c=0;r>c;c++)u[c]^=1549556828,a[c]^=909522486;i.sigBytes=s.sigBytes=o,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),function(){var e=CryptoJS,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var o=0;n>o;o+=3)for(var i=(t[o>>>2]>>>24-8*(o%4)&255)<<16|(t[o+1>>>2]>>>24-8*((o+1)%4)&255)<<8|t[o+2>>>2]>>>24-8*((o+2)%4)&255,s=0;4>s&&n>o+.75*s;s++)e.push(r.charAt(i>>>6*(3-s)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var n=e.length,r=this._map,o=r.charAt(64);o&&(o=e.indexOf(o),-1!=o&&(n=o));for(var o=[],i=0,s=0;n>s;s++)if(s%4){var u=r.indexOf(e.charAt(s-1))<<2*(s%4),a=r.indexOf(e.charAt(s))>>>6-2*(s%4);o[i>>>2]|=(u|a)<<24-8*(i%4),i++}return t.create(o,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){function t(e,t,n,r,o,i,s){return e=e+(t&n|~t&r)+o+s,(e<<i|e>>>32-i)+t}function n(e,t,n,r,o,i,s){return e=e+(t&r|n&~r)+o+s,(e<<i|e>>>32-i)+t}function r(e,t,n,r,o,i,s){return e=e+(t^n^r)+o+s,(e<<i|e>>>32-i)+t}function o(e,t,n,r,o,i,s){return e=e+(n^(t|~r))+o+s,(e<<i|e>>>32-i)+t}for(var i=CryptoJS,s=i.lib,u=s.WordArray,a=s.Hasher,s=i.algo,c=[],f=0;64>f;f++)c[f]=4294967296*e.abs(e.sin(f+1))|0;s=s.MD5=a.extend({_doReset:function(){this._hash=new u.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,i){for(var s=0;16>s;s++){var u=i+s,a=e[u];e[u]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}var s=this._hash.words,u=e[i+0],a=e[i+1],f=e[i+2],p=e[i+3],l=e[i+4],h=e[i+5],d=e[i+6],y=e[i+7],_=e[i+8],v=e[i+9],b=e[i+10],m=e[i+11],g=e[i+12],w=e[i+13],k=e[i+14],x=e[i+15],S=s[0],E=s[1],T=s[2],O=s[3],S=t(S,E,T,O,u,7,c[0]),O=t(O,S,E,T,a,12,c[1]),T=t(T,O,S,E,f,17,c[2]),E=t(E,T,O,S,p,22,c[3]),S=t(S,E,T,O,l,7,c[4]),O=t(O,S,E,T,h,12,c[5]),T=t(T,O,S,E,d,17,c[6]),E=t(E,T,O,S,y,22,c[7]),S=t(S,E,T,O,_,7,c[8]),O=t(O,S,E,T,v,12,c[9]),T=t(T,O,S,E,b,17,c[10]),E=t(E,T,O,S,m,22,c[11]),S=t(S,E,T,O,g,7,c[12]),O=t(O,S,E,T,w,12,c[13]),T=t(T,O,S,E,k,17,c[14]),E=t(E,T,O,S,x,22,c[15]),S=n(S,E,T,O,a,5,c[16]),O=n(O,S,E,T,d,9,c[17]),T=n(T,O,S,E,m,14,c[18]),E=n(E,T,O,S,u,20,c[19]),S=n(S,E,T,O,h,5,c[20]),O=n(O,S,E,T,b,9,c[21]),T=n(T,O,S,E,x,14,c[22]),E=n(E,T,O,S,l,20,c[23]),S=n(S,E,T,O,v,5,c[24]),O=n(O,S,E,T,k,9,c[25]),T=n(T,O,S,E,p,14,c[26]),E=n(E,T,O,S,_,20,c[27]),S=n(S,E,T,O,w,5,c[28]),O=n(O,S,E,T,f,9,c[29]),T=n(T,O,S,E,y,14,c[30]),E=n(E,T,O,S,g,20,c[31]),S=r(S,E,T,O,h,4,c[32]),O=r(O,S,E,T,_,11,c[33]),T=r(T,O,S,E,m,16,c[34]),E=r(E,T,O,S,k,23,c[35]),S=r(S,E,T,O,a,4,c[36]),O=r(O,S,E,T,l,11,c[37]),T=r(T,O,S,E,y,16,c[38]),E=r(E,T,O,S,b,23,c[39]),S=r(S,E,T,O,w,4,c[40]),O=r(O,S,E,T,u,11,c[41]),T=r(T,O,S,E,p,16,c[42]),E=r(E,T,O,S,d,23,c[43]),S=r(S,E,T,O,v,4,c[44]),O=r(O,S,E,T,g,11,c[45]),T=r(T,O,S,E,x,16,c[46]),E=r(E,T,O,S,f,23,c[47]),S=o(S,E,T,O,u,6,c[48]),O=o(O,S,E,T,y,10,c[49]),T=o(T,O,S,E,k,15,c[50]),E=o(E,T,O,S,h,21,c[51]),S=o(S,E,T,O,g,6,c[52]),O=o(O,S,E,T,p,10,c[53]),T=o(T,O,S,E,b,15,c[54]),E=o(E,T,O,S,a,21,c[55]),S=o(S,E,T,O,_,6,c[56]),O=o(O,S,E,T,x,10,c[57]),T=o(T,O,S,E,d,15,c[58]),E=o(E,T,O,S,w,21,c[59]),S=o(S,E,T,O,l,6,c[60]),O=o(O,S,E,T,m,10,c[61]),T=o(T,O,S,E,f,15,c[62]),E=o(E,T,O,S,v,21,c[63]);s[0]=s[0]+S|0,s[1]=s[1]+E|0,s[2]=s[2]+T|0,s[3]=s[3]+O|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296);for(n[(o+64>>>9<<4)+15]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[(o+64>>>9<<4)+14]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),t=this._hash,n=t.words,r=0;4>r;r++)o=n[r],n[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return t},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),i.MD5=a._createHelper(s),i.HmacMD5=a._createHmacHelper(s)}(Math),function(){var e=CryptoJS,t=e.lib,n=t.Base,r=t.WordArray,t=e.algo,o=t.EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:t.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,o=n.hasher.create(),i=r.create(),s=i.words,u=n.keySize,n=n.iterations;s.length<u;){a&&o.update(a);var a=o.update(e).finalize(t);o.reset();for(var c=1;n>c;c++)a=o.finalize(a),o.reset();i.concat(a)}return i.sigBytes=4*u,i}});e.EvpKDF=function(e,t,n){return o.create(n).compute(e,t)}}(),CryptoJS.lib.Cipher||function(e){var t=CryptoJS,n=t.lib,r=n.Base,o=n.WordArray,i=n.BufferedBlockAlgorithm,s=t.enc.Base64,u=t.algo.EvpKDF,a=n.Cipher=i.extend({cfg:r.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return("string"==typeof n?d:h).encrypt(e,t,n,r)},decrypt:function(t,n,r){return("string"==typeof n?d:h).decrypt(e,t,n,r)}}}});n.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=t.mode={},f=function(t,n,r){var o=this._iv;o?this._iv=e:o=this._prevBlock;for(var i=0;r>i;i++)t[n+i]^=o[i]},p=(n.BlockCipherMode=r.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();p.Encryptor=p.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;f.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),p.Decryptor=p.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=e.slice(t,t+r);
n.decryptBlock(e,t),f.call(this,e,t,r),this._prevBlock=o}}),c=c.CBC=p,p=(t.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,n=n-e.sigBytes%n,r=n<<24|n<<16|n<<8|n,i=[],s=0;n>s;s+=4)i.push(r);n=o.create(i,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},n.BlockCipher=a.extend({cfg:a.cfg.extend({mode:c,padding:p}),reset:function(){a.reset.call(this);var e=this.cfg,t=e.iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=e.createEncryptor;else n=e.createDecryptor,this._minBufferSize=1;this._mode=n.call(e,this,t&&t.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var l=n.CipherParams=r.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),c=(t.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return e=e.salt,(e?o.create([1398893684,1701076831]).concat(e).concat(t):t).toString(s)},parse:function(e){e=s.parse(e);var t=e.words;if(1398893684==t[0]&&1701076831==t[1]){var n=o.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return l.create({ciphertext:e,salt:n})}},h=n.SerializableCipher=r.extend({cfg:r.extend({format:c}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r);return t=o.finalize(t),o=o.cfg,l.create({ciphertext:t,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),t=(t.kdf={}).OpenSSL={execute:function(e,t,n,r){return r||(r=o.random(8)),e=u.create({keySize:t+n}).compute(e,r),n=o.create(e.words.slice(t),4*n),e.sigBytes=4*t,l.create({key:e,iv:n,salt:r})}},d=n.PasswordBasedCipher=h.extend({cfg:h.cfg.extend({kdf:t}),encrypt:function(e,t,n,r){return r=this.cfg.extend(r),n=r.kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,e=h.encrypt.call(this,e,t,n.key,r),e.mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,h.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=CryptoJS,t=e.lib.BlockCipher,n=e.algo,r=[],o=[],i=[],s=[],u=[],a=[],c=[],f=[],p=[],l=[],h=[],d=0;256>d;d++)h[d]=128>d?d<<1:d<<1^283;for(var y=0,_=0,d=0;256>d;d++){var v=_^_<<1^_<<2^_<<3^_<<4,v=v>>>8^255&v^99;r[y]=v,o[v]=y;var b=h[y],m=h[b],g=h[m],w=257*h[v]^16843008*v;i[y]=w<<24|w>>>8,s[y]=w<<16|w>>>16,u[y]=w<<8|w>>>24,a[y]=w,w=16843009*g^65537*m^257*b^16843008*y,c[v]=w<<24|w>>>8,f[v]=w<<16|w>>>16,p[v]=w<<8|w>>>24,l[v]=w,y?(y=b^h[h[h[g^b]]],_^=h[h[_]]):y=_=1}var k=[0,1,2,4,8,16,32,64,128,27,54],n=n.AES=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes/4,e=4*((this._nRounds=n+6)+1),o=this._keySchedule=[],i=0;e>i;i++)if(n>i)o[i]=t[i];else{var s=o[i-1];i%n?n>6&&4==i%n&&(s=r[s>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s]):(s=s<<8|s>>>24,s=r[s>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s],s^=k[i/n|0]<<24),o[i]=o[i-n]^s}for(t=this._invKeySchedule=[],n=0;e>n;n++)i=e-n,s=n%4?o[i]:o[i-4],t[n]=4>n||4>=i?s:c[r[s>>>24]]^f[r[s>>>16&255]]^p[r[s>>>8&255]]^l[r[255&s]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,s,u,a,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,c,f,p,l,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,s,u){for(var a=this._nRounds,c=e[t]^n[0],f=e[t+1]^n[1],p=e[t+2]^n[2],l=e[t+3]^n[3],h=4,d=1;a>d;d++)var y=r[c>>>24]^o[f>>>16&255]^i[p>>>8&255]^s[255&l]^n[h++],_=r[f>>>24]^o[p>>>16&255]^i[l>>>8&255]^s[255&c]^n[h++],v=r[p>>>24]^o[l>>>16&255]^i[c>>>8&255]^s[255&f]^n[h++],l=r[l>>>24]^o[c>>>16&255]^i[f>>>8&255]^s[255&p]^n[h++],c=y,f=_,p=v;y=(u[c>>>24]<<24|u[f>>>16&255]<<16|u[p>>>8&255]<<8|u[255&l])^n[h++],_=(u[f>>>24]<<24|u[p>>>16&255]<<16|u[l>>>8&255]<<8|u[255&c])^n[h++],v=(u[p>>>24]<<24|u[l>>>16&255]<<16|u[c>>>8&255]<<8|u[255&f])^n[h++],l=(u[l>>>24]<<24|u[c>>>16&255]<<16|u[f>>>8&255]<<8|u[255&p])^n[h++],e[t]=y,e[t+1]=_,e[t+2]=v,e[t+3]=l},keySize:8});e.AES=t._createHelper(n)}(),CryptoJS.mode.ECB=function(){var e=CryptoJS.lib.BlockCipherMode.extend();return e.Encryptor=e.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),e.Decryptor=e.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),e}()}).call(exports,__webpack_require__(8)(module))},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var r=function(){function e(t,r){n(this,e),this.setPrefix(r),this._storage=t}return e.prototype.setPrefix=function(t){return this._prefix=t||e.defaultPrefix,this},e.prototype.setItem=function(e,t){return this._storage[this._prefixKey(e)]=JSON.stringify(t),this},e.prototype.removeItem=function(e){return delete this._storage[this._prefixKey(e)],this},e.prototype.getItem=function(e){var t=this._storage[this._prefixKey(e)];return t?JSON.parse(t):null},e.prototype.clean=function(){for(var e in this._storage)this._storage.hasOwnProperty(e)&&0===e.indexOf(this._prefix)&&delete this._storage[e];return this},e.prototype._prefixKey=function(e){return this._prefix+e},e}();r.defaultPrefix="rc-",t["default"]=r},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var r=function(){function e(){n(this,e),this.off()}return e.prototype.hasListeners=function(e){return e in this._listeners},e.prototype.on=function(e,t){var n=this;if("string"==typeof e&&(e=[e]),!e)throw new Error("No events to subscribe to");if("function"!=typeof t)throw new Error("Callback must be a function");return e.forEach(function(e){n.hasListeners(e)||(n._listeners[e]=[]),n._listeners[e].push(t)}),this},e.prototype.emit=function(e){for(var t=this,n=arguments.length,r=Array(n>1?n-1:0),o=1;n>o;o++)r[o-1]=arguments[o];var i=null;return this.hasListeners(e)?(this._listeners[e].some(function(e){return i=e.apply(t,r),i===!1}),i):null},e.prototype.off=function(e,t){var n=this;if(e)if(t){if(!this.hasListeners(e))return this;this._listeners[e].forEach(function(r,o){r===t&&delete n._listeners[e][o]})}else delete this._listeners[e];else this._listeners={};return this},e}();t["default"]=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=n(4),i=n(3),s=function(){function e(t,n){r(this,e),this._cache=t,this._cacheId=n,this._promise=null}return e.prototype.isPaused=function(){var t=this._cache.getItem(this._cacheId);return!!t&&Date.now()-parseInt(t)<e._releaseTimeout},e.prototype.pause=function(){return this._cache.setItem(this._cacheId,Date.now()),this},e.prototype.resume=function(){return this._cache.removeItem(this._cacheId),this},e.prototype.poll=function(){var t=this;return this._promise?this._promise:(this._promise=new o.Promise(function(n,r){(0,i.poll)(function(e){return t.isPaused()?e():(t._promise=null,t.resume(),void n(null))},e._pollInterval)}),this._promise)},e}();s._pollInterval=250,s._releaseTimeout=5e3,t["default"]=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new a.Promise(function(e,n){function r(o,i){try{var s=t[o](i),u=s.value}catch(c){return void n(c)}s.done?e(u):a.Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)})}r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=n(4),c=n(3),f=n(16),p=n(13),l=r(p),h=n(17),d=r(h),y=function(e){function t(){var n,r,o;i(this,t);for(var u=arguments.length,a=Array(u),c=0;u>c;c++)a[c]=arguments[c];return n=r=s(this,e.call.apply(e,[this].concat(a))),r.events={beforeRequest:"beforeRequest",requestSuccess:"requestSuccess",requestError:"requestError"},o=n,s(r,o)}return u(t,e),t.prototype.sendRequest=function(){var e=o(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new d["default"](e),t.prev=1,this.emit(this.events.beforeRequest,n),t.next=5,this._loadResponse(e);case 5:if(n._response=t.sent,!n._isMultipart()&&!n._isJson()){t.next=10;break}return t.next=9,n.response().text();case 9:n._text=t.sent;case 10:if(n.ok()){t.next=12;break}throw new Error("Response has unsuccessful status");case 12:return this.emit(this.events.requestSuccess,n),t.abrupt("return",n);case 16:throw t.prev=16,t.t0=t["catch"](1),t.t0.apiResponse||(t.t0=this.makeError(t.t0,n)),this.emit(this.events.requestError,t.t0),t.t0;case 21:case"end":return t.stop()}},t,this,[[1,16]])}));return function(t){return e.apply(this,arguments)}}(),t.prototype._loadResponse=function(){var e=o(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.fetch.call(null,e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),t.prototype.makeError=function(e,t){return e.hasOwnProperty("apiResponse")||e.hasOwnProperty("originalMessage")||(e.apiResponse=t,e.originalMessage=e.message,e.message=t&&t.error(!0)||e.originalMessage),e},t.prototype.createRequest=function(e){if(e=e||{},e.headers=e.headers||{},!e.url)throw new Error("Url is not defined");if(e.method||(e.method="GET"),e.method&&t._allowedMethods.indexOf(e.method.toUpperCase())<0)throw new Error("Method has wrong value: "+e.method);if(e.credentials=e.credentials||"include",e.mode=e.mode||"cors",e.query&&(e.url=e.url+(e.url.indexOf("?")>-1?"&":"?")+(0,c.queryStringify)(e.query)),(0,f.findHeaderName)("Accept",e.headers)||(e.headers.Accept=d["default"]._jsonContentType),"string"!=typeof e.body||!e.body){var n=(0,f.findHeaderName)(d["default"]._contentType,e.headers);n||(n=d["default"]._contentType,e.headers[n]=d["default"]._jsonContentType);var r=e.headers[n];r.indexOf(d["default"]._jsonContentType)>-1?e.body=JSON.stringify(e.body):r.indexOf(d["default"]._urlencodedContentType)>-1&&(e.body=(0,c.queryStringify)(e.body))}var o=new a.Request(e.url,e);return o.originalBody=e.body,o},t}(l["default"]);y._allowedMethods=["GET","POST","PUT","DELETE","PATCH","OPTIONS","HEAD"],t["default"]=y},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){t=t||{};var n=new s.Response(e,t);return a.isNodeJS()&&(n._text=e,n._decode=function(){return this._text}),n}function i(e,t){return e=e.toLowerCase(),Object.keys(t).reduce(function(t,n){return t?t:e==n.toLowerCase()?n:t},null)}t.__esModule=!0,t.createResponse=o,t.findHeaderName=i;var s=n(4),u=n(3),a=r(u)},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=n(4),s=n(16),u=r(s),a=function(){function e(t,n,r){o(this,e),this._request=t,this._response=n,this._text=r,this._json=null,this._multipart=[]}return e.prototype.response=function(){return this._response},e.prototype.request=function(){return this._request},e.prototype.ok=function(){return this._response&&this._response.ok},e.prototype.text=function(){if(!this._isJson()&&!this._isMultipart())throw new Error("Response is not text");return this._text},e.prototype.json=function(){if(!this._isJson())throw new Error("Response is not JSON");return this._json||(this._json=this._text?JSON.parse(this._text):null),this._json},e.prototype.error=function(e){if(this.ok()&&!e)return null;var t=(this._response&&this._response.status?this._response.status+" ":"")+(this._response&&this._response.statusText?this._response.statusText:"");try{this.json().message&&(t=this.json().message),this.json().error_description&&(t=this.json().error_description),this.json().description&&(t=this.json().description)}catch(n){}return t},e.prototype.multipart=function(){if(!this._isMultipart())throw new Error("Response is not multipart");if(!this._multipart.length){var t=this.text();if(!t)throw new Error("No response body");var n=this._getContentType().match(/boundary=([^;]+)/i)[1];if(!n)throw new Error("Cannot find boundary");var r=t.toString().split(e._boundarySeparator+n);if(""===r[0].trim()&&r.shift(),r[r.length-1].trim()==e._boundarySeparator&&r.pop(),r.length<1)throw new Error("No parts in body");var o=e.create(r.shift(),this._response.status,this._response.statusText).json();this._multipart=r.map(function(t,n){var r=o.response[n].status;return e.create(t,r)})}return this._multipart},e.prototype._isContentType=function(e){return this._getContentType().indexOf(e)>-1},e.prototype._getContentType=function(){return this._response.headers.get(e._contentType)||""},e.prototype._isMultipart=function(){return this._isContentType(e._multipartContentType)},e.prototype._isUrlEncoded=function(){return this._isContentType(e._urlencodedContentType)},e.prototype._isJson=function(){return this._isContentType(e._jsonContentType)},e.create=function(t,n,r){t=t||"",n=n||200,r=r||"OK",t=t.replace(/\r/g,"");var o=new i.Headers,s=t.split(e._bodySeparator),a=s.length>1?s.shift():"";return t=s.join(e._bodySeparator),(a||"").split("\n").forEach(function(t){var n=t.trim().split(e._headerSeparator),r=n.shift().trim(),i=n.join(e._headerSeparator).trim();r&&o.append(r,i)}),new e(null,u.createResponse(t,{headers:o,status:n,statusText:r}),t)},e}();a._contentType="Content-Type",a._jsonContentType="application/json",a._multipartContentType="multipart/mixed",a._urlencodedContentType="application/x-www-form-urlencoded",a._headerSeparator=":",a._bodySeparator="\n\n",a._boundarySeparator="--",t["default"]=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var s=t[o](i),u=s.value}catch(a){return void n(a)}s.done?e(u):Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)})}r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=n(19),c=r(a),f=n(15),p=r(f),l=function(e){function t(){i(this,t);var n=s(this,e.call(this));return n._registry=new c["default"],n}return u(t,e),t.prototype.registry=function(){return this._registry},t.prototype._loadResponse=function(){var e=o(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=this._registry.find(e),t.next=3,n.getResponse(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),t}(p["default"]);t["default"]=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=n(20),s=r(i),u=function(){function e(){o(this,e),this._mocks=[]}return e.prototype.add=function(e){return this._mocks.push(e),this},e.prototype.clear=function(){return this._mocks=[],this},e.prototype.find=function(e){var t=this._mocks.shift();if(!t)throw new Error("No mock in registry for request "+e.method+" "+e.url);if(!t.test(e))throw new Error("Wrong request "+e.method+" "+e.url+" for expected mock "+t.method()+" "+t.path());return t},e.prototype.apiCall=function(e,t,n,r,o){return this.add(new s["default"](e,t,n,r,o)),this},e.prototype.authentication=function(){return this.apiCall("POST","/restapi/oauth/token",{access_token:"ACCESS_TOKEN",token_type:"bearer",expires_in:3600,refresh_token:"REFRESH_TOKEN",refresh_token_expires_in:60480,scope:"SMS RCM Foo Boo",expireTime:(new Date).getTime()+36e5}),this},e.prototype.logout=function(){return this.apiCall("POST","/restapi/oauth/revoke",{}),this},e.prototype.presenceLoad=function(e){return this.apiCall("GET","/restapi/v1.0/account/~/extension/"+e+"/presence",{uri:"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/"+e+"/presence",extension:{uri:"https://platform.ringcentral.com/restapi/v1.0/account/123/extension/"+e,id:e,extensionNumber:"101"},activeCalls:[],presenceStatus:"Available",telephonyStatus:"Ringing",userStatus:"Available",dndStatus:"TakeAllCalls",extensionId:e}),this},e.prototype.subscribeGeneric=function(e){e=e||54e3;var t=new Date;return this.apiCall("POST","/restapi/v1.0/subscription",{eventFilters:["/restapi/v1.0/account/~/extension/~/presence"],expirationTime:new Date(t.getTime()+1e3*e).toISOString(),expiresIn:e,deliveryMode:{transportType:"PubNub",encryption:!1,address:"123_foo",subscriberKey:"sub-c-foo",secretKey:"sec-c-bar"},id:"foo-bar-baz",creationTime:t.toISOString(),status:"Active",uri:"https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz"}),this},e.prototype.subscribeOnPresence=function(e,t){e=e||"1";var n=new Date;return this.apiCall("POST","/restapi/v1.0/subscription",{eventFilters:["/restapi/v1.0/account/~/extension/"+e+"/presence"+(t?"?detailedTelephonyState=true":"")],expirationTime:new Date(n.getTime()+54e6).toISOString(),deliveryMode:{transportType:"PubNub",encryption:!0,address:"123_foo",subscriberKey:"sub-c-foo",secretKey:"sec-c-bar",encryptionAlgorithm:"AES",encryptionKey:"VQwb6EVNcQPBhE/JgFZ2zw=="},creationTime:n.toISOString(),id:"foo-bar-baz",status:"Active",uri:"https://platform.ringcentral.com/restapi/v1.0/subscription/foo-bar-baz"}),this},e.prototype.tokenRefresh=function(e){return e?this.apiCall("POST","/restapi/oauth/token",{message:"Wrong token",error_description:"Wrong token",description:"Wrong token"},400):this.apiCall("POST","/restapi/oauth/token",{access_token:"ACCESS_TOKEN_FROM_REFRESH",token_type:"bearer",expires_in:3600,refresh_token:"REFRESH_TOKEN_FROM_REFRESH",refresh_token_expires_in:60480,scope:"SMS RCM Foo Boo"}),this},e}();t["default"]=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var s=t[o](i),u=s.value}catch(a){return void n(a)}s.done?e(u):Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)})}r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var s=n(17),u=r(s),a=n(3),c=n(16),f=function(){function e(t,n,r,o,s,u){i(this,e),this._method=t.toUpperCase(),this._path=n,this._json=r||{},this._delay=u||10,this._status=o||200,this._statusText=s||"OK"}return e.prototype.path=function(){return this._path},e.prototype.method=function(){return this._method},e.prototype.test=function(e){return e.url.indexOf(this._path)>-1&&e.method.toUpperCase()==this._method},e.prototype.getResponse=function(){var e=o(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.delay)(this._delay);case 2:return e.abrupt("return",this.createResponse(this._json));case 3:case"end":return e.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),e.prototype.createResponse=function(e,t){t=t||{},t.status=t.status||this._status,t.statusText=t.statusText||this._statusText;var n=JSON.stringify(e),r=(0,c.createResponse)(n,t);return r.headers.set(u["default"]._contentType,u["default"]._jsonContentType),r},e}();t["default"]=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new d.Promise(function(e,n){function r(o,i){try{var s=t[o](i),u=s.value}catch(a){return void n(a)}s.done?e(u):d.Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)})}r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=n(13),c=r(a),f=n(14),p=r(f),l=n(22),h=r(l),d=n(4),y=n(3),_=function(e){function t(n,r,o,u,a){i(this,t);var c=s(this,e.call(this));return c.events={beforeLogin:"beforeLogin",loginSuccess:"loginSuccess",loginError:"loginError",beforeRefresh:"beforeRefresh",refreshSuccess:"refreshSuccess",refreshError:"refreshError",beforeLogout:"beforeLogout",logoutSuccess:"logoutSuccess",logoutError:"logoutError"},c._server=o,c._appKey=u,c._appSecret=a,c._cache=r,c._client=n,c._queue=new p["default"](c._cache,t._cacheId+"-refresh"),c._auth=new h["default"](c._cache,t._cacheId),c}return u(t,e),t.prototype.auth=function(){return this._auth},t.prototype.client=function(){return this._client},t.prototype.createUrl=function(e,n){e=e||"",n=n||{};var r="",o=-1!=e.indexOf("http://")||-1!=e.indexOf("https://");return n.addServer&&!o&&(r+=this._server),-1!=e.indexOf(t._urlPrefix)||o||(r+=t._urlPrefix+"/"+t._apiVersion),r+=e,(n.addMethod||n.addToken)&&(r+=e.indexOf("?")>-1?"&":"?"),n.addMethod&&(r+="_method="+n.addMethod),n.addToken&&(r+=(n.addMethod?"&":"")+"access_token="+this._auth.accessToken()),r},t.prototype.authUrl=function(e){return e=e||{},this.createUrl(t._authorizeEndpoint+"?"+(0,y.queryStringify)({response_type:"code",redirect_uri:e.redirectUri||"",client_id:this._appKey,state:e.state||"",brand_id:e.brandId||"",display:e.display||"",prompt:e.prompt||""}),{addServer:!0})},t.prototype.parseAuthRedirectUrl=function(e){var t=(0,y.parseQueryString)(e.split("?").reverse()[0]),n=t.error_description||t.error;if(n){var r=new Error(n);throw r.error=t.error,r}return t},t.prototype.loggedIn=function(){var e=o(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._ensureAuthentication();case 3:return e.abrupt("return",!0);case 6:return e.prev=6,e.t0=e["catch"](0),e.abrupt("return",!1);case 9:case"end":return e.stop()}},t,this,[[0,6]])}));return function(){return e.apply(this,arguments)}}(),t.prototype.login=function(){var e=o(regeneratorRuntime.mark(function n(e){var r,o,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,e=e||{},e.remember=e.remember||!1,this.emit(this.events.beforeLogin),r={access_token_ttl:t._accessTokenTtl,refresh_token_ttl:e.remember?t._refreshTokenTtlRemember:t._refreshTokenTtl},e.code?e.code&&(r.grant_type="authorization_code",r.code=e.code,r.redirect_uri=e.redirectUri):(r.grant_type="password",r.username=e.username,r.password=e.password,r.extension=e.extension||""),e.endpointId&&(r.endpoint_id=e.endpointId),n.next=9,this._tokenRequest(t._tokenEndpoint,r);case 9:return o=n.sent,i=o.json(),this._auth.setData(i).setRemember(e.remember),this.emit(this.events.loginSuccess,o),n.abrupt("return",o);case 16:throw n.prev=16,n.t0=n["catch"](0),this._cache.clean(),this.emit(this.events.loginError,n.t0),n.t0;case 21:case"end":return n.stop()}},n,this,[[0,16]])}));return function(t){return e.apply(this,arguments)}}(),t.prototype.refresh=function(){var e=o(regeneratorRuntime.mark(function n(){var e,r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,this.emit(this.events.beforeRefresh),!this._queue.isPaused()){n.next=9;break}return n.next=5,this._queue.poll();case 5:if(this._isAccessTokenValid()){n.next=7;break}throw new Error("Automatic authentification timeout");case 7:return this.emit(this.events.refreshSuccess,null),n.abrupt("return",null);case 9:return this._queue.pause(),n.next=12,(0,y.delay)(t._refreshDelayMs);case 12:if(this._auth.refreshToken()){n.next=14;break}throw new Error("Refresh token is missing");case 14:if(this._auth.refreshTokenValid()){n.next=16;break}throw new Error("Refresh token has expired");case 16:if(this._queue.isPaused()){n.next=18;break}throw new Error("Queue was resumed before refresh call");case 18:return n.next=20,this._tokenRequest(t._tokenEndpoint,{grant_type:"refresh_token",refresh_token:this._auth.refreshToken(),access_token_ttl:t._accessTokenTtl,refresh_token_ttl:this._auth.remember()?t._refreshTokenTtlRemember:t._refreshTokenTtl});case 20:if(e=n.sent,r=e.json(),r.access_token){n.next=24;break}throw this._client.makeError(new Error("Malformed OAuth response"),e);case 24:return this._auth.setData(r),this._queue.resume(),this.emit(this.events.refreshSuccess,e),n.abrupt("return",e);case 30:throw n.prev=30,n.t0=n["catch"](0),n.t0=this._client.makeError(n.t0),t._clearCacheOnRefreshError&&this._cache.clean(),this.emit(this.events.refreshError,n.t0),n.t0;case 36:case"end":return n.stop()}},n,this,[[0,30]])}));return function(){return e.apply(this,arguments)}}(),t.prototype.logout=function(){var e=o(regeneratorRuntime.mark(function n(){var e;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,this.emit(this.events.beforeLogout),this._queue.pause(),n.next=5,this._tokenRequest(t._revokeEndpoint,{token:this._auth.accessToken()});case 5:return e=n.sent,this._queue.resume(),this._cache.clean(),this.emit(this.events.logoutSuccess,e),n.abrupt("return",e);case 12:throw n.prev=12,n.t0=n["catch"](0),this._queue.resume(),this.emit(this.events.logoutError,n.t0),n.t0;case 17:case"end":return n.stop()}},n,this,[[0,12]])}));return function(){return e.apply(this,arguments)}}(),t.prototype.inflateRequest=function(){var e=o(regeneratorRuntime.mark(function t(e,n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=n||{},!n.skipAuthCheck){t.next=3;break}return t.abrupt("return",e);case 3:return t.next=5,this._ensureAuthentication();case 5:return e.headers.set("Authorization",this._authHeader()),t.abrupt("return",e);case 7:case"end":return t.stop()}},t,this)}));return function(t,n){return e.apply(this,arguments)}}(),t.prototype.sendRequest=function(){var e=o(regeneratorRuntime.mark(function t(e,n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.inflateRequest(e,n);case 3:return e=t.sent,t.next=6,this._client.sendRequest(e);case 6:return t.abrupt("return",t.sent);case 9:if(t.prev=9,t.t0=t["catch"](0),t.t0.apiResponse&&t.t0.apiResponse.response()&&401==t.t0.apiResponse.response().status){t.next=13;break}throw t.t0;case 13:return this._auth.cancelAccessToken(),t.next=16,this.sendRequest(e,n);case 16:return t.abrupt("return",t.sent);case 17:case"end":return t.stop()}},t,this,[[0,9]])}));return function(t,n){return e.apply(this,arguments)}}(),t.prototype.send=function(){var e=o(regeneratorRuntime.mark(function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.url=this.createUrl(e.url,{addServer:!0}),t.next=3,this.sendRequest(this._client.createRequest(e),e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),t.prototype.get=function(){var e=o(regeneratorRuntime.mark(function t(e,n,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=r||{},r.method="GET",r.url=e,r.query=n,t.next=6,this.send(r);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},t,this)}));return function(t,n,r){return e.apply(this,arguments)}}(),t.prototype.post=function(){var e=o(regeneratorRuntime.mark(function t(e,n,r,o){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=o||{},o.method="POST",o.url=e,o.query=r,o.body=n,t.next=7,this.send(o);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}},t,this)}));return function(t,n,r,o){return e.apply(this,arguments)}}(),t.prototype.put=function(){var e=o(regeneratorRuntime.mark(function t(e,n,r,o){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=o||{},o.method="PUT",o.url=e,o.query=r,o.body=n,t.next=7,this.send(o);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}},t,this)}));return function(t,n,r,o){return e.apply(this,arguments)}}(),t.prototype["delete"]=function(){var e=o(regeneratorRuntime.mark(function t(e,n,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=r||{},r.method="DELETE",r.url=e,r.query=n,t.next=6,this.send(r);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},t,this)}));return function(t,n,r){return e.apply(this,arguments)}}(),t.prototype._tokenRequest=function(){var e=o(regeneratorRuntime.mark(function t(e,n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.send({url:e,skipAuthCheck:!0,body:n,method:"POST",headers:{Authorization:"Basic "+this._apiKey(),"Content-Type":"application/x-www-form-urlencoded"}});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(t,n){return e.apply(this,arguments)}}(),t.prototype._ensureAuthentication=function(){var e=o(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isAccessTokenValid()){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,this.refresh();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},t,this)}));return function(){return e.apply(this,arguments)}}(),t.prototype._isAccessTokenValid=function(){return this._auth.accessTokenValid()&&!this._queue.isPaused()},t.prototype._apiKey=function(){var e=this._appKey+":"+this._appSecret;return"function"==typeof btoa?btoa(e):new Buffer(e).toString("base64")},t.prototype._authHeader=function(){var e=this._auth.accessToken();return this._auth.tokenType()+(e?" "+e:"")},t}(c["default"]);_._urlPrefix="/restapi",_._apiVersion="v1.0",_._accessTokenTtl=null,_._refreshTokenTtl=36e3,_._refreshTokenTtlRemember=604800,_._tokenEndpoint="/restapi/oauth/token",_._revokeEndpoint="/restapi/oauth/revoke",_._authorizeEndpoint="/restapi/oauth/authorize",_._refreshDelayMs=100,_._cacheId="platform",_._clearCacheOnRefreshError=!0,t["default"]=_},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var r=function(){function e(t,r){n(this,e),
this._cache=t,this._cacheId=r}return e.prototype.accessToken=function(){return this.data().access_token},e.prototype.refreshToken=function(){return this.data().refresh_token},e.prototype.tokenType=function(){return this.data().token_type},e.prototype.data=function(){return this._cache.getItem(this._cacheId)||{token_type:"",access_token:"",expires_in:0,refresh_token:"",refresh_token_expires_in:0}},e.prototype.setData=function(e){e=e||{};var t=this.data();return Object.keys(e).forEach(function(n){t[n]=e[n]}),t.expire_time=Date.now()+1e3*t.expires_in,t.refresh_token_expire_time=Date.now()+1e3*t.refresh_token_expires_in,this._cache.setItem(this._cacheId,t),this},e.prototype.accessTokenValid=function(){var t=this.data();return t.token_type===e.forcedTokenType||t.expire_time-e.refreshHandicapMs>Date.now()},e.prototype.refreshTokenValid=function(){return this.data().refresh_token_expire_time>Date.now()},e.prototype.cancelAccessToken=function(){return this.setData({access_token:"",expires_in:0})},e.prototype.forceAuthentication=function(){return this.setData({token_type:e.forcedTokenType,access_token:"",expires_in:0,refresh_token:"",refresh_token_expires_in:0}),this},e.prototype.setRemember=function(e){return this.setData({remember:e})},e.prototype.remember=function(){return!!this.data().remember},e}();r.refreshHandicapMs=6e4,r.forcedTokenType="forced",t["default"]=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=n(24),s=r(i),u=n(4),a=function(){function e(){o(this,e),this.crypto_obj=u.PUBNUB.crypto_obj}return e.prototype.init=function(e){return new s["default"](e)},e}();t["default"]=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var u=n(13),a=r(u),c=n(4),f=function(e){function t(n){o(this,t);var r=i(this,e.call(this));return r.options=n,r.crypto_obj=c.PUBNUB.crypto_obj,r}return s(t,e),t.prototype.ready=function(){},t.prototype.subscribe=function(e){this.on("message-"+e.channel,e.message)},t.prototype.unsubscribe=function(e){this.off("message-"+e.channel)},t.prototype.receiveMessage=function(e,t){this.emit("message-"+t,e,"env",t)},t}(a["default"]);t["default"]=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var s=t[o](i),u=s.value}catch(a){return void n(a)}s.done?e(u):Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)})}r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=n(13),c=r(a),f=n(15),p=(r(f),n(3)),l=function(e){function t(n,r){i(this,t);var o=s(this,e.call(this));return o.events={notification:"notification",removeSuccess:"removeSuccess",removeError:"removeError",renewSuccess:"renewSuccess",renewError:"renewError",subscribeSuccess:"subscribeSuccess",subscribeError:"subscribeError"},o._pubnubFactory=n,o._platform=r,o._pubnub=null,o._timeout=null,o._subscription={},o}return u(t,e),t.prototype.subscribed=function(){return!!(this._subscription.id&&this._subscription.deliveryMode&&this._subscription.deliveryMode.subscriberKey&&this._subscription.deliveryMode.address)},t.prototype.alive=function(){return this.subscribed()&&Date.now()<this.expirationTime()},t.prototype.expirationTime=function(){return new Date(this._subscription.expirationTime||0).getTime()-t._renewHandicapMs},t.prototype.setSubscription=function(e){return e=e||{},this._clearTimeout(),this._subscription=e,this._pubnub||this._subscribeAtPubnub(),this._setTimeout(),this},t.prototype.subscription=function(){return this._subscription},t.prototype.register=function(){var e=o(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.alive()){e.next=6;break}return e.next=3,this.renew();case 3:return e.abrupt("return",e.sent);case 6:return e.next=8,this.subscribe();case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},t,this)}));return function(){return e.apply(this,arguments)}}(),t.prototype.eventFilters=function(){return this._subscription.eventFilters||[]},t.prototype.addEventFilters=function(e){return this.setEventFilters(this.eventFilters().concat(e)),this},t.prototype.setEventFilters=function(e){return this._subscription.eventFilters=e,this},t.prototype.subscribe=function(){var e=o(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this._clearTimeout(),this.eventFilters().length){t.next=4;break}throw new Error("Events are undefined");case 4:return t.next=6,this._platform.post("/restapi/v1.0/subscription",{eventFilters:this._getFullEventFilters(),deliveryMode:{transportType:"PubNub"}});case 6:return e=t.sent,n=e.json(),this.setSubscription(n).emit(this.events.subscribeSuccess,e),t.abrupt("return",e);case 12:throw t.prev=12,t.t0=t["catch"](0),t.t0=this._platform.client().makeError(t.t0),this.reset().emit(this.events.subscribeError,t.t0),t.t0;case 17:case"end":return t.stop()}},t,this,[[0,12]])}));return function(){return e.apply(this,arguments)}}(),t.prototype.renew=function(){var e=o(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this._clearTimeout(),this.subscribed()){t.next=4;break}throw new Error("No subscription");case 4:if(this.eventFilters().length){t.next=6;break}throw new Error("Events are undefined");case 6:return t.next=8,this._platform.put("/restapi/v1.0/subscription/"+this._subscription.id,{eventFilters:this._getFullEventFilters()});case 8:return e=t.sent,n=e.json(),this.setSubscription(n).emit(this.events.renewSuccess,e),t.abrupt("return",e);case 14:throw t.prev=14,t.t0=t["catch"](0),t.t0=this._platform.client().makeError(t.t0),this.reset().emit(this.events.renewError,t.t0),t.t0;case 19:case"end":return t.stop()}},t,this,[[0,14]])}));return function(){return e.apply(this,arguments)}}(),t.prototype.remove=function(){var e=o(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this.subscribed()){t.next=3;break}throw new Error("No subscription");case 3:return t.next=5,this._platform["delete"]("/restapi/v1.0/subscription/"+this._subscription.id);case 5:return e=t.sent,this.reset().emit(this.events.removeSuccess,e),t.abrupt("return",e);case 10:throw t.prev=10,t.t0=t["catch"](0),t.t0=this._platform.client().makeError(t.t0),this.emit(this.events.removeError,t.t0),t.t0;case 15:case"end":return t.stop()}},t,this,[[0,10]])}));return function(){return e.apply(this,arguments)}}(),t.prototype.resubscribe=function(){return this.reset().setEventFilters(this.eventFilters()).subscribe()},t.prototype.reset=function(){return this._clearTimeout(),this.subscribed()&&this._pubnub&&this._pubnub.unsubscribe({channel:this._subscription.deliveryMode.address}),this._subscription={},this},t.prototype._getFullEventFilters=function(){var e=this;return this.eventFilters().map(function(t){return e._platform.createUrl(t)})},t.prototype._setTimeout=function(){var e=this;if(this._clearTimeout(),!this.alive())throw new Error("Subscription is not alive");return(0,p.poll)(function(t){return e.alive()?t():void e.renew()},t._pollInterval,this._timeout),this},t.prototype._clearTimeout=function(){return(0,p.stopPolling)(this._timeout),this},t.prototype._decrypt=function(e){if(!this.subscribed())throw new Error("No subscription");if(this._subscription.deliveryMode.encryptionKey){var t=this._pubnubFactory;e=t.crypto_obj.decrypt(e,this._subscription.deliveryMode.encryptionKey,{encryptKey:!1,keyEncoding:"base64",keyLength:128,mode:"ecb"})}return e},t.prototype._notify=function(e){return this.emit(this.events.notification,this._decrypt(e)),this},t.prototype._subscribeAtPubnub=function(){if(!this.alive())throw new Error("Subscription is not alive");var e=this._pubnubFactory;return this._pubnub=e.init({ssl:!0,subscribe_key:this._subscription.deliveryMode.subscriberKey}),this._pubnub.ready(),this._pubnub.subscribe({channel:this._subscription.deliveryMode.address,message:this._notify.bind(this),connect:function(){}}),this},t}(c["default"]);l._renewHandicapMs=12e4,l._pollInterval=1e4,t["default"]=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var s=t[o](i),u=s.value}catch(a){return void n(a)}s.done?e(u):Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)})}r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.__esModule=!0;var c=n(25),f=r(c),p=n(14),l=r(p),h=function(e){function t(n,r,o,u){i(this,t);var c=s(this,e.call(this,n,r));return c._cache=o,c._cacheKey=u,c._renewQueue=new l["default"](c._cache,u+"-renew"),c._resubscribeQueue=new l["default"](c._cache,u+"-resubscribe"),c.events=a({},c.events,{queuedRenewSuccess:"queuedRenewSuccess",queuedRenewError:"queuedRenewError",queuedResubscribeSuccess:"queuedResubscribeSuccess",queuedResubscribeError:"queuedResubscribeError"}),c.on(c.events.renewError,function(){c.resubscribe()}),c.on([c.events.subscribeSuccess,c.events.renewSuccess],function(){c._cache.setItem(c._cacheKey,c.subscription())}),c.on(c.events.removeSuccess,function(){c._cache.removeItem(c._cacheKey)}),c}return u(t,e),t.prototype._queue=function(){var e=o(regeneratorRuntime.mark(function t(e,n,r,o,i){var s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!n.isPaused()){t.next=8;break}return t.next=4,n.poll();case 4:if(this.alive()){t.next=6;break}throw new Error(i);case 6:return this.emit(r,null),t.abrupt("return",null);case 8:return n.pause(),t.next=11,e.call(this);case 11:return s=t.sent,n.resume(),this.emit(r,s),t.abrupt("return",s);case 17:throw t.prev=17,t.t0=t["catch"](0),this.emit(o,t.t0),t.t0;case 21:case"end":return t.stop()}},t,this,[[0,17]])}));return function(t,n,r,o,i){return e.apply(this,arguments)}}(),t.prototype.renew=function(){return this._queue(e.prototype.renew,this._renewQueue,this.events.queuedRenewSuccess,this.events.queuedRenewError,"Subscription is not alive after renew timeout")},t.prototype.resubscribe=function(){return this._queue(e.prototype.resubscribe,this._resubscribeQueue,this.events.queuedResubscribeSuccess,this.events.queuedResubscribeError,"Subscription is not alive after resubscribe timeout")},t.prototype.restore=function(e){var t=this._cache.getItem(this._cacheKey);if(t)try{this.setSubscription(t)}catch(n){}else this.setEventFilters(e);return this},t}(f["default"]);t["default"]=h}])});
//# sourceMappingURL=ringcentral-bundle.min.js.map
